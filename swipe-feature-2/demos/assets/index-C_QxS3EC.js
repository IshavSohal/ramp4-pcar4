import{dy as S,F as _,dQ as B,dA as A,dS as R,dR as u,dC as m,dU as M,dW as P,d$ as g,dX as T,dE as k,dK as z,dJ as h,gb as F,dF as H,gc as N,dO as O,dG as W,fM as V}from"./main-C1jnFJXF.js";import"./preload-helper-ExcqyqRp.js";const D={class:"swipe-container"},G=["id","aria-valuenow","aria-label","content"],U=["swipe-position","view"],Y=S({__name:"swipe",props:{fixture:{type:_,required:!0},message:String},setup($){const n=B("iApi"),c=A(),t=R("slider"),p=u(45),d=u(0),v=u(0),f=u(50),y=u(),a=u(),b=m(()=>{const o=30+v.value-v.value,i=t.value?.getBoundingClientRect()?t.value?.getBoundingClientRect().right-t.value?.getBoundingClientRect().left:0,e=+p.value/90,s=(i-o)*e,w=(t.value?.getBoundingClientRect().x??0)+s+(o-5.25)/2;return f.value=w/n.$rootEl.clientWidth*100+.2,`${w}px`}),x=m(()=>`${d.value}px`),C=m(()=>`${-d.value/2-18}px`);M(()=>{d.value=n.$rootEl?.clientHeight??1200});const L=()=>{d.value=n.$rootEl?.clientHeight??d.value,v.value++,setTimeout(()=>{v.value++},50)},r=()=>{c.setOpacity(.1),t.value.style.background=""},l=()=>{c.setOpacity(1),t.value.style.background="inherit"};P(async()=>{"ontouchstart"in document.documentElement||!window.matchMedia("(pointer:fine)").matches||(t.value.style.background="inherit"),window.addEventListener("resize",L),t.value?.addEventListener("focus",r),t.value?.addEventListener("blur",l),t.value?.addEventListener("mouseover",r),t.value?.addEventListener("mouseleave",l),t.value?.addEventListener("touchstart",r),t.value?.addEventListener("touchend",l),setTimeout(()=>{v.value++},50),await E(),n.event.on(g.MAP_BASEMAPCHANGE,async i=>{i.schemaChanged&&(a.value?.trailingLayers.forEach(e=>{a.value?.trailingLayers.remove(e)}),a.value?.leadingLayers.forEach(e=>{a.value?.leadingLayers.remove(e)}),await E())}),n.event.on(g.LAYER_RELOAD_END,i=>{a.value?.trailingLayers.forEach(e=>{e.id===i.id&&(a.value?.trailingLayers.remove(e),a.value?.trailingLayers.add(i.esriLayer))}),a.value?.leadingLayers.forEach(e=>{e.id===i.id&&(a.value?.leadingLayers.remove(e),a.value?.leadingLayers.add(i.esriLayer))})}),n.event.on(g.LAYER_REMOVE,i=>{a.value?.trailingLayers.forEach(e=>{e.id===i.id&&a.value?.trailingLayers.remove(e)}),a.value?.leadingLayers.forEach(e=>{e.id===i.id&&a.value?.leadingLayers.remove(e)})})});const E=async()=>{await n.geo.map.viewPromise,y.value=n.geo.map.esriView;const o=["Nature","WFSLayer"],i=["Water","GeoMet"];o.forEach(e=>{n.geo.layer.awaitLayer(e,!0).then(s=>{s.esriLayer?a.value?.trailingLayers.add(s.esriLayer):console.warn(`Invalid layer instance: ${e}`)})}),i.forEach(e=>{n.geo.layer.awaitLayer(e,!0).then(s=>{s.esriLayer?a.value?.leadingLayers.add(s.esriLayer):console.warn(`Invalid layer instance: ${e}`)})})};return T(()=>{window.removeEventListener("resize",L),t.value?.removeEventListener("focus",()=>r),t.value?.removeEventListener("blur",()=>l),t.value?.removeEventListener("mouseover",r),t.value?.removeEventListener("mouseleave",l),t.value?.removeEventListener("touchstart",r),t.value?.removeEventListener("touchend",l)}),(o,i)=>{const e=k("tippy");return W(),z("div",D,[h("div",{class:"verticalLine",style:F({left:b.value,height:x.value,bottom:C.value})},null,4),H(h("input",{"onUpdate:modelValue":i[0]||(i[0]=s=>p.value=s),id:"layerSlider"+O(n).$element._uid,class:"layerSliderElement",type:"range",ref_key:"slider",ref:t,min:"0","aria-valuemin":"0","aria-valuemax":"90","aria-valuenow":p.value,"aria-label":o.$t("map.layerSwipe.label"),max:"90",step:"0.5",content:o.$t("map.layerSwipe.drag"),style:{"z-index":10}},null,8,G),[[N,p.value],[e,{followCursor:!0,trigger:"mouseenter"}]]),h("arcgis-swipe",{direction:"horizontal","swipe-position":f.value,view:y.value,"auto-destroy-disable":"",ref_key:"swipeComponent",ref:a},null,8,U)])}}}),j=V(Y,[["__scopeId","data-v-0fdf52ba"]]);class K extends _{async added(){const{el:n,destroy:c}=this.mount(j,{app:this.$element,props:{message:"This is a swipe.",fixture:this}});n.childNodes[0]&&this.$vApp.$el.appendChild(n.childNodes[0]),this.removed=()=>{c()}}}export{K as default};
