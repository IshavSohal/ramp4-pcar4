import{jp as Bn,X as At,ai as Dn,N as Hn,O as Un,eV as Vn,ay as kt,o as u,q as c,G as F,bg as Tt,z as Re,aw as f,bb as Zn,az as tt,bC as Fn,aM as Gn,gq as Cn,au as Yn,bo as Wn,bm as et,bZ as $n,gY as Jn,c7 as Kn,e_ as Xn}from"./main-BfV_Ya13.js";import{H as b,p as Se,R as P,P as M,q as L,o as D,s as Ct,c as Yt,_ as Mt,Z as Wt,v as $t,j as Qn,A as tr,J as er}from"./vec32-D2jQCZiP.js";import{e as A,u as nr,q as Ie,d as H,j as ot,p as nt,l as rr,B as sr,_ as ir,o as ze,b as Oe,E as qe,L as or}from"./vec2-BnynUbeJ.js";import{n as I,t as _t,l as ar,m as lr}from"./vec2f64-CEUyUoff.js";import{s as ur,j as cr}from"./vec42-D8CJyqHG.js";import{n as pr}from"./vec4f64-CjUMzAyX.js";import{i as hr}from"./projection-Xiqt9C3K.js";import{j as Pt,q as Jt,b as Kt,N as Xt}from"./geodesicUtils-DV1oOM9p.js";import{M as z,z as dr,l as Rt,Q as Qt,d as je,k as Be,V as fr,H as De,O as He,p as gr}from"./plane-tjMJ7XU0.js";import{I as yr,O as vr,_ as mr,$ as br,U as Nr}from"./sphere-msI60UCA.js";import{e as ht}from"./common-CYWrYyJl.js";import{g as Er}from"./TimeExtent-Bb8CDzYF.js";import{e as St,n as Ue,a as It}from"./projectVectorToVector-j40_kZ30.js";import{b as Lr}from"./Query-BghuEfPO.js";import{h as wr,_ as Ve,a as xr,y as Ar,z as kr}from"./MapView-CfcyJ-YQ.js";import{n as Tr}from"./ElevationInfo-5XB6qnze.js";import{o as dt,m as te}from"./quantityUtils-DXFBqyQk.js";function Ze(e){return e?ft:Xe}function Fe(e,t){return t?.mode?t.mode:Ze(e).mode}function Ge(e,t){return t??Ze(e)}function ee(e,t){return Fe(e==null||(e.hasZ??!1),t)}function Mr(e,t){return Ge(e==null||(e.hasZ??!1),t)}function _r(e){const t=We(e);return ee(e.geometry,t)}function Ce(e){const t=We(e),n=ee(e.geometry,t),r=t!=null&&n!=="on-the-ground"?Dr(t):0,s=t?.featureExpressionInfo;return{mode:n,offset:r,featureExpressionInfo:s}}function Pr(e){return ne(Ce(e))}function Rr(e){return ne(e)||Ye(e)}function Ye(e){return e?.featureExpressionInfo?.expression==="0"}function ne(e){if(!e||e.mode==="on-the-ground")return!1;const t=e?.featureExpressionInfo?e.featureExpressionInfo.expression:null;return!(!t||t==="0")}function We(e){return e.layer&&"elevationInfo"in e.layer?e.layer.elevationInfo:null}function zt(e,t){if(!e?.offset)return 0;const{offset:n,unit:r}=e;if(r==="decimal-degrees")return 0;const s=r!=="unknown"&&r?r:"meters",i=Bn(t);return i?At(n,s,i):0}function Sr(e,t,n){if(!n?.mode)return;const r=e.hasZ?e.z:0,s=zt(n,e.spatialReference);switch(n.mode){case"absolute-height":return r-s;case"on-the-ground":return 0;case"relative-to-ground":return r-((t.elevationProvider.getElevation(e.x,e.y,r,e.spatialReference,"ground")??0)+s);case"relative-to-scene":return r-((t.elevationProvider.getElevation(e.x,e.y,r,e.spatialReference,"scene")??0)+s)}}function $e(e,t,n,r=null){return Ot(e,t.x,t.y,t.hasZ?t.z:0,t.spatialReference,n,r)}function Je(e,t,n,r,s=null){return Ot(e,t[0],t[1],t.length>2?t[2]:0,n,r,s)}function Ot(e,t,n,r,s,i,a=null){if(i==null)return;const o=a!=null?a.mode:"absolute-height";if(o==="on-the-ground")return 0;const{absoluteZ:l}=Ke(t,n,r,s,e,i);return Ir(l,t,n,r,s,e,a,o)}function Ke(e,t,n,r,s,i){const a=zt(i,r);switch(i.mode){case"absolute-height":return{absoluteZ:n+a,elevation:0};case"on-the-ground":{const o=s.elevationProvider.getElevation(e,t,0,r,"ground")??0;return{absoluteZ:o,elevation:o}}case"relative-to-ground":{const o=s.elevationProvider.getElevation(e,t,n,r,"ground")??0;return{absoluteZ:n+o+a,elevation:o}}case"relative-to-scene":{const o=s.elevationProvider.getElevation(e,t,n,r,"scene")??0;return{absoluteZ:n+o+a,elevation:o}}}}function Ir(e,t,n,r,s,i,a,o){const l=zt(a,s);switch(o){case"absolute-height":return e-l;case"relative-to-ground":return e-((i.elevationProvider.getElevation(t,n,r,s,"ground")??0)+l);case"relative-to-scene":return e-((i.elevationProvider.getElevation(t,n,r,s,"scene")??0)+l)}}function zr(e,t){if(t==null)return!1;const{mode:n}=t;return n!=null&&(e==="scene"&&n==="relative-to-scene"||e==="ground"&&n!=="absolute-height")}function Or(e,t,n){return n&&n.mode!==t?`${e} only support ${t} elevation mode`:null}function qr(e,t,n){return n?.mode===t?`${e} do not support ${t} elevation mode`:null}function jr(e,t){return t?.featureExpressionInfo!=null&&t.featureExpressionInfo.expression!=="0"?`${e} do not support featureExpressionInfo`:null}function Br(e,t){t&&e.warn(".elevationInfo=",t)}function Dr(e){return(e?.offset??0)*Tr(e?.unit)}const ft={mode:"absolute-height",offset:0},Xe={mode:"on-the-ground",offset:null};function re(e,t){return e[0]*t[1]-e[1]*t[0]}function Hr(e,t,n){const r=ot(n,t)/nt(n);return rr(e,n,r)}function Ur(e,t,n,r,s=n){return A(rt,r,n),A(qt,t,s),Hr(at,qt,rt),nr(e,s,at)}function Vr(e,t,n,r){A(rt,t,n);const s=r/Ie(rt);return H(e,n,rt,s)}function Zr(e,t){const n=e.start,r=e.end,s=t.start,i=t.end,a=A(rt,r,n),o=A(Qe,i,s),l=re(a,o);if(Math.abs(l)<=Gr)return[];const p=A(qt,n,s),h=re(o,p)/l,d=re(a,p)/l;if(h>=0){if(d>=0||t.type===m.LINE)return[H(at,n,a,h)]}else if(e.type===m.LINE&&(d>=0||t.type===m.LINE))return[H(at,n,a,h)];return[]}function Fr(e,t,n){const r=[],s=A(rt,e.end,e.start),i=A(Qe,e.start,t),a=nt(s),o=2*ot(s,i),l=o*o-4*a*(nt(i)-n*n);if(l===0){const p=-o/(2*a);(e.type===m.LINE||p>=0)&&r.push(H(at,e.start,s,p))}else if(l>0){const p=Math.sqrt(l),h=(-o+p)/(2*a);(e.type===m.LINE||h>=0)&&r.push(H(at,e.start,s,h));const d=(-o-p)/(2*a);(e.type===m.LINE||d>=0)&&r.push(H(qt,e.start,s,d))}return r}var m;(function(e){e[e.RAY=0]="RAY",e[e.LINE=1]="LINE"})(m||(m={}));const Gr=1e-6,rt=I(),Qe=I(),qt=I(),at=I(),tn="z",en="r",Cr={redo:en,undo:tn,center:"Alt",constraint:"Shift",cancel:"Escape",delete:["Backspace","Delete"],complete:"Enter",vertexAdd:"f",pan:" "},nn={toggle:"Control"},Yr={enterInputMode:"Tab",commit:"Enter",discard:"Escape",next:"Tab"},Wr={moveUp:{key:"ArrowUp",modifier:"Shift",repeats:!0},moveDown:{key:"ArrowDown",modifier:"Shift",repeats:!0},moveLeft:{key:"ArrowLeft",modifier:"Shift",repeats:!0},moveRight:{key:"ArrowRight",modifier:"Shift",repeats:!0},scaleUp:{key:"+",modifier:"Shift"},scaleDown:{key:"-",modifier:"Shift"},factorModifier:{key:wr,continuePropagation:!0},toggleOpacity:"t",preserveAspectRatio:{key:"Shift",continuePropagation:!0},rotateIncrements:{key:"Shift",continuePropagation:!0},editSourcePoints:{key:"Alt",continuePropagation:!0},undo:tn,redo:en};let $r=class{constructor(){this._bindings=new Map}add(e,t){return this.addToggle(e,n=>{n.type==="key-down"&&t(n)})}addToggle(e,t){const n=Jr.fromDefinition(e,t),r=Dn(this._bindings,n.key,()=>[]);return r.push(n),Hn(()=>Un(r,n))}register(e,t=Ve.WIDGET){return Vn([e.on("key-down",n=>this.dispatch(e.inputManager,n),t),e.on("key-up",n=>this.dispatch(e.inputManager,n),t)])}dispatch(e,t){const n=t.key,r=this._bindings.get(n);if(r)for(const s of r)s.process(e,t)}},Jr=class Te{constructor(t,n,r,s,i){this.key=t,this.modifiers=n,this.repeats=r,this.continuePropagation=s,this.callback=i}process(t,n){if(!(n.key!==this.key||"repeat"in n&&n.repeat&&!this.repeats)){for(const r of this.modifiers)if(!t.isModifierKeyDown(r))return;this.continuePropagation||n.stopPropagation(),this.callback(n)}}static fromDefinition(t,n){if(typeof t=="string")return new Te(t,[],!1,!1,n);const{key:r,modifier:s,repeats:i,continuePropagation:a}=t;return new Te(r,s?Array.isArray(s)?s:[s]:[],!!i,!!a,n)}};var st;function se(e,t,n){return _(e,t,n)}function _(e=0,t=0,n=0){return kt(e,t,n)}function Kr(e){return e}function Xr(e){return e}function G(e,t,n){return kt(e,t,n)}function lt(e){const[t,n,r]=e;return e.length>3?[t,n,r,e[3]]:[t,n,r]}function Qr(e){return e[3]=((e.length>3?e[3]:void 0)??st.NONE)|st.TARGET,e}function ts(e){return!!(((e.length>3?e[3]:void 0)??st.NONE)&st.TARGET)}function ie(e,t,{coordinateHelper:n,elevationInfo:r},s){return e?rn(n.vectorToDehydratedPoint(e,ss),t,r,s):null}function rn(e,t,n,r=_()){return r[0]=e.x,r[1]=e.y,r[2]=e.z??0,t==null||(t.type==="2d"?r[2]=0:r[2]=$e(t,e,n,ft)??0),r}function es(e,t,n){return n?(Ue(n,e[0],e[1],e[2],t),n):St(e[0],e[1],e[2],t)}function ns(e,t,{z:n,m:r},s,i){const{spatialReference:a,elevationInfo:o}=s;let l;n==null&&r==null?l=void 0:t==null||t.type==="2d"?l=n??void 0:l=Je(t,e,a,ft,o)??0;const[p,h]=e;return i?Ue(i,p,h,l,a):i=St(p,h,l,a),r!=null&&(i.m=r,i.hasM=!0),i}function rs(e,t,n,r,s=_()){const[i,a]=e;return s[0]=i,s[1]=a,e.length>3&&(s[3]=e[3]??st.NONE),n?.type!=="3d"?(s[2]=t.value,s):(s[2]=Ot(n,i,a,t.value,r,t.elevationInfo,ft)??0,s)}(function(e){e[e.NONE=0]="NONE",e[e.TARGET=1]="TARGET"})(st||(st={}));const ss=St(0,0,0,null);let j=class extends Re{constructor(){super(...arguments),this.enabled=!0}};u([c({type:Boolean})],j.prototype,"enabled",void 0),j=u([F("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],j);let v=class extends Re{constructor(e){super(e),this.lineSnapper=new j,this.parallelLineSnapper=new j,this.rightAngleSnapper=new j,this.rightAngleTriangleSnapper=new j,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new Tt([255,127,0]),this.orangeTransparent=new Tt([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};u([c({type:j,constructOnly:!0,nonNullable:!0,json:{write:!0}})],v.prototype,"lineSnapper",void 0),u([c({type:j,constructOnly:!0,nonNullable:!0,json:{write:!0}})],v.prototype,"parallelLineSnapper",void 0),u([c({type:j,constructOnly:!0,nonNullable:!0,json:{write:!0}})],v.prototype,"rightAngleSnapper",void 0),u([c({type:j,constructOnly:!0,nonNullable:!0,json:{write:!0}})],v.prototype,"rightAngleTriangleSnapper",void 0),u([c({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],v.prototype,"shortLineThreshold",void 0),u([c({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],v.prototype,"distance",void 0),u([c({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],v.prototype,"pointThreshold",void 0),u([c({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],v.prototype,"intersectionParallelLineThreshold",void 0),u([c({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],v.prototype,"parallelLineThreshold",void 0),u([c({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],v.prototype,"verticalLineThresholdMeters",void 0),u([c({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],v.prototype,"touchSensitivityMultiplier",void 0),u([c({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],v.prototype,"pointOnLineThreshold",void 0),u([c({type:Tt,nonNullable:!0})],v.prototype,"orange",void 0),u([c({type:Tt,nonNullable:!0})],v.prototype,"orangeTransparent",void 0),u([c({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],v.prototype,"lineHintWidthReference",void 0),u([c({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],v.prototype,"lineHintWidthTarget",void 0),u([c({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],v.prototype,"lineHintFadedExtensions",void 0),u([c({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],v.prototype,"parallelLineHintWidth",void 0),u([c({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],v.prototype,"parallelLineHintLength",void 0),u([c({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],v.prototype,"parallelLineHintOffset",void 0),u([c({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],v.prototype,"rightAngleHintSize",void 0),u([c({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],v.prototype,"rightAngleHintOutlineSize",void 0),u([c({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],v.prototype,"satisfiesConstraintScreenThreshold",void 0),v=u([F("esri.views.interactive.snapping.Settings.Defaults")],v);const is=new v;var it;(function(e){e[e.FEATURE=1]="FEATURE",e[e.SELF=2]="SELF",e[e.ALL=3]="ALL"})(it||(it={}));let gt=class{constructor(e,t){this.isDraped=e,this.domain=t}};class Me extends gt{constructor(t,n,r=it.ALL){super(n,r),this.intersectionPoint=t}equals(t){return t instanceof Me&&b(this.intersectionPoint,t.intersectionPoint)}}let os=class qn extends gt{constructor(t,n,r,s,i=it.ALL,a=!0,o=!0){super(s,i),this.type=t,this.lineStart=n,this.lineEnd=r,this.fadeLeft=a,this.fadeRight=o}equals(t){return t instanceof qn&&this.type===t.type&&b(this.lineStart,t.lineStart)&&b(this.lineEnd,t.lineEnd)&&this.fadeLeft===t.fadeLeft&&this.fadeRight===t.fadeRight}get length(){return Se(this.lineStart,this.lineEnd)}},as=class jn extends gt{constructor(t,n,r,s=it.ALL){super(r,s),this.lineStart=t,this.lineEnd=n}equals(t){return t instanceof jn&&b(this.lineStart,t.lineStart)&&b(this.lineEnd,t.lineEnd)}};class _e extends gt{constructor(t,n,r,s,i=it.ALL){super(s,i),this.previousVertex=t,this.centerVertex=n,this.nextVertex=r}equals(t){return t instanceof _e&&b(this.previousVertex,t.previousVertex)&&b(this.centerVertex,t.centerVertex)&&b(this.nextVertex,t.nextVertex)}}function oe({start:e,end:t,type:n},r,s){const i=[],a=A(yt,t,e),o=A(Bt,e,r),l=nt(a),p=2*ot(a,o),h=p*p-4*l*(nt(o)-s*s);if(h===0){const d=-p/(2*l);(n===R.PLANE||d>=0)&&i.push(H(I(),e,a,d))}else if(h>0){const d=Math.sqrt(h),N=(-p+d)/(2*l);(n===R.PLANE||N>=0)&&i.push(H(I(),e,a,N));const g=(-p-d)/(2*l);(n===R.PLANE||g>=0)&&i.push(H(I(),e,a,g))}return i}function sn(e,t){const n=e.start,r=e.end,s=A(yt,r,n),i=D(Ht,-s[1],s[0],0),a=t.start,o=t.end,l=P(ue,o,a),p=M(l,i),h=D(hn,n[0],n[1],0),d=P(dn,h,a),N=M(d,i),g=ht();if(Math.abs(p)<g)return[];const E=L(fn,a,l,N/p);if(t.type===m.RAY){const x=P(ce,E,a);if(M(x,l)<-g)return[]}if(e.type===R.HALF_PLANE){const x=sr(Bt,E,n);if(ot(x,s)<-g)return[]}return[tt(E)]}function ls(e,t){return cs(jt(pe,t[2],e),t)}function on(e,t){return cn(jt(pe,0,e),jt(fs,0,t)).map(([n,r])=>_t(n,r))}function an(e,t,n){return ae(e,jt(pe,e[2],t),n)}function ln(e,t,n,r=f()){const s=A(yt,e,t),i=Ie(s);return H(r,t,s,i===0?1:n/i),r[2]=e[2],r}function ae(e,{start:t,end:n,type:r},s=f()){const i=P(Dt,e,t),a=P(Ht,n,t),o=M(i,a)/M(a,a);return L(s,t,a,r===m.RAY?Math.max(o,0):o)}const us=(()=>{const e=f(),t=f(),n=f();return({start:r,end:s},{center:i,radius:a,normal:o,slicePlane:l})=>{const p=Rt(i,o,ds);if(y(Qt(p,r),0)&&y(Qt(p,s),0)){je(o,e,t);const d=(E,x)=>(Yt(n,x,i),ze(E,M(n,e),M(n,t)),E),N=Fr({start:d(yt,r),end:d(Bt,s),type:m.LINE},ar,a),g=[];for(const[E,x]of N){const S=Ct(f(),i);L(S,S,e,E),L(S,S,t,x),l&&!J(l,S)||g.push(S)}return g}const h=f();return Be(p,r,s,h)?!y(Se(h,i),a)||l&&!J(l,h)?[]:[h]:[]}})();function un({start:e,end:t,type:n},r,s){const i=[],a=Yt(Dt,t,e),o=A(Bt,e,r),l=nt(a),p=2*ot(a,o),h=p*p-4*l*(nt(o)-s*s);if(h===0){const d=-p/(2*l);(n===m.LINE||d>=0)&&i.push(L(f(),e,a,d))}else if(h>0){const d=Math.sqrt(h),N=(-p+d)/(2*l);(n===m.LINE||N>=0)&&i.push(L(f(),e,a,N));const g=(-p-d)/(2*l);(n===m.LINE||g>=0)&&i.push(L(f(),e,a,g))}return i}function cn(e,t){const n=e.start,r=e.end,s=t.start,i=t.end,a=P(Dt,r,n),o=P(Ht,i,s),l=P(ue,s,n),p=Mt(hn,a,o);if(!y(M(l,p),0))return[];const h=Wt(p);if(y(h,0))return[];const d=Mt(dn,l,o),N=M(d,p)/h,g=L(fn,n,a,N);if(e.type===m.RAY){const E=P(ce,g,n);if(M(a,E)<-ht())return[]}if(t.type===m.RAY){const E=P(ce,g,s);if(M(o,E)<-ht())return[]}return[tt(g)]}function cs({start:e,end:t,type:n},r){const s=P(Dt,r,e),i=P(Ht,t,e),a=Mt(ue,i,s),o=Wt(a)/Wt(i),l=ht();if(o<l)switch(n){case m.LINE:return[tt(r)];case m.RAY:return M(i,s)<-l?[]:[tt(r)]}return[]}function le(e,t,n,r){const[s,i]=e,[a,o]=n,l=a-s,p=o-i,h=l*l+p*p,d=Math.sqrt(h);if(d>t+r)return[];if(d<Math.abs(t-r))return[];if(y(d,0)&&y(t,r))return[];const N=(t*t-r*r+h)/(2*d),g=Math.sqrt(t*t-N*N),E=g*p/d,x=g*l/d,[S,Q]=ir(yt,e,n,N/d);return y(E,x)?[_t(S,Q)]:[_t(S+E,Q-x),_t(S-E,Q+x)]}function jt(e,t,{start:n,end:r,type:s}){return D(e.start,n[0],n[1],t),D(e.end,r[0],r[1],t),e.type=hs[s],e}function pn(e,t){return y(e[2],t[2])}function y(e,t){return Zn(Math.abs(e-t),0,ht())}function ps(e,t){return t.filter(n=>J(e,n))}function J(e,t){return dr(e,t)}var R;(function(e){e[e.PLANE=0]="PLANE",e[e.HALF_PLANE=1]="HALF_PLANE"})(R||(R={}));const hs={[R.PLANE]:m.LINE,[R.HALF_PLANE]:m.RAY},yt=I(),Bt=I(),Dt=f(),Ht=f(),ue=f(),hn=f(),dn=f(),fn=f(),ce=f(),ds=z(),pe={start:f(),end:f(),type:m.LINE},fs={start:f(),end:f(),type:m.LINE};class O{intersect(t){return C(this,t)}closestPoints(t){return[this.closestTo(t)]}}class ut extends O{constructor(t){super(),this.point=t}equals(t){return this===t||q(t)&&b(this.point,t.point)}closestTo(){return lt(this.point)}}class he extends O{constructor(t,n,r){super(),this.start=t,this.end=n,this.lineLike={start:t,end:n,type:r}}equals(t){return this===t||U(t)&&this.lineLike.type===t.lineLike.type&&b(this.start,t.start)&&b(this.end,t.end)}closestTo(t){const n=_();return ae(t,this.lineLike,n),n}}class de extends he{constructor(t,n){super(t,n,m.LINE)}}class gs extends he{constructor(t,n){super(t,n,m.RAY)}}class gn extends O{constructor(t){super(),this.constraints=t}equals(t){return this===t||Ne(t)&&Gn(this.constraints,t.constraints,(n,r)=>n.equals(r))}closestTo(t){let n,r=1/0;for(const s of this.constraints){const i=s.closestTo(t),a=$t(t,i);a<r&&(r=a,n=i)}return lt(n??t)}closestPoints(t){return this.constraints.flatMap(n=>n===this?[]:n.closestPoints(t))}}class yn extends O{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||Z(t)&&this.center[0]===t.center[0]&&this.center[1]===t.center[1]&&this.radius===t.radius}closestTo(t){const n=_();return ln(t,this.center,this.radius,n),n}}class fe extends O{constructor(t,n){super(),this.center=t,this.radius=n}equals(t){return this===t||W(t)&&b(this.center,t.center)&&this.radius===t.radius}closestTo(t){const n=_();return ln(t,this.center,this.radius,n),n[2]=this.center[2],n}asCircle(){return new ge(lt(this.center),this.radius,G(0,0,1))}}class ge extends O{constructor(t,n,r,s=void 0){super(),this.center=t,this.radius=n,this.normal=r,this.slicePlane=s}equals(t){return this===t||K(t)&&b(this.center,t.center)&&b(this.normal,t.normal)&&this.radius===t.radius}closestTo(t){const{center:n,radius:r}=this;De(this.getPlane(ys),t,ye);const s=P(ye,ye,n),i=Qn(s);if(y(i,0))return lt(t);const a=r/Math.sqrt(i),o=_();L(o,n,s,a);const{slicePlane:l}=this;return l&&!J(l,o)?me(l,this)?.closestTo(t)??lt(t):o}getPlane(t=z()){return Rt(this.center,this.normal,t)}}const ye=f(),ys=z();class vn extends O{constructor(t){super(),this.z=t}equals(t){return this===t||Y(t)&&this.z===t.z}closestTo(t){return G(t[0],t[1],this.z)}getPlane(t=z()){return D(mn,0,0,this.z),Rt(mn,Yn,t)}}const mn=f();class ve extends O{constructor(t,n,r){super(),this.start=t,this.end=n,this.planeLike={start:t,end:n,type:r}}equals(t){return this===t||V(t)&&this.planeLike.type===t.planeLike.type&&b(this.start,t.start)&&b(this.end,t.end)}closestTo(t){const n=_();return an(t,this.planeLike,n),n}closestEndTo(t){const{start:n,end:r}=this.planeLike;return Math.sign(ot(A(vs,r,n),A(ms,t,n)))>0?this.end:this.start}getPlane(t=z()){const n=Ct(bn,this.end);return n[2]+=1,gr(this.start,this.end,n,t)}getSlicePlane(t=z()){const{start:n,end:r,type:s}=this.planeLike;if(s===R.PLANE)return;const i=D(bn,n[0],n[1],0),a=D(Nn,r[0],r[1],0),o=Yt(Nn,a,i);return Rt(i,o,t),t}}const vs=I(),ms=I(),bn=f(),Nn=f();class bs extends ve{constructor(t,n){super(t,n,R.HALF_PLANE)}}class Ns extends ve{constructor(t,n){super(t,n,R.PLANE)}}class Es extends O{constructor(t,n){super(),this.sphere=vr(t,n)}equals(t){return this===t||$(t)&&mr(this.sphere,t.sphere)}closestTo(t){const n=_();return br(this.sphere,t,n),n}get center(){return Nr(this.sphere)}get radius(){return this.sphere[3]}}class En extends O{constructor(t,n,r){super(),this.start=t,this.end=n,this.getZ=r,this.planeLike={start:t,end:n,type:R.PLANE}}equals(t){return this===t||Vt(t)&&b(this.start,t.start)&&b(this.end,t.end)&&this.getZ===t.getZ}closestTo(t){return As(this,t)}addIfOnTheGround(t,n){for(const r of n){const s=this.getZ(r[0],r[1])??0;y(r[2],s)&&(r[2]=s,t.push(r))}}}class Ln extends O{constructor(t,n,r){super(),this._x=t,this._y=n,this._z=r}equals(t){return this===t||Us(t)&&this._x===t._x&&this._y===t._y&&this._z===t._z}closestTo([t,n,r]){return se(this._x??t,this._y??n,this._z??r)}}class wn extends O{constructor(t,n,r,s,i){super(),this._origin=t,this._spatialReference=n,this._distanceMeters=r,this._z=s,this._directionDegrees=i}equals(t){return this===t||Hs(t)&&qe(this._origin,t._origin)&&this._spatialReference===t._spatialReference&&this._distanceMeters===t._distanceMeters&&this._z===t._z&&this._directionDegrees===t._directionDegrees}closestTo([t,n,r]){return ze(vt,t,n),qe(vt,this._origin)||this._applyDirectionAndDistance(vt),se(vt[0],vt[1],this._z??r)}_applyDirectionAndDistance(t){if(this._directionDegrees!=null&&this._distanceMeters!=null)Pt(t,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)ws(t,this._origin,this._directionDegrees,t,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:n}=Jt(Ls,this._origin,t,this._spatialReference);Pt(t,this._origin,n??0,this._distanceMeters,this._spatialReference)}}}const vt=[0,0],Ls=new Kt;function ws(e,t,n,r,s){let{azimuth:i,distance:a}=Jt(xs,t,r,s);i??=0;let o=a*Math.cos((i-n)*hr);o=Math.max(0,o),Pt(e,t,n,o,s)}const xs=new Kt;function As(e,t){const n=_();return an(t,e.planeLike,n),n[2]=e.getZ(n[0],n[1])??kn,n}function C(e,t){if(Ne(e)){const n=[];for(const r of e.constraints){const s=r.intersect(t);s&&n.push(s)}return Ut(n)}if(Ne(t))return C(t,e);if(Vt(e))return xn(e,t);if(Vt(t))return xn(t,e);if(q(e)){const{point:n}=e;if(q(t))return b(n,t.point)?e:void 0;const r=t.closestTo(n);return er(r,n)?e:void 0}if(U(e)){if(q(t))return C(t,e);if(U(t))return B(cn(e.lineLike,t.lineLike));if(Y(t))return ks(e,t);if(V(t))return B(sn(t.planeLike,e.lineLike));if(Z(t))return B(un(e.lineLike,t.center,t.radius));if(K(t))return B(us(e.lineLike,t));if(W(t))return Ts(e,t);if($(t))return Ms(e,t)}else if(Y(e)){if(q(t)||U(t))return C(t,e);if(Y(t))return _s(e,t);if(V(t))return Ps(e,t);if(Z(t))return Rs(e,t);if(K(t))return Is(e,t);if(W(t))return Ss(e,t);if($(t))return zs(e,t)}else if(V(e)){if(q(t)||U(t)||Y(t))return C(t,e);if(V(t))return be(on(e.planeLike,t.planeLike));if(Z(t))return be(oe(e.planeLike,t.center,t.radius));if(K(t))return qs(e,t);if(W(t))return Os(e,t);if($(t))return js(e,t)}else if(Z(e)){if(q(t)||U(t)||Y(t)||V(t))return C(t,e);if(Z(t))return be(le(e.center,e.radius,t.center,t.radius));if(K(t))return;if(W(t))return Bs(e,t);if($(t))return}else if(K(e)){if(q(t)||U(t)||Y(t)||V(t)||Z(t))return C(t,e);if(K(t))return;if(W(t))return t.asCircle(),void 0;if($(t))return}else if(W(e)){if(q(t)||U(t)||Y(t)||V(t)||Z(t)||K(t))return C(t,e);if(W(t))return Ds(t,e);if($(t))return}else if($(e)){if(q(t)||U(t)||Y(t)||V(t)||Z(t)||W(t))return C(t,e);if($(t))return}}const ks=(()=>{const e=z();return(t,n)=>{const{start:r,end:s}=t;if(pn(r,s)&&y(r[2],n.z))return t;const i=_();return Be(n.getPlane(e),r,s,i)?new ut(i):void 0}})();function Ts({lineLike:e},{center:t,radius:n}){const r=t[2];return B(un(e,t,n).filter(s=>y(s[2],r)))}function Ms({lineLike:e},{sphere:t}){return B(yr(t,e.start,e.end))}const me=(()=>{const e=pr(),t=f(),n=f();return(r,s,i)=>{const{normal:a,center:o,radius:l}=s;je(a,t,n);const p=He(r),h=l*M(p,t),d=l*M(p,n);ur(e,o[0],o[1],o[2],1);const N=cr(r,e),g=Math.hypot(h,d),E=y(g,0);if(y(Qt(r,o),0)){if(E)return s;if(y(l,0))return!i||J(i,o)?new ut(lt(o)):void 0;Mt(t,p,a),tr(t,t);const Gt=new Array,wt=tt(o);L(wt,wt,t,l),i&&!J(i,wt)||Gt.push(wt);const xt=tt(o);return L(xt,xt,t,-l),i&&!J(i,xt)||Gt.push(xt),B(Gt)}if(E)return;const x=-N/g;if(Math.abs(x)>1||y(x,1))return;const S=Math.atan(h/d),Q=Cn(x)-S,Pe=Math.PI-Q,Nt=new Array,Et=f();L(Et,o,t,l*Math.cos(Q)),L(Et,Et,n,l*Math.sin(Q)),Nt.push(Et);const Lt=f();return L(Lt,o,t,l*Math.cos(Pe)),L(Lt,Lt,n,l*Math.sin(Pe)),Nt.push(Lt),B(i?ps(i,Nt):Nt)}})();function _s(e,t){return y(e.z,t.z)?e:void 0}function Ps({z:e},{planeLike:t}){const[n,r]=t.start,[s,i]=t.end,a=G(n,r,e),o=G(s,i,e);return t.type===R.PLANE?new de(a,o):new gs(a,o)}function Rs(e,t){const[n,r]=t.center;return new fe(G(n,r,e.z),t.radius)}function Ss(e,t){return y(t.center[2],e.z)?t:void 0}const Is=(()=>{const e=z();return(t,n)=>me(t.getPlane(e),n,n.slicePlane)})();function zs(e,{center:t,radius:n}){const r=Math.abs(t[2]-e.z);if(r>n&&!y(r,n))return;const s=G(t[0],t[1],e.z),i=Math.sqrt(n**2-r**2);return y(i,0)?void 0:new fe(s,i)}const Os=(()=>{const e=z();return(t,{center:n,radius:r})=>{const s=oe(t.planeLike,n,r),i=n[2];t.getSlicePlane(e);const a=new Array;for(const[o,l]of s){const p=[o,l,i];J(e,p)&&a.push(p)}return B(a)}})(),qs=(()=>{const e=z(),t=z();return(n,r)=>me(n.getPlane(e),r,n.getSlicePlane(t))})(),js=(()=>{const e=z();return(t,{center:n,radius:r})=>{const s=t.getPlane(e),i=fr(s,n),a=Math.abs(i);if(a>r&&!y(a,r))return;const o=Math.sqrt(r**2-i**2);if(y(o,0)){const h=_();return De(s,n,h),new ut(h)}const l=_(),p=tt(He(s));return L(l,n,p,i),new ge(l,o,p,t.getSlicePlane())}})();function Bs(e,t){const n=Oe(e.center,t.center);return y(n,0)&&y(e.radius,t.radius)?t:An(le(e.center,e.radius,t.center,t.radius),t.center[2])}function Ds(e,t){if(!pn(e.center,t.center))return;const n=Oe(e.center,t.center);return y(n,0)&&y(e.radius,t.radius)?e:An(le(e.center,e.radius,t.center,t.radius),e.center[2])}function xn(e,t){const{planeLike:n,getZ:r}=e,s=new Array;if(q(t))e.addIfOnTheGround(s,ls(n,t.point));else if(U(t))e.addIfOnTheGround(s,sn(n,t.lineLike));else if(Z(t))for(const[i,a]of oe(n,t.center,t.radius)){const o=r(i,a);o!=null&&s.push(kt(i,a,o))}else if(V(t)||Vt(t))for(const[i,a]of on(n,t.planeLike)){const o=r(i,a)??kn;s.push(kt(i,a,o))}return B(s)}function be(e){return Ut(e.map(([t,n])=>{const r=G(t,n,0),s=G(t,n,1);return new de(r,s)}))}function B(e){return Ut(e.map(t=>t?new ut(t):void 0))}function An(e,t){return B(e.map(([n,r])=>[n,r,t]))}function Ut(e){if(e.length!==0)return e.length===1?e[0]??void 0:new gn(e.filter(Fn))}function Ne(e){return e instanceof gn}function q(e){return e instanceof ut}function U(e){return e instanceof he}function Y(e){return e instanceof vn}function V(e){return e instanceof ve}function Z(e){return e instanceof yn}function W(e){return e instanceof fe}function K(e){return e instanceof ge}function $(e){return e instanceof Es}function Vt(e){return e instanceof En}function Hs(e){return e instanceof wn}function Us(e){return e instanceof Ln}const kn=0;var k;function Tn(e,t){if(e==null||t==null)return;const n=Ee(e,t);return n!=null?dt(n,"radians","geographic"):void 0}(function(e){e.Absolute="absolute",e.Relative="relative",e.RelativeBilateral="relative-bilateral"})(k||(k={}));const Ee=(()=>{const e=f(),t=f();return(n,r)=>(D(e,n.x,n.y,n.z??0),D(t,r.x,r.y,r.z??0),Mn(e,t,n.spatialReference,r.spatialReference))})(),Mn=(()=>{const e=I(),t=f(),n=f();return(r,s,i,a)=>{if(b(r,s))return;const o=Xt(i),l=Xt(a);if(o&&l&&Wn(o,l)&&It(r,i,t,o)&&It(s,a,n,l)){const{azimuth:h}=Jt(Gs,t,n,o);return h!=null?At(h,"degrees","radians"):void 0}e[0]=s[0]-r[0],e[1]=s[1]-r[1];let p=or(lr,e);return e[0]<0&&(p=Cs-p),p}})();function Vs(e,t,n,r=k.Absolute){if(t&&n)switch(r){case k.Absolute:return Tn(t,n);case k.Relative:return Le(_n(e,t,n),k.Relative);case k.RelativeBilateral:return Le(_n(e,t,n),k.RelativeBilateral)}}function _n(e,t,n){if(!e||!t||!n)return;const r=Ee(e,t),s=Ee(t,n);return r!=null&&s!=null?dt(s-r,"radians","geographic"):void 0}function Le(e,t){if(e!=null)switch(t){case k.Absolute:return Pn(e);case k.Relative:{const n=mt(e);let r=Sn.normalize(n,0,!0);return r===-180&&(r=180),dt(r,"degrees","geographic")}case k.RelativeBilateral:{const n=mt(e),r=Math.abs(Sn.normalize(n,0,!0));return dt(r,"degrees","geographic")}}}function Pn(e){const t=mt(e),n=Ys.normalize(t,0,!0);return dt(n,"degrees","geographic")}const Zs=(()=>{const e=f();return(t,n,r,s,i,a="geodesic")=>{Ct(e,n);const o=mt(i);if(a==="geodesic"){const g=Xt(r);if(g&&It(e,r,e,g))return Pt(t,e,o,s,g),t[2]=n[2],!!It(t,g,t,r)}const l=te(o,"geographic","arithmetic"),p=At(l,"degrees","radians"),h=n[0]+s*Math.cos(p),d=n[1]+s*Math.sin(p),N=n[2];return D(t,h,d,N),!0}})();function mt(e){if(e!=null)return te(Rn(e),e.rotationType,"geographic")}function Fs(e){if(e!=null)return te(Rn(e),e.rotationType,"arithmetic")}function Rn(e){return At(e.value,e.unit,"degrees")}const Gs=new Kt,Cs=2*Math.PI,Ys=xr,Sn=new Ar(-180,180);let Zt=class extends et{constructor(e){super(e),this.enabled=!1}};u([c({type:Boolean,nonNullable:!0})],Zt.prototype,"enabled",void 0),Zt=u([F("esri.views.interactive.sketch.SketchLabelOptions")],Zt);const we=Zt,Ws=Symbol("grid-placement-graphic");function In(e,t){const n=e.x-t.x,r=e.y-t.y;return n*n+r*r}function $s(e,t){return Math.sqrt(In(e,t))}function Js(e,t){t.sort((n,r)=>$t(n.targetPoint,e)-$t(r.targetPoint,e))}var xe;function Ks({point:e,distance:t,returnEdge:n,vertexMode:r,coordinateHelper:{spatialReference:s},filter:i},a,o){return o=o!=null?o.clone():new Lr({where:"1=1"}),i&&(o.geometry=i.geometry,o.distance=i.distance,o.spatialRelationship=i.spatialRelationship,o.where=$n(o.where,i.where),o.timeExtent=Er(o.timeExtent,i.timeExtent),o.objectIds=Xs(o.objectIds,i.objectIds)),{point:St(e[0],e[1],e[2],s.toJSON()),mode:a,distance:t,returnEdge:n,vertexMode:r,query:o.toJSON()}}function Xs(e,t){return e||t?t?e?Array.from(Jn(new Set(e),new Set(t))):t:e:null}function Qs(e,t,n){return{left:ie(e.leftVertex.pos,t,n),right:ie(e.rightVertex.pos,t,n)}}(function(e){e[e.TARGET=0]="TARGET",e[e.REFERENCE=1]="REFERENCE",e[e.REFERENCE_EXTENSION=2]="REFERENCE_EXTENSION"})(xe||(xe={}));const zn=Symbol("snapping-toggle");function ti(e,t=()=>{}){const n=Kn(()=>({view:e.view,snappingOptions:e.snappingOptions}),({view:r,snappingOptions:s})=>{if(e.removeHandles(zn),!r||!s)return;const i=Ve.TOOL,a=[r.on("key-down",o=>{o.key!==nn.toggle||o.repeat||(s.enabledToggled=!0,t())},i),r.on("key-up",o=>{o.key===nn.toggle&&(s.enabledToggled=!1,t())},i),r.on("pointer-move",o=>{const l=o.native.ctrlKey;s.enabledToggled!==l&&(s.enabledToggled=l,t())},i)];e.addHandles(a,zn)},Xn);e.addHandles(n)}function ei(e){return kr(e)&&"utilityNetworks"in e&&!!e.utilityNetworks?.length}let bt=class extends et{constructor(e){super(e),this.mode="absolute-height"}toJSON(){return{mode:this.mode}}};u([c({type:String,nonNullable:!0})],bt.prototype,"mode",void 0),bt=u([F("esri.views.interactive.sketch.SketchTooltipElevationOptions")],bt);let w=class extends et{constructor(e){super(e),this.area=!0,this.coordinates=!0,this.direction=!0,this.distance=!0,this.elevation=!0,this.header=!0,this.helpMessage=!1,this.orientation=!0,this.radius=!0,this.rotation=!0,this.scale=!0,this.size=!0,this.totalLength=!0}};u([c({type:Boolean,nonNullable:!0})],w.prototype,"area",void 0),u([c({type:Boolean,nonNullable:!0})],w.prototype,"coordinates",void 0),u([c({type:Boolean,nonNullable:!0})],w.prototype,"direction",void 0),u([c({type:Boolean,nonNullable:!0})],w.prototype,"distance",void 0),u([c({type:Boolean,nonNullable:!0})],w.prototype,"elevation",void 0),u([c({type:Boolean,nonNullable:!0})],w.prototype,"header",void 0),u([c({type:Boolean,nonNullable:!0})],w.prototype,"helpMessage",void 0),u([c({type:Boolean,nonNullable:!0})],w.prototype,"orientation",void 0),u([c({type:Boolean,nonNullable:!0})],w.prototype,"radius",void 0),u([c({type:Boolean,nonNullable:!0})],w.prototype,"rotation",void 0),u([c({type:Boolean,nonNullable:!0})],w.prototype,"scale",void 0),u([c({type:Boolean,nonNullable:!0})],w.prototype,"size",void 0),u([c({type:Boolean,nonNullable:!0})],w.prototype,"totalLength",void 0),w=u([F("esri.views.interactive.sketch.SketchTooltipVisibleElements")],w);const On=w;let T=class extends et{constructor(e){super(e),this.enabled=!1,this.forceEnabled=!1,this.helpMessage=null,this.helpMessageIcon=null,this.inputEnabled=!0,this.elevation=new bt,this.placement="auto",this.offset=null,this.visibleElements=new On,this.visualVariables=null,this.xyMode="auto"}get effectiveEnabled(){return this.forceEnabled||this.enabled}};u([c({type:Boolean,nonNullable:!0})],T.prototype,"enabled",void 0),u([c()],T.prototype,"forceEnabled",void 0),u([c()],T.prototype,"effectiveEnabled",null),u([c()],T.prototype,"helpMessage",void 0),u([c()],T.prototype,"helpMessageIcon",void 0),u([c({type:Boolean,nonNullable:!0})],T.prototype,"inputEnabled",void 0),u([c({type:bt,nonNullable:!0})],T.prototype,"elevation",void 0),u([c()],T.prototype,"placement",void 0),u([c()],T.prototype,"offset",void 0),u([c({type:On,nonNullable:!0})],T.prototype,"visibleElements",void 0),u([c()],T.prototype,"visualVariables",void 0),u([c()],T.prototype,"xyMode",void 0),T=u([F("esri.views.interactive.sketch.SketchTooltipOptions")],T);const Ae=T;let ct=class extends et{constructor(e){super(e),this.length=null,this.verticalLength=null,this.area=null}};u([c()],ct.prototype,"length",void 0),u([c()],ct.prototype,"verticalLength",void 0),u([c()],ct.prototype,"area",void 0),ct=u([F("esri.views.interactive.sketch.Units")],ct);const Ft=ct;let X=class extends et{constructor(e){super(e),this.directionMode="relative",this.relativeDirectionIsBilateral=!1}get effectiveDirectionMode(){switch(this.directionMode){case"relative":return this.relativeDirectionIsBilateral?k.RelativeBilateral:k.Relative;case"absolute":return k.Absolute}}get displayUnits(){return this._get("displayUnits")??new Ft}set displayUnits(e){this._set("displayUnits",e)}get inputUnits(){return this._get("inputUnits")??new Ft}set inputUnits(e){this._set("inputUnits",e)}};u([c({type:String,nonNullable:!0})],X.prototype,"directionMode",void 0),u([c({type:Boolean,nonNullable:!0})],X.prototype,"relativeDirectionIsBilateral",void 0),u([c()],X.prototype,"effectiveDirectionMode",null),u([c({type:Ft,nonNullable:!0})],X.prototype,"displayUnits",null),u([c({type:Ft,nonNullable:!0})],X.prototype,"inputUnits",null),X=u([F("esri.views.interactive.sketch.SketchValueOptions")],X);const ke=X;function ni(e){return e?.type==="graphic"}function ri(e){return e.find(ni)??null}let pt=class extends et{constructor(e){super(e),this.labels=new we,this.tooltips=new Ae,this.values=new ke}};u([c({nonNullable:!0,type:we})],pt.prototype,"labels",void 0),u([c({nonNullable:!0,type:Ae})],pt.prototype,"tooltips",void 0),u([c({nonNullable:!0,type:ke})],pt.prototype,"values",void 0),pt=u([F("esri.views.interactive.sketch.SketchOptions")],pt);const si=pt;export{Le as $,Wr as A,$r as B,Je as C,En as D,Js as E,os as F,xe as G,Me as H,Ur as I,ae as J,as as K,de as L,Zs as M,ie as N,_e as O,yn as P,rn as Q,Ns as R,ns as S,ne as T,Pr as U,ti as V,we as W,Ae as X,ke as Y,Zr as Z,Pn as _,gt as a,k as a0,Sr as a1,Ln as a2,Ot as a3,mt as a4,Ut as a5,vn as a6,Tn as a7,wn as a8,Ge as a9,q as aa,$e as ab,Ce as ac,Ke as ad,Vs as ae,Yr as af,Fs as ag,ee as ah,Br as ai,Or as aj,jr as ak,qr as al,Mr as am,zt as an,Rr as ao,es as ap,Xe as aq,ts as ar,rs as as,Fe as at,Ye as au,Qr as b,_ as c,Ws as d,G as e,se as f,ut as g,Ks as h,si as i,ei as j,it as k,_r as l,bs as m,$s as n,ft as o,is as p,Cr as q,Kr as r,Xr as s,Qs as t,In as u,Mn as v,m as w,Vr as x,zr as y,ri as z};
