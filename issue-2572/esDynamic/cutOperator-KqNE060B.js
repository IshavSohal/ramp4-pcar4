import{b_ as q}from"./main-DqrbaFR_.js";import{a as j,b as R,o as B}from"./Transformation2D-Dqu-RtOz.js";import{N as w,aN as F,w as H,a as f,T as x,aO as U,aP as b,aQ as S,aR as T,aS as J,a9 as D,aT as K}from"./ProjectionTransformation-OrRMu_VQ.js";import"./jsonConverter-CJB03_A6.js";import{t as L}from"./SimpleGeometryCursor-DSF_YyIm.js";import{getSpatialReference as W,fromSpatialReference as X,fromPolyline as Y,fromGeometry as Z,toGeometry as $}from"./apiConverter-BUNqZecw.js";var z=K;function g(l,e){return{m_geometry:l,m_side:e}}function tt(l,e,r,t,u,o){if(e.isEmpty()){const a=g(e,0);return void u.push(a)}if(r.isEmpty()){const a=g(e,0);return void u.push(a)}const s=[],n=new x;{const a=n.createGeometryUserIndex(),C=n.addGeometry(e),k=n.addGeometry(r),d=new U(o);let p=0,c=null;if(n.hasCurves()){c=new z;const h=n.getEnvelope2D(o);p=b(t.total());const _=S(t.total(),h);T(n,_,t.total(),12e3,c,null,o)}n.dbgVerifyCurves(),d.setEditShapeCrackAndCluster(n,t),d.cut(l,a,C,k,s);for(const h of s){c!==null&&c.stitchCurves(n,h,p,!1);const _=g(n.getGeometry(h),J(n.getGeometryUserIndex(h,a)));u.push(_)}c!==null&&c.clearStitcher(n)}}function et(l,e,r,t,u,o){if(e.isEmpty()){const a=g(e,0);return void u.push(a)}if(r.isEmpty()){const a=g(e,0);return void u.push(a)}const s=[],n=new x;{const a=n.createGeometryUserIndex(),C=n.addGeometry(e),k=n.addGeometry(r),d=new U(o);let p=0,c=null;if(n.hasCurves()){c=new z;const m=n.getEnvelope2D(o);p=b(t.total());const y=S(t.total(),m);T(n,y,t.total(),12e3,c,null,o)}n.dbgVerifyCurves(),d.setEditShapeCrackAndCluster(n,t),d.cut(!1,a,C,k,s),c!==null&&c.stitchCurves(n,D,p,!0);let h=n.getGeometry(C);const _=new f,v=new f,E=[];for(let m=0;m<s.length;m++){let y=null;{const i=new x,I=i.addGeometry(h),P=i.addGeometry(n.getGeometry(s[m]));if(i.hasCurves()){const O=i.getEnvelope2D(o);p=b(t.total());const Q=S(t.total(),O);T(i,Q,t.total(),12e3,c,null,o)}d.setEditShapeCrackAndCluster(i,t);const A=d.intersection(I,P);if(c!==null&&c.stitchCurves(i,D,p,!0),y=i.getGeometry(A),y.isEmpty())continue;const G=n.getGeometryUserIndex(s[m],a);G===2?_.add(y,!1):G===1?v.add(y,!1):E.push(y)}{const i=new x,I=i.addGeometry(h),P=i.addGeometry(n.getGeometry(s[m]));if(i.hasCurves()){const G=i.getEnvelope2D(o);p=b(t.total());const O=S(t.total(),G);T(i,O,t.total(),12e3,c,null,o)}d.setEditShapeCrackAndCluster(i,t);const A=d.difference(I,P);c!==null&&c.stitchCurves(i,D,p,!0),h=i.getGeometry(A)}}if(!h.isEmpty()&&s.length>0&&E.push(h),_.isEmpty()&&v.isEmpty())return;if(!_.isEmpty()){const m=g(_,1);u.push(m)}if(!v.isEmpty()){const m=g(v,2);u.push(m)}for(let m=0,y=E.length;m<y;++m){const i=g(E[m],3);u.push(i)}}}class st{getOperatorType(){return 10005}accelerateGeometry(e,r,t){return!1}canAccelerateGeometry(e){return!1}supportsCurves(){return!0}execute(e,r,t,u,o){return new nt(e,r,t,u,o)}}class nt extends L{constructor(e,r,t,u,o){super(),this.m_cutIndex=-1,this.m_cuts=[],this.m_progressTracker=o,this.m_cuttee=r.clone(),this.m_cutter=new w({copy:t}),this.m_bConsiderTouch=e;const s=F(r,t);this.m_tolerance=H(u,s,!0)}next(){return this.m_cutIndex===-1&&this.generateCuts(),++this.m_cutIndex<this.m_cuts.length?this.m_cuts[this.m_cutIndex]:null}getGeometryID(){return this.m_cutIndex}tock(){return!0}getRank(){return 1}generateCuts(){switch(this.m_cuttee.getGeometryType()){case j.enumPolyline:this.generatePolylineCuts();break;case j.enumPolygon:this.generatePolygonCuts()}}generatePolylineCuts(){const e=new w,r=new w,t=new w;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(r);const u=[];tt(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,u,this.m_progressTracker);for(let o=0;o<u.length;o++){const s=u[o];s.m_side===1?e.add(s.m_geometry,!1):s.m_side===2||s.m_side===4?r.add(s.m_geometry,!1):s.m_side===3?this.m_cuts.push(s.m_geometry):s.m_side===0?t.add(s.m_geometry,!1):R("")}t.isEmpty()||e.isEmpty()&&r.isEmpty()&&!(this.m_cuts.length>=3)||this.m_cuts.push(t),e.isEmpty()&&r.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}generatePolygonCuts(){const e=new f,r=new f,t=new f;this.m_cuts.length=0,this.m_cuts.push(e),this.m_cuts.push(r);const u=[];et(this.m_bConsiderTouch,this.m_cuttee,this.m_cutter,this.m_tolerance,u,this.m_progressTracker);for(let o=0;o<u.length;o++){const s=u[o];s.m_side===1?e.add(s.m_geometry,!1):s.m_side===2?r.add(s.m_geometry,!1):s.m_side===3?this.m_cuts.push(s.m_geometry):s.m_side===0?t.add(s.m_geometry,!1):R("")}B(t.isEmpty()||u.length===1),e.isEmpty()&&r.isEmpty()&&this.m_cuts.length<3&&(this.m_cuts.length=0)}}const M=new st;function rt(l,e,r){const t=M.execute(!0,l,e,r,null);return Array.from(t)}function ot(){return M.supportsCurves()}function N(l,e){const r=W(l);return rt(Z(l),Y(e),X(r)).map(t=>$(t,r)).filter(q)}const V=ot(),ut=Object.freeze(Object.defineProperty({__proto__:null,execute:N,supportsCurves:V},Symbol.toStringTag,{value:"Module"})),it=Object.freeze(Object.defineProperty({__proto__:null,execute:N,supportsCurves:V},Symbol.toStringTag,{value:"Module"}));export{it as c,ut as i};
