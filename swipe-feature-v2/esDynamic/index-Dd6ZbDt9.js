import{dM as E,F as w,e2 as f,dO as S,e4 as x,e3 as m,dQ as y,e6 as A,e8 as O,e9 as C,dS as _,dY as b,dX as g,gh as T,dT as N,gk as H,e0 as I,dU as M,fN as V,gl as v}from"./main-BZ5cNcLx.js";const W={class:"swipe-container"},k=["id","aria-valuenow","aria-label","content"],B=E({__name:"swipe",props:{fixture:{type:w,required:!0},message:String},setup($){const l=f("iApi"),t=S(),e=x("slider"),s=m(45),a=m(0),i=m(0),d=y(()=>{const r=30+i.value-i.value,o=e.value?.clientWidth??0,p=+s.value/90,c=(o-r)*p,h=(e.value?.getBoundingClientRect().x??0)+c+(r-4)/2,L=new CustomEvent("MoveInput",{detail:h});return e.value?.dispatchEvent(L),`${h}px`}),n=y(()=>`${a.value}px`),u=y(()=>`${-65*(a.value/1270)}px`);return A(()=>{a.value=l?.$rootEl?.clientHeight??1200}),O(()=>{window.addEventListener("resize",()=>{a.value=l?.$rootEl?.clientHeight??a.value,i.value++,setTimeout(()=>{i.value++},50)}),e.value?.addEventListener("focus",()=>t.setOpacity(.1)),e.value?.addEventListener("blur",()=>t.setOpacity(1)),e.value?.addEventListener("mouseover",()=>t.setOpacity(.1)),e.value?.addEventListener("mouseleave",()=>t.setOpacity(1)),setTimeout(()=>{i.value++},50)}),C(()=>{window.removeEventListener("resize",()=>{a.value=l?.$rootEl?.clientHeight??a.value,i.value++,setTimeout(()=>{i.value++},50)}),e.value?.removeEventListener("focus",()=>t.setOpacity(.1)),e.value?.removeEventListener("blur",()=>t.setOpacity(1)),e.value?.removeEventListener("mouseover",()=>t.setOpacity(.1)),e.value?.removeEventListener("mouseleave",()=>t.setOpacity(1))}),(r,o)=>{const p=_("tippy");return M(),b("div",W,[g("div",{id:"verticalLine",style:T({left:d.value,height:n.value,bottom:u.value})},null,4),N(g("input",{"onUpdate:modelValue":o[0]||(o[0]=c=>s.value=c),id:"layerSlider"+I(l)?.$element._uid,class:"layerSliderElement",type:"range",ref_key:"slider",ref:e,min:"0","aria-valuemin":"0","aria-valuemax":"90","aria-valuenow":s.value,"aria-label":r.$t("map.layerSwipe.label"),max:"90",step:"0.5",content:r.$t("map.layerSwipe.drag")},null,8,k),[[H,s.value],[p,{followCursor:!0}]])])}}}),q=V(B,[["__scopeId","data-v-e91788a6"]]);class z extends w{async added(){const{el:l,destroy:t}=this.mount(q,{app:this.$element,props:{message:"This is a swipe.",fixture:this}});this.$vApp.$el.appendChild(l.childNodes[0]);const e=await v.Collection(),s=await v.Collection();await this.$iApi.geo.map.viewPromise;let a=this.$iApi.geo.map.esriView;const i=this.$iApi.geo.layer.getLayer("Nature")?.esriLayer,d=this.$iApi.geo.layer.getLayer("Water")?.esriLayer;e.add(i),s.add(d);let n=await v.Swipe({view:a,leadingLayers:e,trailingLayers:s,position:50});const u="#layerSlider"+this.$element._uid;this.$vApp.$el.querySelector(u)?.addEventListener("MoveInput",r=>{const o=r;n.position=o.detail/this.$iApi?.$rootEl.clientWidth*100}),window.addEventListener("BasemapSchemaChange",async()=>{n.destroy(),a=this.$iApi.geo.map.esriView,n=await v.Swipe({view:a,leadingLayers:e,trailingLayers:s,position:50})}),this.removed=()=>{this.$vApp.$el.removeChild(l.childNodes[0]),n.destroy(),t()}}}export{z as default};
