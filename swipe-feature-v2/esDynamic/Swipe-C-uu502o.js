import{k as n,o as r,V as _,A as L,aD as E,aE as x,cR as $,aG as C}from"./main-BZ5cNcLx.js";import{e as A,B as R,n as y}from"./jsxFactory-Dvyx1e7e.js";import{e as b}from"./globalCss-5EsmA6Hu.js";import{i as f}from"./legacyIcon-C0bqkO_Y.js";import{p as u}from"./ClipRect-DF-ksBTL.js";function z(e,i){const t=10**i;return Math.round(e*t)/t}const w={left:0,right:0,top:0,bottom:0};let p=class extends E{constructor(e){super(e),this._leadingClips=new Map,this._trailingClips=new Map,this.direction="horizontal",this.leadingLayers=new _,this.max=100,this.min=0,this.precision=4,this.step=.5,this.stepMultiplier=10,this.trailingLayers=new _,this.view=null}initialize(){this.addHandles([x(()=>[this.view,this.view?.ready,this.position,this.direction],()=>this._clipLayers(),$),C(()=>this.leadingLayers,"change",()=>this._clipLeadingLayers()),C(()=>this.trailingLayers,"change",()=>this._clipTrailingLayers())])}destroy(){this._removeExistingClips()}get position(){return 25}set position(e){const{precision:i,min:t,max:o}=this;this._set("position",z(Math.max(Math.min(e,o),t),i))}get state(){return this.view?.ready?"ready":"disabled"}_clipLayers(){this._clipLeadingLayers(),this._clipTrailingLayers()}_clipLeadingLayers(){this._removeClips("leading");const{leadingLayers:e}=this;e.forEach(i=>this._clipLayer({layer:i,type:"leading"}))}_clipTrailingLayers(){this._removeClips("trailing");const{trailingLayers:e}=this;e.forEach(i=>this._clipLayer({layer:i,type:"trailing"}))}async _getLayerView(e){const{view:i}=this;if(!e||!i)return null;const t=await i.whenLayerView(e);return"clips"in t?t:null}_getVerticalClipRect(e){const{position:i}=this;return e==="leading"?new u({...w,bottom:100-i+"%"}):e==="trailing"?new u({...w,top:`${i}%`}):null}_getHorizontalClipRect(e){const{position:i}=this;return e==="leading"?new u({...w,right:100-i+"%"}):e==="trailing"?new u({...w,left:`${i}%`}):null}_getClipRect(e){const{direction:i}=this;return i==="vertical"?this._getVerticalClipRect(e):i==="horizontal"?this._getHorizontalClipRect(e):null}async _clipLayer(e){const{_leadingClips:i,_trailingClips:t}=this,{layer:o,type:d}=e,s=d==="trailing"?t:d==="leading"?i:null,a=await this._getLayerView(o);if(!(a&&"clips"in a&&s&&a.hasOwnProperty("clips")))return;const c=s.get(a);c&&a.clips.remove(c);const h=this._getClipRect(d);h&&(s.set(a,h),a.clips.add(h))}_removeClips(e){const{_leadingClips:i,_trailingClips:t}=this,o=e==="trailing"?t:e==="leading"?i:null;o&&(o.forEach((d,s)=>{s&&s.hasOwnProperty("clips")&&s.clips.remove(d)}),o.clear())}_removeExistingClips(){this._removeClips("leading"),this._removeClips("trailing")}};n([r()],p.prototype,"direction",void 0),n([r({type:_,nonNullable:!0})],p.prototype,"leadingLayers",void 0),n([r({readOnly:!0})],p.prototype,"max",void 0),n([r({readOnly:!0})],p.prototype,"min",void 0),n([r()],p.prototype,"position",null),n([r()],p.prototype,"precision",void 0),n([r({readOnly:!0})],p.prototype,"state",null),n([r()],p.prototype,"step",void 0),n([r()],p.prototype,"stepMultiplier",void 0),n([r({type:_,nonNullable:!0})],p.prototype,"trailingLayers",void 0),n([r()],p.prototype,"view",void 0),p=n([L("esri.widgets.Swipe.SwipeViewModel")],p);const M=p,g="esri-swipe",v={base:g,baseDisabled:`${g}--disabled`,vertical:`${g}--vertical`,horizontal:`${g}--horizontal`,container:`${g}__container`,divider:`${g}__divider`,handle:`${g}__handle`,handleHidden:`${g}__handle--hidden`,handleIcon:`${g}__handle-icon`},P={handle:!0,divider:!0};let l=class extends R{constructor(e,i){super(e,i),this.disabled=!1,this.messages=null,this.viewModel=new M,this._pointerOffset=0,this._container=null,this._onContainerPointerDown=this._onContainerPointerDown.bind(this),this._onContainerPointerMove=this._onContainerPointerMove.bind(this),this._onContainerPointerUp=this._onContainerPointerUp.bind(this)}get direction(){return this.viewModel.direction}set direction(e){this.viewModel.direction=e}get dragLabel(){return this.messages?.dragLabel??""}set dragLabel(e){this._overrideIfSome("dragLabel",e)}get icon(){return"compare"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}get leadingLayers(){return this.viewModel.leadingLayers}set leadingLayers(e){this.viewModel.leadingLayers=e}get position(){return this.viewModel.position}set position(e){this.viewModel.position=e}get trailingLayers(){return this.viewModel.trailingLayers}set trailingLayers(e){this.viewModel.trailingLayers=e}get view(){return this.viewModel.view}set view(e){this.viewModel.view=e}set visibleElements(e){this._set("visibleElements",{...P,...e})}get visibleElements(){return this._get("visibleElements")||P}render(){const{state:e,direction:i}=this.viewModel,t=e==="disabled"||this.disabled,o={[b.disabled]:t,[v.baseDisabled]:t,[v.vertical]:i==="vertical",[v.horizontal]:i==="horizontal"};return y("div",{class:this.classes(v.base,b.widget,o)},e==="disabled"?null:this._renderContainer())}_renderHandle(){const{direction:e}=this.viewModel,{visibleElements:i}=this,t={[f.dragHorizontal]:e==="vertical",[f.dragVertical]:e==="horizontal"},o=this.classes(v.handle,!i.handle&&v.handleHidden);return y("div",{class:o,key:"handle",role:"presentation"},y("span",{"aria-hidden":"true",class:this.classes(v.handleIcon,t)}))}_renderDivider(){const{visibleElements:e}=this;return e&&e.divider?y("div",{class:v.divider,key:"divider",role:"presentation"}):null}_renderContent(){return[this._renderDivider(),this._renderHandle()]}_renderContainer(){const{disabled:e,dragLabel:i,viewModel:t}=this,{max:o,min:d,direction:s,position:a}=t,c=`${a}%`,h={top:s==="vertical"?c:void 0,left:s==="vertical"?void 0:c},m=this._renderContent();return y("div",e?{class:v.container,key:"container",role:"presentation",styles:h}:{afterCreate:this._afterContainerCreate,"aria-label":i,"aria-orientation":s,"aria-valuemax":`${o}`,"aria-valuemin":`${d}`,"aria-valuenow":`${a}`,"aria-valuetext":c,bind:this,class:v.container,key:"container",onkeydown:this._onContainerKeyDown,role:"slider",styles:h,tabIndex:0,title:i,"touch-action":"none"},m)}_afterContainerCreate(e){this._container=e,e.addEventListener("pointerdown",this._onContainerPointerDown)}_calculatePointerOffset(e){const{direction:i}=this,t=e.target,o=(i==="vertical"?t.clientHeight:t.clientWidth)/2,d=t.getBoundingClientRect(),s=e.clientX-d.left,a=e.clientY-d.top;this._pointerOffset=i==="vertical"?a-o:s-o}_onContainerPointerDown(e){e.preventDefault(),this._container&&document.activeElement!==this.container&&this._container.focus(),this._calculatePointerOffset(e),document.addEventListener("pointerup",this._onContainerPointerUp),document.addEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerUp(e){e.preventDefault(),document.removeEventListener("pointerup",this._onContainerPointerUp),document.removeEventListener("pointermove",this._onContainerPointerMove)}_onContainerPointerMove(e){e.preventDefault();const{_pointerOffset:i,container:t,direction:o}=this,{clientX:d,clientY:s}=e,{top:a,left:c,width:h,height:m}=t.getBoundingClientRect(),D=(o==="vertical"?s-a-i:d-c-i)/(o==="vertical"?m:h)*100;this.position=D}_getKeyPosition(e){const{key:i}=e,{position:t}=this,{max:o,min:d,step:s,stepMultiplier:a,direction:c}=this.viewModel,h=s*a;return["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Home","End","PageUp","PageDown"].includes(i)&&(e.preventDefault(),e.stopPropagation()),(c==="vertical"?i==="ArrowDown"||i==="ArrowRight":i==="ArrowUp"||i==="ArrowRight")?t+(e.shiftKey?h:s):(c==="vertical"?i==="ArrowUp"||i==="ArrowLeft":i==="ArrowDown"||i==="ArrowLeft")?t-(e.shiftKey?h:s):i==="Home"?d:i==="End"?o:(c==="vertical"?i==="PageDown":i==="PageUp")?t+h:(c==="vertical"?i==="PageUp":i==="PageDown")?t-h:null}_onContainerKeyDown(e){const i=this._getKeyPosition(e);typeof i=="number"&&(this.position=i)}};n([r()],l.prototype,"direction",null),n([r()],l.prototype,"disabled",void 0),n([r()],l.prototype,"dragLabel",null),n([r()],l.prototype,"icon",null),n([r()],l.prototype,"label",null),n([r()],l.prototype,"leadingLayers",null),n([r(),A("esri/widgets/Swipe/t9n/Swipe")],l.prototype,"messages",void 0),n([r()],l.prototype,"position",null),n([r()],l.prototype,"trailingLayers",null),n([r()],l.prototype,"view",null),n([r({type:M})],l.prototype,"viewModel",void 0),n([r()],l.prototype,"visibleElements",null),l=n([L("esri.widgets.Swipe")],l);const H=l;export{H as default};
