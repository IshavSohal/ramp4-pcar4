import{dM as E,F as g,e2 as L,dO as S,e4 as _,e3 as m,dQ as h,e6 as x,e8 as A,e9 as C,dS as O,dY as B,dX as w,gm as T,dT as b,gn as I,e0 as M,dU as P,fQ as H,go as u}from"./main-BmfnUD3g.js";import"./preload-helper-ExcqyqRp.js";const V={class:"swipe-container"},W=["id","aria-valuenow","aria-label","content"],N=E({__name:"swipe",props:{fixture:{type:g,required:!0},message:String},setup($){const n=L("iApi"),i=S(),e=_("slider"),s=m(45),t=m(0),a=m(0),p=h(()=>{const r=30+a.value-a.value,l=e.value?.clientWidth??0,d=+s.value/90,c=(l-r)*d,y=(e.value?.getBoundingClientRect().x??0)+c+(r-4)/2,f=new CustomEvent("MoveInput",{detail:y});return e.value?.dispatchEvent(f),`${y}px`}),o=h(()=>`${t.value}px`),v=h(()=>`${-65*(t.value/1270)}px`);return x(()=>{t.value=n?.$rootEl?.clientHeight??1200}),A(()=>{window.addEventListener("resize",()=>{t.value=n?.$rootEl?.clientHeight??t.value,a.value++,setTimeout(()=>{a.value++},50)}),e.value?.addEventListener("focus",()=>i.setOpacity(.1)),e.value?.addEventListener("blur",()=>i.setOpacity(1)),e.value?.addEventListener("mouseover",()=>i.setOpacity(.1)),e.value?.addEventListener("mouseleave",()=>i.setOpacity(1)),setTimeout(()=>{a.value++},50)}),C(()=>{window.removeEventListener("resize",()=>{t.value=n?.$rootEl?.clientHeight??t.value,a.value++,setTimeout(()=>{a.value++},50)}),e.value?.removeEventListener("focus",()=>i.setOpacity(.1)),e.value?.removeEventListener("blur",()=>i.setOpacity(1)),e.value?.removeEventListener("mouseover",()=>i.setOpacity(.1)),e.value?.removeEventListener("mouseleave",()=>i.setOpacity(1))}),(r,l)=>{const d=O("tippy");return P(),B("div",V,[w("div",{id:"verticalLine",style:T({left:p.value,height:o.value,bottom:v.value})},null,4),b(w("input",{"onUpdate:modelValue":l[0]||(l[0]=c=>s.value=c),id:"layerSlider"+M(n)?.$element._uid,class:"layerSliderElement",type:"range",ref_key:"slider",ref:e,min:"0","aria-valuemin":"0","aria-valuemax":"90","aria-valuenow":s.value,"aria-label":r.$t("map.layerSwipe.label"),max:"90",step:"0.5",content:r.$t("map.layerSwipe.drag")},null,8,W),[[I,s.value],[d,{followCursor:!0}]])])}}}),k=H(N,[["__scopeId","data-v-cd6061f0"]]);class U extends g{async added(){const{el:n,destroy:i}=this.mount(k,{app:this.$element,props:{message:"This is a swipe.",fixture:this}});this.$vApp.$el.appendChild(n.childNodes[0]);const e=await u.Collection(),s=await u.Collection();await this.$iApi.geo.map.viewPromise;let t=this.$iApi.geo.map.esriView;const a=this.$iApi.geo.layer.getLayer("Nature")?.esriLayer,p=this.$iApi.geo.layer.getLayer("Water")?.esriLayer;e.add(a),s.add(p);let o=await u.Swipe({view:t,leadingLayers:e,trailingLayers:s,position:50});const v="#layerSlider"+this.$element._uid;this.$vApp.$el.querySelector(v)?.addEventListener("MoveInput",l=>{const d=l;o.position=d.detail/this.$iApi?.$rootEl.clientWidth*100}),window.addEventListener("BasemapSchemaChange",async()=>{o.destroy(),t=this.$iApi.geo.map.esriView,o=await u.Swipe({view:t,leadingLayers:e,trailingLayers:s,position:50})}),this.removed=()=>{this.$vApp.$el.removeChild(n.childNodes[0]),o.destroy(),i()}}}export{U as default};
