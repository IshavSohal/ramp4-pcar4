import{cc as C,cd as j,ce as h,cf as $,cg as R,ch as w,ao as x,ci as O,bs as v,cj as b,ck as B,H as Y,cl as z,cm as H,cn as J,ap as S,co as W}from"./main-DFK8jSbu.js";import{e as q}from"./mat3f64-q3fE-ZOt.js";import{o as g,e as D}from"./mat4f64-CSKppSlJ.js";import{a as E}from"./spatialReferenceEllipsoidUtils-DRDp9obx.js";import{u as G}from"./computeTranslationToOriginAndRotation-DJAc2PK0.js";import{t as L,o as I}from"./DoubleArray-4aYsOW9A.js";import{i as P,T as y}from"./BufferView-CEl8sR5b.js";import{f as K,l as V,e as k}from"./vec3-C7Bs7UPg.js";import{n as Q}from"./vec4-vJ-WKNIY.js";import"./preload-helper-ExcqyqRp.js";const lr="Projection may be possible after calling projection.load().";function ur(r,o,t,e){r.error(`Failed to project from (wkid:${o.wkid}) to (wkid:${t.wkid}).${e?" ":""}${e}`)}function pr(r,o,t,e,n){return M(T.TO_PCPF,P.fromTypedArray(r),m.NORMAL,y.fromTypedArray(o),y.fromTypedArray(t),e,P.fromTypedArray(n))?n:null}function mr(r,o,t,e,n){return M(T.FROM_PCPF,P.fromTypedArray(r),m.NORMAL,y.fromTypedArray(o),y.fromTypedArray(t),e,P.fromTypedArray(n))?n:null}function Tr(r,o,t){return C(r,o,0,t,E(o),0,r.length/3)?t:null}function Pr(r,o,t){return C(r,E(t),0,o,t,0,r.length/3)?o:null}function yr(r,o,t){return j(c,t),K(o,r,c),h(c)&&V(o,o),o}function Ar(r,o,t){return $(c,t),Q(o,r,c),h(c)&&V(o,o,4),o}function Fr(r,o,t,e,n){if(!M(T.TO_PCPF,P.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),m.TANGENT,y.fromTypedArray(o),y.fromTypedArray(t),e,P.fromTypedArray(n,4*Float32Array.BYTES_PER_ELEMENT)))return null;for(let s=3;s<r.length;s+=4)n[s]=r[s];return n}function dr(r,o,t,e,n){if(!M(T.FROM_PCPF,P.fromTypedArray(r,16),m.TANGENT,y.fromTypedArray(o),y.fromTypedArray(t),e,P.fromTypedArray(n,16)))return null;for(let s=3;s<r.length;s+=4)n[s]=r[s];return n}var m,T;function _(r,o,t,e,n){switch(G(e,t,p,e),r===T.FROM_PCPF&&W(p,p),o){case m.NORMAL:return j(n,p);case m.TANGENT:return $(n,p)}}function M(r,o,t,e,n,s,u){if(!o)return;const f=e.count,A=E(s);if(U(s))for(let i=0;i<f;i++)n.getVec(i,N),o.getVec(i,l),R(l,l,_(r,t,N,A,c)),u.setVec(i,l);else for(let i=0;i<f;i++){n.getVec(i,N),o.getVec(i,l);const F=w(e.get(i,1));let a=Math.cos(F);t===m.TANGENT!=(r===T.TO_PCPF)&&(a=1/a),_(r,t,N,A,c),r===T.TO_PCPF?(c[0]*=a,c[1]*=a,c[2]*=a,c[3]*=a,c[4]*=a,c[5]*=a):(c[0]*=a,c[3]*=a,c[6]*=a,c[1]*=a,c[4]*=a,c[7]*=a),R(l,l,c),x(l,l),u.setVec(i,l)}return u}function gr(r){return r.vertexSpace.type==="local"?X(r):Z(r)}function X({vertexSpace:r,transform:o,inSpatialReference:t,outSpatialReference:e,localMode:n,outPositions:s,positions:u}){const f=r.origin??O,A=r.origin!=null?o?.localMatrix??g:g,i=E(t),F=e.isWebMercator&&n||!v(t,i)?t:i;G(t,f,p,F),b(p,p,A);const a=s??L(u.length);return k(a,u,p),C(a,F,0,a,e,0,a.length/3),a}function Z({vertexSpace:r,transform:o,outPositions:t,positions:e,inSpatialReference:n,outSpatialReference:s}){const u=r.origin!=null?o?.localMatrix??g:g,f=t??L(e.length);B(u,g)?I(f,e):k(f,e,u);const A=r.origin??O;if(!Y(A,O)){const[i,F,a]=A;for(let d=0;d<f.length;d+=3)f[d]+=i,f[d+1]+=F,f[d+2]+=a}return C(f,n,0,f,s,0,f.length/3)?f:null}function U(r){return r.isWGS84||z(r)||H(r)||J(r)}(function(r){r[r.NORMAL=0]="NORMAL",r[r.TANGENT=1]="TANGENT"})(m||(m={})),function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF"}(T||(T={}));const N=S(),l=S(),p=D(),c=q();export{m as VectorType,lr as loadProjectErrorMessage,ur as logProjectionError,gr as project,Pr as projectFromPCPF,mr as projectNormalFromPCPF,pr as projectNormalToPCPF,dr as projectTangentFromPCPF,Fr as projectTangentToPCPF,Tr as projectToPCPF,yr as transformNormal,Ar as transformTangent};
