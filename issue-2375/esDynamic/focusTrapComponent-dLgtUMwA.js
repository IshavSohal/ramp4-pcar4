import{f as ee,b as te,d as C,e as ne,h as re,j as N,k as D}from"./dom-BHTTQ4_z.js";import{ev as oe}from"./main-C02UbYD7.js";function ae(n,i,o){return(i=se(i))in n?Object.defineProperty(n,i,{value:o,enumerable:!0,configurable:!0,writable:!0}):n[i]=o,n}function Q(n,i){var o=Object.keys(n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(n);i&&(c=c.filter(function(s){return Object.getOwnPropertyDescriptor(n,s).enumerable})),o.push.apply(o,c)}return o}function V(n){for(var i=1;i<arguments.length;i++){var o=arguments[i]!=null?arguments[i]:{};i%2?Q(Object(o),!0).forEach(function(c){ae(n,c,o[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):Q(Object(o)).forEach(function(c){Object.defineProperty(n,c,Object.getOwnPropertyDescriptor(o,c))})}return n}function ie(n,i){if(typeof n!="object"||!n)return n;var o=n[Symbol.toPrimitive];if(o!==void 0){var c=o.call(n,i||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(i==="string"?String:Number)(n)}function se(n){var i=ie(n,"string");return typeof i=="symbol"?i:i+""}var W={activateTrap:function(n,i){if(n.length>0){var o=n[n.length-1];o!==i&&o.pause()}var c=n.indexOf(i);c===-1||n.splice(c,1),n.push(i)},deactivateTrap:function(n,i){var o=n.indexOf(i);o!==-1&&n.splice(o,1),n.length>0&&n[n.length-1].unpause()}},ce=function(n){return n.tagName&&n.tagName.toLowerCase()==="input"&&typeof n.select=="function"},ue=function(n){return n?.key==="Escape"||n?.key==="Esc"||n?.keyCode===27},P=function(n){return n?.key==="Tab"||n?.keyCode===9},le=function(n){return P(n)&&!n.shiftKey},de=function(n){return P(n)&&n.shiftKey},X=function(n){return setTimeout(n,0)},Z=function(n,i){var o=-1;return n.every(function(c,s){return i(c)?(o=s,!1):!0}),o},G=function(n){for(var i=arguments.length,o=new Array(i>1?i-1:0),c=1;c<i;c++)o[c-1]=arguments[c];return typeof n=="function"?n.apply(void 0,o):n},R=function(n){return n.target.shadowRoot&&typeof n.composedPath=="function"?n.composedPath()[0]:n.target},fe=[],be=function(n,i){var o=i?.document||document,c=i?.trapStack||fe,s=V({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:le,isKeyBackward:de},i),r={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0},m,p=function(e,t,a){return e&&e[t]!==void 0?e[t]:s[a||t]},g=function(e,t){var a=typeof t?.composedPath=="function"?t.composedPath():void 0;return r.containerGroups.findIndex(function(l){var u=l.container,d=l.tabbableNodes;return u.contains(e)||a?.includes(u)||d.find(function(f){return f===e})})},O=function(e){var t=s[e];if(typeof t=="function"){for(var a=arguments.length,l=new Array(a>1?a-1:0),u=1;u<a;u++)l[u-1]=arguments[u];t=t.apply(void 0,l)}if(t===!0&&(t=void 0),!t){if(t===void 0||t===!1)return t;throw new Error("`".concat(e,"` was specified but was not a node, or did not return a node"))}var d=t;if(typeof t=="string"&&(d=o.querySelector(t),!d))throw new Error("`".concat(e,"` as selector refers to no known node"));return d},F=function(){var e=O("initialFocus");if(e===!1)return!1;if(e===void 0||!C(e,s.tabbableOptions))if(g(o.activeElement)>=0)e=o.activeElement;else{var t=r.tabbableGroups[0],a=t&&t.firstTabbableNode;e=a||O("fallbackFocus")}if(!e)throw new Error("Your focus-trap needs to have at least one focusable element");return e},T=function(){if(r.containerGroups=r.containers.map(function(e){var t=ne(e,s.tabbableOptions),a=re(e,s.tabbableOptions),l=t.length>0?t[0]:void 0,u=t.length>0?t[t.length-1]:void 0,d=a.find(function(b){return N(b)}),f=a.slice().reverse().find(function(b){return N(b)}),v=!!t.find(function(b){return D(b)>0});return{container:e,tabbableNodes:t,focusableNodes:a,posTabIndexesFound:v,firstTabbableNode:l,lastTabbableNode:u,firstDomTabbableNode:d,lastDomTabbableNode:f,nextTabbableNode:function(b){var w=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,E=t.indexOf(b);return E<0?w?a.slice(a.indexOf(b)+1).find(function(y){return N(y)}):a.slice(0,a.indexOf(b)).reverse().find(function(y){return N(y)}):t[E+(w?1:-1)]}}}),r.tabbableGroups=r.containerGroups.filter(function(e){return e.tabbableNodes.length>0}),r.tabbableGroups.length<=0&&!O("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(r.containerGroups.find(function(e){return e.posTabIndexesFound})&&r.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")},I=function(e){var t=e.activeElement;if(t)return t.shadowRoot&&t.shadowRoot.activeElement!==null?I(t.shadowRoot):t},h=function(e){if(e!==!1&&e!==I(document)){if(!e||!e.focus){h(F());return}e.focus({preventScroll:!!s.preventScroll}),r.mostRecentlyFocusedNode=e,ce(e)&&e.select()}},A=function(e){var t=O("setReturnFocus",e);return t||(t===!1?!1:e)},S=function(e){var t=e.target,a=e.event,l=e.isBackward,u=l===void 0?!1:l;t=t||R(a),T();var d=null;if(r.tabbableGroups.length>0){var f=g(t,a),v=f>=0?r.containerGroups[f]:void 0;if(f<0)u?d=r.tabbableGroups[r.tabbableGroups.length-1].lastTabbableNode:d=r.tabbableGroups[0].firstTabbableNode;else if(u){var b=Z(r.tabbableGroups,function(L){var B=L.firstTabbableNode;return t===B});if(b<0&&(v.container===t||C(t,s.tabbableOptions)&&!N(t,s.tabbableOptions)&&!v.nextTabbableNode(t,!1))&&(b=f),b>=0){var w=b===0?r.tabbableGroups.length-1:b-1,E=r.tabbableGroups[w];d=D(t)>=0?E.lastTabbableNode:E.lastDomTabbableNode}else P(a)||(d=v.nextTabbableNode(t,!1))}else{var y=Z(r.tabbableGroups,function(L){var B=L.lastTabbableNode;return t===B});if(y<0&&(v.container===t||C(t,s.tabbableOptions)&&!N(t,s.tabbableOptions)&&!v.nextTabbableNode(t))&&(y=f),y>=0){var J=y===r.tabbableGroups.length-1?0:y+1,H=r.tabbableGroups[J];d=D(t)>=0?H.firstTabbableNode:H.firstDomTabbableNode}else P(a)||(d=v.nextTabbableNode(t))}}else d=O("fallbackFocus");return d},x=function(e){var t=R(e);if(!(g(t,e)>=0)){if(G(s.clickOutsideDeactivates,e)){m.deactivate({returnFocus:s.returnFocusOnDeactivate});return}G(s.allowOutsideClick,e)||e.preventDefault()}},K=function(e){var t=R(e),a=g(t,e)>=0;if(a||t instanceof Document)a&&(r.mostRecentlyFocusedNode=t);else{e.stopImmediatePropagation();var l,u=!0;if(r.mostRecentlyFocusedNode)if(D(r.mostRecentlyFocusedNode)>0){var d=g(r.mostRecentlyFocusedNode),f=r.containerGroups[d].tabbableNodes;if(f.length>0){var v=f.findIndex(function(b){return b===r.mostRecentlyFocusedNode});v>=0&&(s.isKeyForward(r.recentNavEvent)?v+1<f.length&&(l=f[v+1],u=!1):v-1>=0&&(l=f[v-1],u=!1))}}else r.containerGroups.some(function(b){return b.tabbableNodes.some(function(w){return D(w)>0})})||(u=!1);else u=!1;u&&(l=S({target:r.mostRecentlyFocusedNode,isBackward:s.isKeyBackward(r.recentNavEvent)})),h(l||r.mostRecentlyFocusedNode||F())}r.recentNavEvent=void 0},_=function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;r.recentNavEvent=e;var a=S({event:e,isBackward:t});a&&(P(e)&&e.preventDefault(),h(a))},q=function(e){(s.isKeyForward(e)||s.isKeyBackward(e))&&_(e,s.isKeyBackward(e))},M=function(e){ue(e)&&G(s.escapeDeactivates,e)!==!1&&(e.preventDefault(),m.deactivate())},U=function(e){var t=R(e);g(t,e)>=0||G(s.clickOutsideDeactivates,e)||G(s.allowOutsideClick,e)||(e.preventDefault(),e.stopImmediatePropagation())},Y=function(){if(r.active)return W.activateTrap(c,m),r.delayInitialFocusTimer=s.delayInitialFocus?X(function(){h(F())}):h(F()),o.addEventListener("focusin",K,!0),o.addEventListener("mousedown",x,{capture:!0,passive:!1}),o.addEventListener("touchstart",x,{capture:!0,passive:!1}),o.addEventListener("click",U,{capture:!0,passive:!1}),o.addEventListener("keydown",q,{capture:!0,passive:!1}),o.addEventListener("keydown",M),m},z=function(){if(r.active)return o.removeEventListener("focusin",K,!0),o.removeEventListener("mousedown",x,!0),o.removeEventListener("touchstart",x,!0),o.removeEventListener("click",U,!0),o.removeEventListener("keydown",q,!0),o.removeEventListener("keydown",M),m},$=function(e){var t=e.some(function(a){var l=Array.from(a.removedNodes);return l.some(function(u){return u===r.mostRecentlyFocusedNode})});t&&h(F())},j=typeof window<"u"&&"MutationObserver"in window?new MutationObserver($):void 0,k=function(){j&&(j.disconnect(),r.active&&!r.paused&&r.containers.map(function(e){j.observe(e,{subtree:!0,childList:!0})}))};return m={get active(){return r.active},get paused(){return r.paused},activate:function(e){if(r.active)return this;var t=p(e,"onActivate"),a=p(e,"onPostActivate"),l=p(e,"checkCanFocusTrap");l||T(),r.active=!0,r.paused=!1,r.nodeFocusedBeforeActivation=o.activeElement,t?.();var u=function(){l&&T(),Y(),k(),a?.()};return l?(l(r.containers.concat()).then(u,u),this):(u(),this)},deactivate:function(e){if(!r.active)return this;var t=V({onDeactivate:s.onDeactivate,onPostDeactivate:s.onPostDeactivate,checkCanReturnFocus:s.checkCanReturnFocus},e);clearTimeout(r.delayInitialFocusTimer),r.delayInitialFocusTimer=void 0,z(),r.active=!1,r.paused=!1,k(),W.deactivateTrap(c,m);var a=p(t,"onDeactivate"),l=p(t,"onPostDeactivate"),u=p(t,"checkCanReturnFocus"),d=p(t,"returnFocus","returnFocusOnDeactivate");a?.();var f=function(){X(function(){d&&h(A(r.nodeFocusedBeforeActivation)),l?.()})};return d&&u?(u(A(r.nodeFocusedBeforeActivation)).then(f,f),this):(f(),this)},pause:function(e){if(r.paused||!r.active)return this;var t=p(e,"onPause"),a=p(e,"onPostPause");return r.paused=!0,t?.(),z(),k(),a?.(),this},unpause:function(e){if(!r.paused||!r.active)return this;var t=p(e,"onUnpause"),a=p(e,"onPostUnpause");return r.paused=!1,t?.(),T(),Y(),k(),a?.(),this},updateContainerElements:function(e){var t=[].concat(e).filter(Boolean);return r.containers=t.map(function(a){return typeof a=="string"?o.querySelector(a):a}),r.active&&T(),k(),this}},m.updateContainerElements(n),m};function ve(n,i){const{el:o}=n,c=o;if(!c)return;const s={clickOutsideDeactivates:!0,escapeDeactivates:!1,fallbackFocus:c,setReturnFocus:r=>(ee(r),!1),...i?.focusTrapOptions,document:o.ownerDocument,tabbableOptions:te,trapStack:oe};n.focusTrap=be(c,s)}function pe(n,i){n.focusTrapDisabled||n.focusTrap?.activate(i)}function me(n,i){n.focusTrap?.deactivate(i)}function ye(n){n.focusTrap?.updateContainerElements(n.el)}export{pe as a,ve as c,me as d,ye as u};
