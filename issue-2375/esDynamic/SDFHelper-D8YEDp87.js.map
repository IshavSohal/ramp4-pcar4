{"version":3,"file":"SDFHelper-D8YEDp87.js","sources":["../../node_modules/@arcgis/core/symbols/cim/SDFHelper.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.30/esri/copyright.txt for details.\n*/\nimport{packFloatRGBA as t}from\"../../core/floatRGBA.js\";import{isExtent as o}from\"../../geometry/support/jsonUtils.js\";import n from\"./Rect.js\";import{defaultSdfTextureSize as r,spritePadding as e}from\"../../views/2d/engine/webgl/definitions.js\";function l(t){switch(t.type){case\"CIMPointSymbol\":{const o=t.symbolLayers;if(!o||1!==o.length)return null;const n=o[0];return\"CIMVectorMarker\"!==n.type?null:l(n)}case\"CIMVectorMarker\":{const o=t.markerGraphics;if(!o||1!==o.length)return null;const n=o[0];if(!n)return null;const r=n.geometry;if(!r)return null;const e=n.symbol;return!e||\"CIMPolygonSymbol\"!==e.type&&\"CIMLineSymbol\"!==e.type||e.symbolLayers?.some((t=>!!t.effects))?null:{type:\"sdf\",geom:r,asFill:\"CIMPolygonSymbol\"===e.type}}}}function i(t){return t?t.rings?t.rings:t.paths?t.paths:void 0!==t.xmin&&void 0!==t.ymin&&void 0!==t.xmax&&void 0!==t.ymax?[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]:null:null}function s(t){let o=1/0,r=-1/0,e=1/0,l=-1/0;for(const n of t)for(const t of n)t[0]<o&&(o=t[0]),t[0]>r&&(r=t[0]),t[1]<e&&(e=t[1]),t[1]>l&&(l=t[1]);return new n(o,e,r-o,l-e)}function f(t){let o=1/0,n=-1/0,r=1/0,e=-1/0;for(const l of t)for(const t of l)t[0]<o&&(o=t[0]),t[0]>n&&(n=t[0]),t[1]<r&&(r=t[1]),t[1]>e&&(e=t[1]);return[o,r,n,e]}function m(t){return t?t.rings?f(t.rings):t.paths?f(t.paths):o(t)?[t.xmin,t.ymin,t.xmax,t.ymax]:null:null}function a(t,o,n,l,i){const[s,f,m,a]=t;if(m<s||a<f)return[0,0,0,1];const c=m-s,u=a-f,y=r,h=e,x=Math.floor(.5*(.5*y-h)),M=(y-2*(x+h))/Math.max(c,u),p=Math.round(c*M)+2*x,g=Math.round(u*M)+2*x;let d=1;if(o){d=g/M/(o.ymax-o.ymin)}let b=0,w=0,C=1;l&&(i?o&&n&&o.ymax-o.ymin>0&&(C=(o.xmax-o.xmin)/(o.ymax-o.ymin),b=l.x/(n*C),w=l.y/n):(b=l.x,w=l.y)),o&&(b=.5*(o.xmax+o.xmin)+b*(o.xmax-o.xmin),w=.5*(o.ymax+o.ymin)+w*(o.ymax-o.ymin)),b-=s,w-=f,b*=M,w*=M,b+=x,w+=x;let I=b/p-.5,j=w/g-.5;return i&&n&&(I*=n*C,j*=n),[d,I,j,C]}function c(t){const o=i(t.geom),n=s(o),l=r,f=e,m=Math.floor(.5*(.5*l-f)),a=(l-2*(m+f))/Math.max(n.width,n.height),c=Math.round(n.width*a)+2*m,x=Math.round(n.height*a)+2*m,M=[];for(const r of o)if(r&&r.length>1){const o=[];for(const e of r){let[r,l]=e;r-=n.x,l-=n.y,r*=a,l*=a,r+=m-.5,l+=m-.5,t.asFill?o.push([r,l]):o.push([Math.round(r),Math.round(l)])}if(t.asFill){const t=o.length-1;o[0][0]===o[t][0]&&o[0][1]===o[t][1]||o.push(o[0])}M.push(o)}const p=u(M,c,x,m);return t.asFill&&y(M,c,x,m,p),[h(p,m),c,x]}function u(t,o,n,r){const e=o*n,l=new Array(e),i=r*r+1;for(let s=0;s<e;++s)l[s]=i;for(const s of t){const t=s.length;for(let e=1;e<t;++e){const t=s[e-1],i=s[e];let f,m,a,c;t[0]<i[0]?(f=t[0],m=i[0]):(f=i[0],m=t[0]),t[1]<i[1]?(a=t[1],c=i[1]):(a=i[1],c=t[1]);let u=Math.floor(f)-r,y=Math.floor(m)+r,h=Math.floor(a)-r,x=Math.floor(c)+r;u<0&&(u=0),y>o&&(y=o),h<0&&(h=0),x>n&&(x=n);const M=i[0]-t[0],p=i[1]-t[1],g=M*M+p*p;for(let r=u;r<y;r++)for(let e=h;e<x;e++){const s=r+.5,f=e+.5;let m,a,c=(s-t[0])*M+(f-t[1])*p;c<0?(m=t[0],a=t[1]):c>g?(m=i[0],a=i[1]):(c/=g,m=t[0]+c*M,a=t[1]+c*p);const u=(s-m)*(s-m)+(f-a)*(f-a),y=(n-e-1)*o+r;u<l[y]&&(l[y]=u)}}}for(let s=0;s<e;++s)l[s]=Math.sqrt(l[s]);return l}function y(t,o,n,r,e){for(const l of t){const t=l.length;for(let i=1;i<t;++i){const t=l[i-1],s=l[i];let f,m,a,c;t[0]<s[0]?(f=t[0],m=s[0]):(f=s[0],m=t[0]),t[1]<s[1]?(a=t[1],c=s[1]):(a=s[1],c=t[1]);let u=Math.floor(f),y=Math.floor(m)+1,h=Math.floor(a),x=Math.floor(c)+1;u<r&&(u=r),y>o-r&&(y=o-r),h<r&&(h=r),x>n-r&&(x=n-r);for(let l=h;l<x;++l){if(t[1]>l==s[1]>l)continue;const i=l+.5,f=(n-l-1)*o;for(let o=u;o<y;++o){o+.5<(s[0]-t[0])*(i-t[1])/(s[1]-t[1])+t[0]&&(e[f+o]=-e[f+o])}for(let t=r;t<u;++t)e[f+t]=-e[f+t]}}}}function h(o,n){const r=2*n,e=o.length,l=new Uint8Array(4*e);for(let i=0;i<e;++i){const n=.5-o[i]/r;t(n,l,4*i)}return l}export{c as buildSDF,m as getExtent,l as getSDFInfo,a as getSDFMetrics};\n"],"names":["l","t","o","n","r","e","i","s","f","m","a","c","u","y","h","M","g","d","b","w","C","I","j","x","p"],"mappings":"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","x_google_ignoreList":[0]}