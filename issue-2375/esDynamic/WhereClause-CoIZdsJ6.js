import{a as q,n as B,m as Ru}from"./TimeOnly-CAgpzQQx.js";import{v as en,iE as R,iG as Uu,iF as qe,m2 as Ye,m3 as ce,b_ as Vu,ac as tn,iH as $u}from"./main-C02UbYD7.js";var d;(function(o){o.InvalidFunctionParameters="InvalidFunctionParameters",o.InvalidValueForAggregateFunction="InvalidValueForAggregateFunction",o.UnsupportedSqlFunction="UnsupportedSqlFunction",o.UnsupportedOperator="UnsupportedOperator",o.UnsupportedSyntax="UnsupportedSyntax",o.UnsupportedIsRhs="UnsupportedIsRhs",o.UnsupportedIsLhs="UnsupportedIsLhs",o.InvalidDataType="InvalidDataType",o.CannotCastValue="CannotCastValue",o.FunctionNotRecognized="FunctionNotRecognized",o.InvalidTime="InvalidTime",o.InvalidParameterCount="InvalidParameterCount",o.InvalidTimeStamp="InvalidTimeStamp",o.InvalidDate="InvalidDate",o.InvalidOperator="InvalidOperator",o.IllegalInterval="IllegalInterval",o.YearMonthIntervals="YearMonthIntervals",o.PrimarySecondaryQualifiers="PrimarySecondaryQualifiers",o.MissingStatisticParameters="MissingStatisticParameters"})(d||(d={}));const Ju={[d.InvalidValueForAggregateFunction]:"Invalid value used in aggregate function",[d.MissingStatisticParameters]:"Statistic does not have 1 or 0 Parameters",[d.InvalidFunctionParameters]:"Invalid parameters for call to {function}",[d.UnsupportedIsLhs]:"Unsupported left hand expression in is statement",[d.UnsupportedIsRhs]:"Unsupported right hand expression in is statement",[d.UnsupportedOperator]:"Unsupported operator - {operator}",[d.UnsupportedSyntax]:"Unsupported syntax - {node}",[d.UnsupportedSqlFunction]:"Sql function not found = {function}",[d.InvalidDataType]:"Invalid sql data type",[d.InvalidDate]:"Invalid date encountered",[d.InvalidOperator]:"Invalid operator encountered",[d.InvalidTime]:"Invalid time encountered",[d.IllegalInterval]:"Illegal interval",[d.FunctionNotRecognized]:"Function not recognized",[d.InvalidTimeStamp]:"Invalid timestamp encountered",[d.InvalidParameterCount]:"Invalid parameter count for call to {name}",[d.PrimarySecondaryQualifiers]:"Primary and Secondary SqlInterval qualifiers not supported",[d.YearMonthIntervals]:"Year-Month Intervals not supported",[d.CannotCastValue]:"Cannot cast value to the required data type"};let h=class On extends Error{constructor(r,i){super(en(Ju[r],i)),this.declaredRootClass="esri.arcade.featureset.support.sqlerror",Error.captureStackTrace&&Error.captureStackTrace(this,On)}};var Q;(function(o){o.NeverReach="NeverReach",o.NotImplemented="NotImplemented",o.Cancelled="Cancelled",o.InvalidStatResponse="InvalidStatResponse",o.InvalidRequest="InvalidRequest",o.RequestFailed="RequestFailed",o.MissingFeatures="MissingFeatures",o.AggregationFieldNotFound="AggregationFieldNotFound",o.DataElementsNotFound="DataElementsNotFound"})(Q||(Q={}));const Zu={[Q.Cancelled]:"Cancelled",[Q.InvalidStatResponse]:"Invalid statistics response from service",[Q.InvalidRequest]:"Invalid request",[Q.RequestFailed]:"Request failed - {reason}",[Q.MissingFeatures]:"Missing features",[Q.AggregationFieldNotFound]:"Aggregation field not found",[Q.DataElementsNotFound]:"Data elements not found on service",[Q.NeverReach]:"Encountered unreachable logic",[Q.NotImplemented]:"Not implemented"};let zu=class bn extends Error{constructor(r,i){super(en(Zu[r],i)),this.declaredRootClass="esri.arcade.featureset.support.featureseterror",Error.captureStackTrace&&Error.captureStackTrace(this,bn)}};function nn(o){return Number.isNaN(o)||o===0?o:Math.trunc(o)}class V{constructor(r){this._timeStampOffset=r,this._date=null}toDateTime(){return this._date??=R.fromISO(this._timeStampOffset,{setZone:!0}),this._date}get isValid(){return this.toDateTime().isValid}get timezoneOffsetHour(){return nn(this.toDateTime().offset/60)}get timezoneOffsetMinutes(){return nn(this.toDateTime().offset%60)}toMilliseconds(){return this.toDateTime().toMillis()}get hour(){return this.toDateTime().hour}get minute(){return this.toDateTime().minute}get second(){return this.toDateTime().second}get day(){return this.toDateTime().day}get month(){return this.toDateTime().month}get year(){return this.toDateTime().year}startOfDay(){return V.fromDateTime(this.toDateTime().startOf("day"))}static fromJSDate(r){return new V(R.fromJSDate(r).toISO({includeOffset:!0}))}static fromDateTime(r){return new V(r.toISO({includeOffset:!0}))}static fromParts(r,i,c=0,l=0,w=0,m=0,t=0,N=!1,O=0,_=0){const Z=`${r.toString().padStart(4,"0")}-${i.toString().padStart(2,"0")}-${c.toString().padStart(2,"0")}`;let z="";m<10&&(z="0");let x=`${l.toString().padStart(2,"0")}:${w.toString().padStart(2,"0")}:${z+m.toString()}`;t!==0&&(x+="."+t.toString().padStart(3,"0"));const C=`${N?"-":"+"}${O.toString().padStart(2,"0")}:${_.toString().padStart(2,"0")}`;return new V(Z+"T"+x+C)}toStorageFormat(){return this._timeStampOffset}toString(){return this._timeStampOffset}toSQLValue(){let r=this.toDateTime().toSQL({includeOffset:!0,includeOffsetSpace:!0});return r&&(r=r.replace(".000","")),r}toSQLWithKeyword(){return`timestamp '${this.toSQLValue()}'`}addMilliseconds(r){const i=this.toDateTime().plus(r);return V.fromDateTime(i)}}function ku(o,r){const i=an[o.toLowerCase()];if(i==null)throw new h(d.FunctionNotRecognized);if(r.length<i.minParams||r.length>i.maxParams)throw new h(d.InvalidParameterCount,{name:o.toUpperCase()});return i.evaluate(r)}function rn(o,r){const i=an[o.toLowerCase()];return i!=null&&r>=i.minParams&&r<=i.maxParams}const an={min:{minParams:1,maxParams:1,evaluate:o=>sn(o[0],"min")},max:{minParams:1,maxParams:1,evaluate:o=>sn(o[0],"max")},avg:{minParams:1,maxParams:1,evaluate:o=>on(o[0])},sum:{minParams:1,maxParams:1,evaluate:o=>Hu(o[0])},stddev:{minParams:1,maxParams:1,evaluate:o=>qu(o[0])},count:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:o[0].length},var:{minParams:1,maxParams:1,evaluate:o=>un(o[0])}};function on(o){if(o===null)return null;let r=0,i=0;for(let c=0;c<o.length;c++){const l=o[c];if(l!==null){if(!je(l))throw new h(d.InvalidValueForAggregateFunction);i++,r+=l}}return i===0?null:r/o.length}function je(o){return typeof o=="number"}function sn(o,r){if(o===null)return null;let i=null,c=null;for(const l of o){let w=l;w=l instanceof q||l instanceof B?l.toNumber():l instanceof R?l.toMillis():l instanceof V?l.toMilliseconds():l,(i===null||r==="max"&&c!==null&&w!==null&&c<=w||r==="min"&&c!==null&&w!==null&&c>=w)&&(i=l,c=w)}return i}function Hu(o){if(o===null)return null;let r=0;for(let i=0;i<o.length;i++){const c=o[i];if(c!==null){if(!je(c))throw new h(d.InvalidValueForAggregateFunction);r+=c}}return r}function qu(o){if(o===null)return null;const r=un(o);return r===null?null:Math.sqrt(r)}function un(o){if(o===null||(o=o.filter(c=>c!==null)).length===0)return null;const r=on(o);if(r===null)return null;let i=0;for(const c of o){if(!je(c))throw new h(d.InvalidValueForAggregateFunction);i+=(r-c)**2}return i/(o.length-1)}class A{constructor(){this.op="+",this.day=0,this.second=0,this.hour=0,this.month=0,this.year=0,this.minute=0,this.millis=0}static _fixDefaults(r){if(r.precision!==null||r.secondary!==null)throw new h(d.PrimarySecondaryQualifiers)}static _parseSecondsComponent(r,i){if(i.includes(".")){const c=i.split(".");r.second=parseFloat(c[0]),r.millis=parseInt(c[1],10)}else r.second=parseFloat(i)}static createFromMilliseconds(r){const i=new A;return i.second=r/1e3,i}static createFromValueAndQualifier(r,i,c){let l=null;const w=new A;if(w.op=c==="-"?"-":"+",i.type==="interval-period"){A._fixDefaults(i);const m=new RegExp("^[0-9]{1,}$");if(i.period==="year"||i.period==="month")throw new h(d.YearMonthIntervals);if(i.period==="second"){if(!/^[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$/.test(r))throw new h(d.IllegalInterval);A._parseSecondsComponent(w,r)}else{if(!m.test(r))throw new h(d.IllegalInterval);w[i.period]=parseFloat(r)}}else{if(A._fixDefaults(i.start),A._fixDefaults(i.end),i.start.period==="year"||i.start.period==="month"||i.end.period==="year"||i.end.period==="month")throw new h(d.YearMonthIntervals);switch(i.start.period){case"day":switch(i.end.period){case"hour":if(l=new RegExp("^[0-9]{1,} [0-9]{1,}$"),!l.test(r))throw new h(d.IllegalInterval);w[i.start.period]=parseFloat(r.split(" ")[0]),w[i.end.period]=parseFloat(r.split(" ")[1]);break;case"minute":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,}$"),!l.test(r))throw new h(d.IllegalInterval);{w[i.start.period]=parseFloat(r.split(" ")[0]);const m=r.split(" ")[1].split(":");w.hour=parseFloat(m[0]),w.minute=parseFloat(m[1])}break;case"second":if(l=new RegExp("^[0-9]{1,} [0-9]{1,2}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(r))throw new h(d.IllegalInterval);{w[i.start.period]=parseFloat(r.split(" ")[0]);const m=r.split(" ")[1].split(":");w.hour=parseFloat(m[0]),w.minute=parseFloat(m[1]),A._parseSecondsComponent(w,m[2])}break;default:throw new h(d.IllegalInterval)}break;case"hour":switch(i.end.period){case"minute":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}$"),!l.test(r))throw new h(d.IllegalInterval);w.hour=parseFloat(r.split(":")[0]),w.minute=parseFloat(r.split(":")[1]);break;case"second":if(l=new RegExp("^[0-9]{1,}:[0-9]{1,2}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(r))throw new h(d.IllegalInterval);{const m=r.split(":");w.hour=parseFloat(m[0]),w.minute=parseFloat(m[1]),A._parseSecondsComponent(w,m[2])}break;default:throw new h(d.IllegalInterval)}break;case"minute":if(i.end.period!=="second")throw new h(d.IllegalInterval);if(l=new RegExp("^[0-9]{1,}:[0-9]{1,}([.]{1}[0-9]{1,}){0,1}$"),!l.test(r))throw new h(d.IllegalInterval);{const m=r.split(":");w.minute=parseFloat(m[0]),A._parseSecondsComponent(w,m[1])}break;default:throw new h(d.IllegalInterval)}}return w}valueInMilliseconds(){return(this.op==="-"?-1:1)*(this.millis+1e3*this.second+60*this.minute*1e3+60*this.hour*60*1e3+24*this.day*60*60*1e3+this.month*(365/12)*24*60*60*1e3+365*this.year*24*60*60*1e3)}}const Yu=/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/,ju=/^(\d{1,2}):(\d{1,2})$/,Bu=/^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/,ln=/^(\d{4})-(\d{1,2})-(\d{1,2})$/,Qu=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$/,Gu=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,Wu=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|-)(\d{1,2}):(\d{1,2})$/,Ku=/^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/;function Oe(o,r){if(r instanceof Uu)return r===qe.instance?R.fromMillis(o.getTime(),{zone:qe.instance}):R.fromJSDate(o,{zone:r});switch(r){case"system":case"local":case null:return R.fromJSDate(o);default:return r?.toLowerCase()==="unknown"?R.fromMillis(o.getTime(),{zone:qe.instance}):R.fromJSDate(o,{zone:r})}}function k(o){return typeof o=="number"}function H(o){return typeof o=="string"||o instanceof String}function te(o){return o instanceof A}function G(o){return o instanceof Date}function M(o){return o instanceof R}function E(o){return o instanceof q}function P(o){return o instanceof B}function F(o){return o instanceof V}function Be(o){let r=Yu.exec(o);if(r!==null){const[,i,c,l]=r,w=B.fromParts(parseInt(i,10),parseInt(c,10),parseInt(l,10),0);if(w!==null)return w;throw new h(d.InvalidTime)}if(r=ju.exec(o),r!==null){const[,i,c]=r,l=B.fromParts(parseInt(i,10),parseInt(c,10),0,0);if(l!==null)return l;throw new h(d.InvalidTime)}if(r=Bu.exec(o),r!==null){const[,i,c,l,w]=r,m=B.fromParts(parseInt(i,10),parseInt(c,10),parseInt(l,10),parseInt(w,10));if(m!==null)return m;throw new h(d.InvalidTime)}throw new h(d.InvalidTime)}function be(o,r,i=!1){let c=Qu.exec(o);if(c!==null){const[,l,w,m,t,N,O,_]=c,Z=R.fromObject({year:parseInt(l,10),month:parseInt(w,10),day:parseInt(m,10),hour:parseInt(t,10),minute:parseInt(N,10),second:parseInt(O,10),millisecond:_?parseInt(_.replace(".",""),10):0},{zone:Ye(r)});if(Z.isValid===!1)throw new h(d.InvalidTimeStamp);return Z}if(c=Gu.exec(o),c!==null){const[,l,w,m,t,N,O,_,Z,z,x]=c,C=V.fromParts(parseInt(l,10),parseInt(w,10),parseInt(m,10),parseInt(t,10),parseInt(N,10),parseInt(O,10),_?parseInt(_.replace(".",""),10):0,Z==="-",parseInt(z,10),parseInt(x,10));if(C.isValid===!1)throw new h(d.InvalidTimeStamp);return C}if(c=Wu.exec(o),c!==null){const[,l,w,m,t,N,O,_,Z]=c,z=V.fromParts(parseInt(l,10),parseInt(w,10),parseInt(m,10),parseInt(t,10),parseInt(N,10),0,0,O==="-",parseInt(_,10),parseInt(Z,10));if(z.isValid===!1)throw new h(d.InvalidTimeStamp);return z}if(c=Ku.exec(o),c!==null){const[,l,w,m,t,N]=c,O=R.fromObject({year:parseInt(l,10),month:parseInt(w,10),day:parseInt(m,10),hour:parseInt(t,10),minute:parseInt(N,10),second:0},{zone:Ye(r)});if(O.isValid===!1)throw new h(d.InvalidTimeStamp);return O}if(c=ln.exec(o),c!==null){const[,l,w,m]=c,t=R.fromObject({year:parseInt(l,10),month:parseInt(w,10),day:parseInt(m,10),hour:0,minute:0,second:0},{zone:Ye(r)});if(t.isValid===!1)throw new h(d.InvalidTimeStamp);return t}throw new h(d.InvalidTimeStamp)}function cn(o,r){const i=ln.exec(o);if(i===null)try{return be(o,r)}catch{throw new h(d.InvalidDate)}const[,c,l,w]=i,m=q.fromParts(parseInt(c,10),parseInt(l,10),parseInt(w,10));if(m===null)throw new h(d.InvalidDate);return m}const Xu=321408e5,el=26784e5,tl=864e5,nl=36e5,rl=6e4;function Qe(o){return!!M(o)||!!F(o)}function Ge(o){return!!M(o)||!!E(o)||!!F(o)||!!P(o)}function xe(o){if(M(o))return o.toMillis();if(E(o))return o.toNumber();if(F(o))return o.toMilliseconds();throw new h(d.InvalidDataType)}function Y(o,r,i,c){if(o==null||r==null)return null;if(k(o)){if(k(r))return W(o,r,i);if(H(r))return al(o,r,i);if(Ge(r))throw new h(d.InvalidOperator);if(E(r))throw new h(d.InvalidOperator)}else if(H(o)){if(k(r))return ol(o,r,i);if(H(r))return sl(o,r,i);if(M(r))throw new h(d.InvalidOperator);if(E(r))throw new h(d.InvalidOperator);if(P(r))throw new h(d.InvalidOperator);if(F(r))throw new h(d.InvalidOperator)}else if(M(o)){if(Qe(r)){if(o instanceof R&&ce(o.zone)){if(r instanceof R&&ce(r.zone)===!1||r instanceof V)return We(o,r,i)}else if(r instanceof R&&ce(r.zone)&&(o instanceof R&&ce(o.zone)===!1||o instanceof V))return We(o,r,i);return W(xe(o),xe(r),i)}if(H(r))throw new h(d.InvalidOperator);if(E(r))return il(o,r,i);if(P(r))throw new h(d.InvalidOperator);if(k(r))throw new h(d.InvalidOperator)}else if(E(o)){if(F(r))return cl(o,r,i);if(M(r))return ll(o,r,i);if(H(r))throw new h(d.InvalidOperator);if(E(r))return W(o.toNumber(),r.toNumber(),i);if(P(r))throw new h(d.InvalidOperator);if(k(r))throw new h(d.InvalidOperator)}else if(P(o)){if(P(r))return W(o.toNumber(),r.toNumber(),i);if(H(r))throw new h(d.InvalidOperator);if(k(r))throw new h(d.InvalidOperator);if(E(r))throw new h(d.InvalidOperator);if(Qe(r))throw new h(d.InvalidOperator)}else if(F(o)){if(Qe(r))return r instanceof R&&ce(r.zone)?We(o,r,i):W(xe(o),xe(r),i);if(H(r))throw new h(d.InvalidOperator);if(E(r))return ul(o,r,i);if(P(r))throw new h(d.InvalidOperator);if(k(r))throw new h(d.InvalidOperator)}switch(i){case"<>":return o!==r;case"=":return o===r;case">":return o>r;case"<":return o<r;case">=":return o>=r;case"<=":return o<=r}}function W(o,r,i){switch(i){case"<>":return o!==r;case"=":return o===r;case">":return o>r;case"<":return o<r;case">=":return o>=r;case"<=":return o<=r}}function al(o,r,i){const c=parseFloat(r);if(!isNaN(c))return W(o,c,i);const l=o.toString();switch(i){case"<>":return l!==r;case"=":return l===r;case">":return l>r;case"<":return l<r;case">=":return l>=r;case"<=":return l<=r}}function ol(o,r,i){const c=parseFloat(o);if(!isNaN(c))return W(c,r,i);const l=r.toString();switch(i){case"<>":return o!==l;case"=":return o===l;case">":return o>l;case"<":return o<l;case">=":return o>=l;case"<=":return o<=l}}function sl(o,r,i){switch(i){case"<>":return o!==r;case"=":return o===r;case">":return o>r;case"<":return o<r;case">=":return o>=r;case"<=":return o<=r}}function il(o,r,i){const c=r.toDateTimeLuxon(o.zone);return W((o=o.startOf("day")).toMillis(),c.toMillis(),i)}function ul(o,r,i){const c=r.toDateTimeLuxon(o.toDateTime().zone);return W((o=o.startOfDay()).toMilliseconds(),c.toMillis(),i)}function ll(o,r,i){const c=o.toDateTimeLuxon(r.zone);return r=r.startOf("day"),W(c.toMillis(),r.toMillis(),i)}function cl(o,r,i){const c=o.toDateTimeLuxon(r.toDateTime().zone);return r=r.startOfDay(),W(c.toMillis(),r.toMilliseconds(),i)}function We(o,r,i){o instanceof V&&(o=o.toDateTime()),r instanceof V&&(r=r.toDateTime());const c=fn(o),l=fn(r);switch(i){case"<>":return c!==l;case"=":return c===l;case">":return c>l;case"<":return c<l;case">=":return c>=l;case"<=":return c<=l}}function fn(o){return o.year*Xu+o.month*el+o.day*tl+o.hour*nl+o.minute*rl+1e3*o.second+o.millisecond}function Ke(o,r,i){const c=pn[o.toLowerCase()];if(c==null)throw new h(d.FunctionNotRecognized);if(r.length<c.minParams||r.length>c.maxParams)throw new h(d.InvalidParameterCount,{name:o.toUpperCase()});return c.evaluate(r,i)}function fl(o,r){const i=pn[o.toLowerCase()];return i!=null&&r>=i.minParams&&r<=i.maxParams}function Ae(o){return typeof o=="string"||o instanceof String}function Xe(o){return!G(o)&&!E(o)&&!M(o)&&!P(o)&&!F(o)}function dn(o){return E(o)||P(o)?o.toString():F(o)?o.toSQLValue():M(o)?o.millisecond===0?o.toFormat("yyyy-LL-dd HH:mm:ss"):o.toSQL({includeOffset:!1}):G(o)?dn(R.fromJSDate(o)):o.toString()}function dl(o){if(G(o))return q.fromDateJS(o);if(M(o))return q.fromParts(o.year,o.month,o.day);if(E(o))return o;if(P(o))throw new h(d.CannotCastValue);if(F(o)&&q.fromParts(o.year,o.month,o.day)===null)throw new h(d.CannotCastValue);if(Ae(o)){const r=q.fromReader(o);if(r!==null&&r.isValid)return r}throw new h(d.CannotCastValue)}function pl(o,r,i){if(G(o))return Oe(o,r);if(M(o))return o;if(E(o))return o.toDateTimeLuxon("unknown");if(P(o))throw new h(d.CannotCastValue);if(F(o))return o;if(Ae(o))return be(o,"unknown",i);throw new h(d.CannotCastValue)}function hl(o){if(G(o))return B.fromDateJS(o);if(M(o))return B.fromDateTime(o);if(E(o))throw new h(d.CannotCastValue);if(P(o))return o;if(F(o))return B.fromSqlTimeStampOffset(o);if(Ae(o))return Be(o);throw new h(d.CannotCastValue)}const pn={extract:{minParams:2,maxParams:2,evaluate:([o,r])=>{if(r==null)return null;if(G(r))switch(o.toUpperCase()){case"SECOND":return r.getSeconds();case"MINUTE":return r.getMinutes();case"HOUR":return r.getHours();case"DAY":return r.getDate();case"MONTH":return r.getMonth()+1;case"YEAR":return r.getFullYear();case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":return 0}else if(M(r))switch(o.toUpperCase()){case"SECOND":return r.second;case"MINUTE":return r.minute;case"HOUR":return r.hour;case"DAY":return r.day;case"MONTH":return r.month;case"YEAR":return r.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new h(d.InvalidFunctionParameters,{function:"EXTRACT"})}else if(E(r))switch(o.toUpperCase()){case"DAY":return r.day;case"MONTH":return r.month;case"YEAR":return r.year;case"TIMEZONE_HOUR":case"TIMEZONE_MINUTE":throw new h(d.InvalidFunctionParameters,{function:"EXTRACT"})}else if(P(r))switch(o.toUpperCase()){case"SECOND":return r.second;case"MINUTE":return r.minute;case"HOUR":return r.hour}else if(F(r))switch(o.toUpperCase()){case"SECOND":return r.second;case"MINUTE":return r.minute;case"HOUR":return r.hour;case"DAY":return r.day;case"MONTH":return r.month;case"YEAR":return r.year;case"TIMEZONE_HOUR":return r.timezoneOffsetHour;case"TIMEZONE_MINUTE":return r.timezoneOffsetMinutes}throw new h(d.InvalidFunctionParameters,{function:"EXTRACT"})}},substring:{minParams:2,maxParams:3,evaluate:o=>{if(o.length===2){const[r,i]=o;return r==null||i==null?null:r.toString().substring(i-1)}if(o.length===3){const[r,i,c]=o;return r==null||i==null||c==null?null:c<=0?"":r.toString().substring(i-1,i+c-1)}}},position:{minParams:2,maxParams:2,evaluate:([o,r])=>o==null||r==null?null:r.indexOf(o)+1},trim:{minParams:2,maxParams:3,evaluate:o=>{const r=o.length===3,i=r?o[1]:" ",c=r?o[2]:o[1];if(i==null||c==null)return null;const l=`(${Vu(i)})`;switch(o[0]){case"BOTH":return c.replaceAll(new RegExp(`^${l}*|${l}*$`,"g"),"");case"LEADING":return c.replaceAll(new RegExp(`^${l}*`,"g"),"");case"TRAILING":return c.replaceAll(new RegExp(`${l}*$`,"g"),"")}throw new h(d.InvalidFunctionParameters,{function:"TRIM"})}},abs:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:Math.abs(o[0])},ceiling:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:Math.ceil(o[0])},floor:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:Math.floor(o[0])},log:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:Math.log(o[0])},log10:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:Math.log(o[0])*Math.LOG10E},sin:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:Math.sin(o[0])},cos:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:Math.cos(o[0])},tan:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:Math.tan(o[0])},asin:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:Math.asin(o[0])},acos:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:Math.acos(o[0])},atan:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:Math.atan(o[0])},sign:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:o[0]>0?1:o[1]<0?-1:0},power:{minParams:2,maxParams:2,evaluate:o=>o[0]==null||o[1]==null?null:o[0]**o[1]},mod:{minParams:2,maxParams:2,evaluate:o=>o[0]==null||o[1]==null?null:o[0]%o[1]},round:{minParams:1,maxParams:2,evaluate:o=>{const r=o[0],i=o.length===2?10**o[1]:1;return r==null?null:Math.round(r*i)/i}},truncate:{minParams:1,maxParams:2,evaluate:o=>o[0]==null?null:o.length===1?parseInt(o[0].toFixed(0),10):parseFloat(o[0].toFixed(o[1]))},char_length:{minParams:1,maxParams:1,evaluate:o=>Ae(o[0])?o[0].length:0},concat:{minParams:1,maxParams:1/0,evaluate:o=>{let r="";for(let i=0;i<o.length;i++){if(o[i]==null)return null;r+=o[i].toString()}return r}},lower:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:o[0].toString().toLowerCase()},upper:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:o[0].toString().toUpperCase()},coalesce:{minParams:1,maxParams:1/0,evaluate:o=>{for(const r of o)if(r!==null)return r;return null}},cosh:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:Math.cosh(o[0])},sinh:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:Math.sinh(o[0])},tanh:{minParams:1,maxParams:1,evaluate:o=>o[0]==null?null:Math.tanh(o[0])},nullif:{minParams:2,maxParams:2,evaluate:(o,r)=>Y(o[0],o[1],"=")?null:o[0]},cast:{minParams:2,maxParams:2,evaluate:(o,r)=>{const i=o[0],c=o[1];if(i===null)return null;switch(c.type){case"integer":{if(!Xe(i))throw new h(d.CannotCastValue);const l=parseInt(i,10);if(isNaN(l))throw new h(d.CannotCastValue);return l}case"smallint":{if(!Xe(i))throw new h(d.CannotCastValue);const l=parseInt(i,10);if(isNaN(l))throw new h(d.CannotCastValue);if(l>32767||l<-32767)throw new h(d.CannotCastValue);return l}case"float":case"real":{if(!Xe(i))throw new h(d.CannotCastValue);const l=parseFloat(i);if(isNaN(l))throw new h(d.CannotCastValue);return l}case"time":return hl(i);case"date":return dl(i);case"timestamp":return pl(i,r,c.withtimezone===!0);case"varchar":{const l=dn(i);if(l.length>c.size)throw new h(d.CannotCastValue);return l}default:throw new h(d.InvalidDataType)}}}};function hn(o,r,i,c){if(o==="||")return Ke("concat",[r,i],c);if(r===null||i===null)return null;if(k(r)){if(k(i))return et(r,i,o);if(te(i))return Nl(r,i,o);if(P(i))return Dl();if(E(i))return Pl();if(F(i))return Fl();if(M(i))return Ml();if(H(i))return Ll(r,i,o);throw new h(d.InvalidOperator)}if(E(r)){if(k(i))return Al(r,i,o);if(te(i))return Sl(r,i,o);if(P(i))return zl();if(E(i))return Zl(r,i,o);if(F(i))return Jl(r,i,o);if(M(i))return $l(r,i,o);if(H(i))return tc();throw new h(d.InvalidOperator)}if(P(r)){if(k(i))return Cl(r,i,o);if(te(i))return Il(r,i,o);if(P(i))return Gl();if(E(i))return Bl();if(F(i))return Ql();if(M(i))return jl();if(H(i))return nc();throw new h(d.InvalidOperator)}if(te(r)){if(k(i))return Tl(r,i,o);if(te(i))return yl(r,i,o);if(P(i))return ml(r,i,o);if(E(i))return wl(r,i,o);if(F(i))return gl(r,i,o);if(M(i))return vl(r,i,o);if(H(i))return Ul();throw new h(d.InvalidOperator)}if(M(r)){if(k(i))return xl(r,i,o);if(te(i))return Ol(r,i,o);if(P(i))return ec();if(E(i))return Kl(r,i,o);if(F(i))return Xl(r,i,o);if(M(i))return Wl(r,i,o);if(H(i))return rc();throw new h(d.InvalidOperator)}if(F(r)){if(k(i))return El(r,i,o);if(te(i))return bl(r,i,o);if(P(i))return kl();if(E(i))return Hl(r,i,o);if(F(i))return Yl(r,i,o);if(M(i))return ql(r,i,o);if(H(i))return ac();throw new h(d.InvalidOperator)}if(H(r)){if(k(i))return _l(r,i,o);if(te(i))return Vl();if(P(i))return oc();if(E(i))return sc();if(F(i))return uc();if(M(i))return ic();if(H(i))return Rl(r,i,o);throw new h(d.InvalidOperator)}throw new h(d.InvalidOperator)}function et(o,r,i){switch(i){case"+":return o+r;case"-":return o-r;case"*":return o*r;case"/":return o/r}throw new h(d.InvalidOperator)}function vl(o,r,i){switch(i){case"+":return r.plus({milliseconds:o.valueInMilliseconds()});case"-":return o.valueInMilliseconds()-r.toMillis()}throw new h(d.InvalidOperator)}function ml(o,r,i){if(i==="+")return r.plus("milliseconds",o.valueInMilliseconds());throw new h(d.InvalidOperator)}function wl(o,r,i){if(i==="+")return r.plus("milliseconds",o.valueInMilliseconds());throw new h(d.InvalidOperator)}function Il(o,r,i){switch(i){case"+":return o.plus("milliseconds",r.valueInMilliseconds());case"-":return o.plus("milliseconds",-1*r.valueInMilliseconds())}throw new h(d.InvalidOperator)}function gl(o,r,i){if(i==="+")return r.addMilliseconds(o.valueInMilliseconds());throw new h(d.InvalidOperator)}function yl(o,r,i){switch(i){case"+":return A.createFromMilliseconds(o.valueInMilliseconds()+r.valueInMilliseconds());case"-":return A.createFromMilliseconds(o.valueInMilliseconds()-r.valueInMilliseconds());case"*":return A.createFromMilliseconds(o.valueInMilliseconds()*r.valueInMilliseconds());case"/":return A.createFromMilliseconds(o.valueInMilliseconds()/r.valueInMilliseconds())}throw new h(d.InvalidOperator)}function Tl(o,r,i){switch(i){case"+":return A.createFromMilliseconds(o.valueInMilliseconds()+r);case"-":return A.createFromMilliseconds(o.valueInMilliseconds()-r);case"*":return A.createFromMilliseconds(o.valueInMilliseconds()*r);case"/":return A.createFromMilliseconds(o.valueInMilliseconds()/r)}throw new h(d.InvalidOperator)}function Nl(o,r,i){switch(i){case"+":return A.createFromMilliseconds(o+r.valueInMilliseconds());case"-":return A.createFromMilliseconds(o-r.valueInMilliseconds());case"*":return A.createFromMilliseconds(o*r.valueInMilliseconds());case"/":return A.createFromMilliseconds(o/r.valueInMilliseconds())}throw new h(d.InvalidOperator)}function Sl(o,r,i){switch(i){case"+":return o.plus("milliseconds",r.valueInMilliseconds());case"-":return o.plus("milliseconds",-1*r.valueInMilliseconds())}throw new h(d.InvalidOperator)}function Ol(o,r,i){switch(i){case"+":return o.plus({milliseconds:r.valueInMilliseconds()});case"-":return o.minus({milliseconds:r.valueInMilliseconds()})}throw new h(d.InvalidOperator)}function bl(o,r,i){switch(i){case"+":return o.addMilliseconds(r.valueInMilliseconds());case"-":return o.addMilliseconds(-1*r.valueInMilliseconds())}throw new h(d.InvalidOperator)}function xl(o,r,i){const c=1e3*r*24*60*60;switch(i){case"+":return o.plus({milliseconds:c});case"-":return o.minus({milliseconds:c})}throw new h(d.InvalidOperator)}function Al(o,r,i){const c=1e3*r*24*60*60;switch(i){case"+":return o.plus("milliseconds",c);case"-":return o.plus("milliseconds",-1*c)}throw new h(d.InvalidOperator)}function Cl(o,r,i){const c=1e3*r*24*60*60;switch(i){case"+":return o.plus("milliseconds",c);case"-":return o.plus("milliseconds",-1*c)}throw new h(d.InvalidOperator)}function Ml(o,r,i){throw new h(d.InvalidOperator)}function El(o,r,i){const c=1e3*r*24*60*60;switch(i){case"+":return o.addMilliseconds(c);case"-":return o.addMilliseconds(-1*c)}throw new h(d.InvalidOperator)}function Fl(o,r,i){throw new h(d.InvalidOperator)}function Dl(o,r,i){throw new h(d.InvalidOperator)}function Pl(o,r,i){throw new h(d.InvalidOperator)}function Ll(o,r,i){const c=parseFloat(r);if(isNaN(c))throw new h(d.InvalidOperator);return et(o,c,i)}function _l(o,r,i){const c=parseFloat(o);if(isNaN(c))throw new h(d.InvalidOperator);return et(c,r,i)}function Rl(o,r,i){if(i==="+")return o+r;throw new h(d.InvalidOperator)}function Ul(o,r,i){throw new h(d.InvalidOperator)}function Vl(o,r,i){throw new h(d.InvalidOperator)}function $l(o,r,i){if(i==="-")return o.toDateTimeLuxon(r.zone).diff(r).as("days");throw new h(d.InvalidOperator)}function Jl(o,r,i){if(i==="-")return o.toDateTimeLuxon(r.toDateTime().zone).diff(r.toDateTime()).as("days");throw new h(d.InvalidOperator)}function Zl(o,r,i){if(i==="-")return o.toDateTimeLuxon("UTC").diff(r.toDateTimeLuxon("UTC")).as("days");throw new h(d.InvalidOperator)}function zl(o,r,i){throw new h(d.InvalidOperator)}function kl(o,r,i){throw new h(d.InvalidOperator)}function Hl(o,r,i){if(i==="-")return o.toDateTime().diff(r.toDateTimeLuxon(o.toDateTime().zone)).as("days");throw new h(d.InvalidOperator)}function ql(o,r,i){if(i==="-")return o.toDateTime().diff(r).as("days");throw new h(d.InvalidOperator)}function Yl(o,r,i){if(i==="-")return o.toDateTime().diff(r.toDateTime()).as("days");throw new h(d.InvalidOperator)}function jl(o,r,i){throw new h(d.InvalidOperator)}function Bl(o,r,i){throw new h(d.InvalidOperator)}function Ql(o,r,i){throw new h(d.InvalidOperator)}function Gl(o,r,i){throw new h(d.InvalidOperator)}function Wl(o,r,i){if(i==="-")return o.diff(r).as("days");throw new h(d.InvalidOperator)}function Kl(o,r,i){if(i==="-")return o.diff(r.toDateTimeLuxon(o.zone)).as("days");throw new h(d.InvalidOperator)}function Xl(o,r,i){if(i==="-")return o.diff(r.toDateTime()).as("days");throw new h(d.InvalidOperator)}function ec(o,r,i){throw new h(d.InvalidOperator)}function tc(o,r,i){throw new h(d.InvalidOperator)}function nc(o,r,i){throw new h(d.InvalidOperator)}function rc(o,r,i){throw new h(d.InvalidOperator)}function ac(o,r,i){throw new h(d.InvalidOperator)}function oc(o,r,i){throw new h(d.InvalidOperator)}function sc(o,r,i){throw new h(d.InvalidOperator)}function ic(o,r,i){throw new h(d.InvalidOperator)}function uc(o,r,i){throw new h(d.InvalidOperator)}var vn,mn,wn={exports:{}};mn=function(){function o(l,w){function m(){this.constructor=l}m.prototype=w.prototype,l.prototype=new m}function r(l,w,m,t){var N=Error.call(this,l);return Object.setPrototypeOf&&Object.setPrototypeOf(N,r.prototype),N.expected=w,N.found=m,N.location=t,N.name="SyntaxError",N}function i(l,w,m){return m=m||" ",l.length>w?l:(w-=l.length,l+(m+=m.repeat(w)).slice(0,w))}function c(l,w){var m,t={},N=(w=w!==void 0?w:{}).grammarSource,O={start:Tt},_=Tt,Z="!",z="=",x=">=",C=">",j="<=",U="<>",An="<",at="!=",Me="+",Ee="-",ot="||",Cn="*",Mn="/",En="@",st="'",it="N'",fe="''",Fn=".",Dn="null",Pn="true",Ln="false",_n="in",Rn="is",Un="like",Vn="escape",$n="not",Jn="and",Zn="or",zn="between",kn="from",Hn="for",qn="substring",Yn="extract",jn="trim",Bn="position",Qn="timestamp",Gn="date",Wn="time",Kn="leading",Xn="trailing",er="both",tr="cast",nr="as",rr="integer",ar="smallint",or="float",sr="real",ir="varchar",ur="to",lr="interval",cr="year",fr="timezone_hour",dr="timezone_minute",pr="month",hr="day",vr="hour",mr="minute",wr="second",Ir="case",gr="end",yr="when",Tr="then",Nr="else",Sr=",",Or="(",br=")",ut="`",xr=/^[A-Za-z_\x80-\uFFFF]/,Ar=/^[A-Za-z0-9_]/,lt=/^[A-Za-z0-9_.\x80-\uFFFF]/,Cr=/^["]/,ct=/^[^']/,Mr=/^[0-9]/,Er=/^[eE]/,Fr=/^[+\-]/,Dr=/^[ \t\n\r]/,ft=/^[^`]/,Pr=y("!",!1),dt=y("=",!1),Lr=y(">=",!1),_r=y(">",!1),Rr=y("<=",!1),Ur=y("<>",!1),Vr=y("<",!1),$r=y("!=",!1),Fe=y("+",!1),De=y("-",!1),Jr=y("||",!1),Zr=y("*",!1),zr=y("/",!1),kr=X([["A","Z"],["a","z"],"_",["\x80","\uFFFF"]],!1,!1),Hr=X([["A","Z"],["a","z"],["0","9"],"_"],!1,!1),pt=X([["A","Z"],["a","z"],["0","9"],"_",".",["\x80","\uFFFF"]],!1,!1),qr=X(['"'],!1,!1),Yr=y("@",!1),ht=y("'",!1),jr=y("N'",!1),vt=y("''",!1),mt=X(["'"],!0,!1),Br=y(".",!1),Qr=X([["0","9"]],!1,!1),Gr=X(["e","E"],!1,!1),Wr=X(["+","-"],!1,!1),Kr=y("NULL",!0),Xr=y("TRUE",!0),ea=y("FALSE",!0),ta=y("IN",!0),na=y("IS",!0),ra=y("LIKE",!0),aa=y("ESCAPE",!0),oa=y("NOT",!0),sa=y("AND",!0),ia=y("OR",!0),ua=y("BETWEEN",!0),la=y("FROM",!0),ca=y("FOR",!0),fa=y("SUBSTRING",!0),da=y("EXTRACT",!0),pa=y("TRIM",!0),ha=y("POSITION",!0),va=y("TIMESTAMP",!0),ma=y("DATE",!0),wa=y("TIME",!0),Ia=y("LEADING",!0),ga=y("TRAILING",!0),ya=y("BOTH",!0),Ta=y("CAST",!0),Na=y("AS",!0),Sa=y("INTEGER",!0),Oa=y("SMALLINT",!0),ba=y("FLOAT",!0),xa=y("REAL",!0),Aa=y("VARCHAR",!0),Ca=y("TO",!0),Ma=y("INTERVAL",!0),Ea=y("YEAR",!0),Fa=y("TIMEZONE_HOUR",!0),Da=y("TIMEZONE_MINUTE",!0),Pa=y("MONTH",!0),La=y("DAY",!0),_a=y("HOUR",!0),Ra=y("MINUTE",!0),Ua=y("SECOND",!0),Va=y("CASE",!0),$a=y("END",!0),Ja=y("WHEN",!0),Za=y("THEN",!0),za=y("ELSE",!0),ka=y(",",!1),Ha=y("(",!1),qa=y(")",!1),Ya=X([" ","	",`
`,"\r"],!1,!1),wt=y("`",!1),It=X(["`"],!0,!1),ja=function(e){return e},Ba=function(e,a){var s={type:"expression-list"},u=Du(e,a);return s.value=u,s},Qa=function(e,a){return le(e,a)},Ga=function(e,a){return le(e,a)},Wa=function(e){return Eu("NOT",e)},Ka=function(e,a){return a==""||a==null||a==null?e:a.type=="arithmetic"?le(e,a.tail):Xt(a.op,e,a.right,a.escape)},Xa=function(e){return{type:"arithmetic",tail:e}},eo=function(e,a){return{op:e+"NOT",right:a}},to=function(e,a){return{op:e,right:a}},no=function(e,a,s){return{op:"NOT"+e,right:{type:"expression-list",value:[a,s]}}},ro=function(e,a,s){return{op:e,right:{type:"expression-list",value:[a,s]}}},ao=function(e){return e[0]+" "+e[2]},oo=function(e){return e[0]+" "+e[2]},so=function(e,a,s){return{op:e,right:a,escape:s.value}},io=function(e,a){return{op:e,right:a,escape:""}},uo=function(e,a){return{op:e,right:a}},lo=function(e){return{op:e,right:{type:"expression-list",value:[]}}},co=function(e,a){return{op:e,right:a}},fo=function(e,a){return le(e,a)},po=function(e,a){return le(e,a)},ho=function(e){return e.paren=!0,e},vo=function(e){return/^CURRENT_DATE$/i.test(e)?{type:"current-time",mode:"date"}:/^CURRENT_TIMESTAMP$/i.test(e)?{type:"current-time",mode:"timestamp"}:{type:"column-reference",table:"",column:e}},mo=function(e){return{type:"column-reference",table:"",column:e,delimited:!0}},wo=function(e){return e},Io=function(e,a){return e+a.join("")},go=function(e,a){return e+a.join("")},yo=function(e){return e},To=function(e){return e.join("")},No=function(){return'"'},So=function(e){return{type:"parameter",value:e[1]}},Oo=function(e,a){return{type:"function",name:"extract",args:{type:"expression-list",value:[{type:"string",value:e},a]}}},bo=function(e,a,s){return{type:"function",name:"substring",args:{type:"expression-list",value:s?[e,a,s[2]]:[e,a]}}},xo=function(e,a){return{type:"function",name:"cast",args:{type:"expression-list",value:[e,a]}}},Ao=function(){return{type:"data-type",value:{type:"integer"}}},Co=function(){return{type:"data-type",value:{type:"smallint"}}},Mo=function(){return{type:"data-type",value:{type:"float"}}},Eo=function(){return{type:"data-type",value:{type:"real"}}},Fo=function(){return{type:"data-type",value:{type:"date"}}},Do=function(){return{type:"data-type",value:{type:"timestamp"}}},Po=function(){return{type:"data-type",value:{type:"time"}}},Lo=function(e){return{type:"data-type",value:{type:"varchar",size:parseInt(e)}}},_o=function(e,a,s){return{type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:e??"BOTH"},a,s]}}},Ro=function(e,a){return{type:"function",name:"trim",args:{type:"expression-list",value:[{type:"string",value:e??"BOTH"},a]}}},Uo=function(e,a){return{type:"function",name:"position",args:{type:"expression-list",value:[e,a]}}},Vo=function(e,a){return{type:"function",name:e,args:a||{type:"expression-list",value:[]}}},$o=function(e){return e.type==="string"&&Pu(e.value),{type:"timestamp",value:e.value}},Jo=function(e){return e.type==="string"&&Lu(e.value),{type:"time",value:e.value}},Zo=function(e,a,s){return{type:"interval",value:a,qualifier:s,op:e}},zo=function(e,a){return{type:"interval",value:e,qualifier:a,op:""}},ko=function(e,a){return{type:"interval-qualifier",start:e,end:a}},Ho=function(e,a){return{type:"interval-period",period:e.value,precision:a,secondary:null}},qo=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},Yo=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},jo=function(e,a){return{type:"interval-period",period:"second",precision:e,secondary:a}},Bo=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}},Qo=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},Go=function(e,a){return{type:"interval-period",period:e.value,precision:a,secondary:null}},Wo=function(e){return{type:"interval-period",period:e.value,precision:null,secondary:null}},Ko=function(e,a){return{type:"interval-period",period:"second",precision:e,secondary:a}},Xo=function(e){return{type:"interval-period",period:"second",precision:e,secondary:null}},es=function(){return{type:"interval-period",period:"second",precision:null,secondary:null}},ts=function(){return{type:"string",value:"day"}},ns=function(){return{type:"string",value:"hour"}},rs=function(){return{type:"string",value:"minute"}},as=function(){return{type:"string",value:"month"}},os=function(){return{type:"string",value:"year"}},ss=function(e){return parseFloat(e)},is=function(e){return parseFloat(e)},us=function(e){return e.type==="string"&&_u(e.value),{type:"date",value:e.value}},ls=function(){return{type:"null",value:null}},cs=function(){return{type:"boolean",value:!0}},fs=function(){return{type:"boolean",value:!1}},gt=function(){return"'"},ds=function(e){return{type:"string",value:e.join("")}},ps=function(e,a){return{type:"case-expression",format:"simple",operand:e,clauses:a,else:null}},hs=function(e,a,s){return{type:"case-expression",format:"simple",operand:e,clauses:a,else:s.value}},vs=function(e){return{type:"case-expression",format:"searched",clauses:e,else:null}},ms=function(e,a){return{type:"case-expression",format:"searched",clauses:e,else:a.value}},ws=function(e,a){return{type:"when-clause",operand:e,value:a}},Is=function(e,a){return{type:"when-clause",operand:e,value:a}},gs=function(e){return{type:"else-clause",value:e}},ys=function(e){return{type:"number",value:e}},Ts=function(e,a,s){return parseFloat(e+a+s)},Ns=function(e,a){return parseFloat(e+a)},Ss=function(e,a){return parseFloat(e+a)},Os=function(e){return parseFloat(e)},bs=function(e,a){return e[0]+a},xs=function(e){return"."+(e??"")},As=function(e,a){return e+a},Cs=function(e){return e.join("")},Ms=function(e,a){return"e"+(a===null?"":a)},Es=function(){return"IN"},Fs=function(){return"IS"},Ds=function(){return"LIKE"},Ps=function(){return"ESCAPE"},Ls=function(){return"NOT"},_s=function(){return"AND"},Rs=function(){return"OR"},Us=function(){return"BETWEEN"},Vs=function(){return"FROM"},$s=function(){return"FOR"},Js=function(){return"SUBSTRING"},Zs=function(){return"EXTRACT"},zs=function(){return"TRIM"},ks=function(){return"POSITION"},Hs=function(){return"TIMESTAMP"},qs=function(){return"DATE"},Ys=function(){return"TIME"},js=function(){return"LEADING"},Bs=function(){return"TRAILING"},Qs=function(){return"BOTH"},Gs=function(){return"CAST"},Ws=function(){return"AS"},Ks=function(){return"INTEGER"},Xs=function(){return"SMALLINT"},ei=function(){return"FLOAT"},ti=function(){return"REAL"},ni=function(){return"VARCHAR"},ri=function(){return"TO"},ai=function(){return"INTERVAL"},oi=function(){return"YEAR"},si=function(){return"TIMEZONE_HOUR"},ii=function(){return"TIMEZONE_MINUTE"},ui=function(){return"MONTH"},li=function(){return"DAY"},ci=function(){return"HOUR"},fi=function(){return"MINUTE"},di=function(){return"SECOND"},pi=function(){return"CASE"},hi=function(){return"END"},vi=function(){return"WHEN"},mi=function(){return"THEN"},wi=function(){return"ELSE"},Ii=function(e){return e},gi=function(e){return e.join("")},n=0,v=0,de=[{line:1,column:1}],K=0,Pe=[],f=0;if("startRule"in w){if(!(w.startRule in O))throw new Error(`Can't start parsing from rule "`+w.startRule+'".');_=O[w.startRule]}function Le(e,a){throw Ti(e,a=a!==void 0?a:_e(v,n))}function y(e,a){return{type:"literal",text:e,ignoreCase:a}}function X(e,a,s){return{type:"class",parts:e,inverted:a,ignoreCase:s}}function yi(){return{type:"end"}}function yt(e){var a,s=de[e];if(s)return s;for(a=e-1;!de[a];)a--;for(s={line:(s=de[a]).line,column:s.column};a<e;)l.charCodeAt(a)===10?(s.line++,s.column=1):s.column++,a++;return de[e]=s,s}function _e(e,a,s){var u=yt(e),g=yt(a);return{source:N,start:{offset:e,line:u.line,column:u.column},end:{offset:a,line:g.line,column:g.column}}}function I(e){n<K||(n>K&&(K=n,Pe=[]),Pe.push(e))}function Ti(e,a){return new r(e,null,null,a)}function Ni(e,a,s){return new r(r.buildMessage(e,a),e,a,s)}function Tt(){var e,a;return e=n,p(),(a=L())!==t?(p(),v=e,e=ja(a)):(n=e,e=t),e}function Nt(){var e,a,s,u,g,S,b,D;if(e=n,(a=L())!==t){for(s=[],u=n,g=p(),(S=Se())!==t?(b=p(),(D=L())!==t?u=g=[g,S,b,D]:(n=u,u=t)):(n=u,u=t);u!==t;)s.push(u),u=n,g=p(),(S=Se())!==t?(b=p(),(D=L())!==t?u=g=[g,S,b,D]:(n=u,u=t)):(n=u,u=t);v=e,e=Ba(a,s)}else n=e,e=t;return e}function L(){var e,a,s,u,g,S,b,D;if(e=n,(a=Re())!==t){for(s=[],u=n,g=p(),(S=Vt())!==t?(b=p(),(D=Re())!==t?u=g=[g,S,b,D]:(n=u,u=t)):(n=u,u=t);u!==t;)s.push(u),u=n,g=p(),(S=Vt())!==t?(b=p(),(D=Re())!==t?u=g=[g,S,b,D]:(n=u,u=t)):(n=u,u=t);v=e,e=Qa(a,s)}else n=e,e=t;return e}function Re(){var e,a,s,u,g,S,b,D;if(e=n,(a=pe())!==t){for(s=[],u=n,g=p(),(S=ye())!==t?(b=p(),(D=pe())!==t?u=g=[g,S,b,D]:(n=u,u=t)):(n=u,u=t);u!==t;)s.push(u),u=n,g=p(),(S=ye())!==t?(b=p(),(D=pe())!==t?u=g=[g,S,b,D]:(n=u,u=t)):(n=u,u=t);v=e,e=Ga(a,s)}else n=e,e=t;return e}function pe(){var e,a,s,u,g;return e=n,(a=ue())===t&&(a=n,l.charCodeAt(n)===33?(s=Z,n++):(s=t,f===0&&I(Pr)),s!==t?(u=n,f++,l.charCodeAt(n)===61?(g=z,n++):(g=t,f===0&&I(dt)),f--,g===t?u=void 0:(n=u,u=t),u!==t?a=s=[s,u]:(n=a,a=t)):(n=a,a=t)),a!==t?(s=p(),(u=pe())!==t?(v=e,e=Wa(u)):(n=e,e=t)):(n=e,e=t),e===t&&(e=Si()),e}function Si(){var e,a,s;return e=n,(a=ee())!==t?(p(),(s=Oi())===t&&(s=null),v=e,e=Ka(a,s)):(n=e,e=t),e}function Oi(){var e;return(e=bi())===t&&(e=Mi())===t&&(e=Ai())===t&&(e=xi())===t&&(e=Ci()),e}function bi(){var e,a,s,u,g,S,b;if(e=n,a=[],s=n,u=p(),(g=St())!==t?(S=p(),(b=ee())!==t?s=u=[u,g,S,b]:(n=s,s=t)):(n=s,s=t),s!==t)for(;s!==t;)a.push(s),s=n,u=p(),(g=St())!==t?(S=p(),(b=ee())!==t?s=u=[u,g,S,b]:(n=s,s=t)):(n=s,s=t);else a=t;return a!==t&&(v=e,a=Xa(a)),e=a}function St(){var e;return l.substr(n,2)===x?(e=x,n+=2):(e=t,f===0&&I(Lr)),e===t&&(l.charCodeAt(n)===62?(e=C,n++):(e=t,f===0&&I(_r)),e===t&&(l.substr(n,2)===j?(e=j,n+=2):(e=t,f===0&&I(Rr)),e===t&&(l.substr(n,2)===U?(e=U,n+=2):(e=t,f===0&&I(Ur)),e===t&&(l.charCodeAt(n)===60?(e=An,n++):(e=t,f===0&&I(Vr)),e===t&&(l.charCodeAt(n)===61?(e=z,n++):(e=t,f===0&&I(dt)),e===t&&(l.substr(n,2)===at?(e=at,n+=2):(e=t,f===0&&I($r)))))))),e}function xi(){var e,a,s,u;return e=n,(a=Rt())!==t?(p(),(s=ue())!==t?(p(),(u=ee())!==t?(v=e,e=eo(a,u)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(a=Rt())!==t?(p(),(s=ee())!==t?(v=e,e=to(a,s)):(n=e,e=t)):(n=e,e=t)),e}function Ai(){var e,a,s,u,g,S;return e=n,(a=ue())!==t?(p(),(s=$t())!==t?(p(),(u=ee())!==t?(p(),(g=ye())!==t?(p(),(S=ee())!==t?(v=e,e=no(s,u,S)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(a=$t())!==t?(p(),(s=ee())!==t?(p(),(u=ye())!==t?(p(),(g=ee())!==t?(v=e,e=ro(a,s,g)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}function Ot(){var e,a,s,u,g;return e=n,a=n,(s=ue())!==t?(u=p(),(g=Ut())!==t?a=s=[s,u,g]:(n=a,a=t)):(n=a,a=t),a!==t&&(v=e,a=ao(a)),(e=a)===t&&(e=Ut()),e}function Ue(){var e,a,s,u,g;return e=n,a=n,(s=ue())!==t?(u=p(),(g=ke())!==t?a=s=[s,u,g]:(n=a,a=t)):(n=a,a=t),a!==t&&(v=e,a=oo(a)),(e=a)===t&&(e=ke()),e}function Ci(){var e,a,s,u;return e=n,(a=Ot())!==t?(p(),(s=ne())!==t?(p(),cu()!==t?(p(),(u=ze())!==t?(v=e,e=so(a,s,u)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(a=Ot())!==t?(p(),(s=ne())!==t?(v=e,e=io(a,s)):(n=e,e=t)):(n=e,e=t)),e}function Mi(){var e,a,s,u;return e=n,(a=Ue())!==t?(p(),(s=$())!==t?(p(),(u=Nt())!==t?(p(),J()!==t?(v=e,e=uo(a,u)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(a=Ue())!==t?(p(),(s=$())!==t?(p(),(u=J())!==t?(v=e,e=lo(a)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(a=Ue())!==t?(p(),(s=Ze())!==t?(v=e,e=co(a,s)):(n=e,e=t)):(n=e,e=t))),e}function ee(){var e,a,s,u,g,S,b,D;if(e=n,(a=Ve())!==t){for(s=[],u=n,g=p(),(S=bt())!==t?(b=p(),(D=Ve())!==t?u=g=[g,S,b,D]:(n=u,u=t)):(n=u,u=t);u!==t;)s.push(u),u=n,g=p(),(S=bt())!==t?(b=p(),(D=Ve())!==t?u=g=[g,S,b,D]:(n=u,u=t)):(n=u,u=t);v=e,e=fo(a,s)}else n=e,e=t;return e}function bt(){var e;return l.charCodeAt(n)===43?(e=Me,n++):(e=t,f===0&&I(Fe)),e===t&&(l.charCodeAt(n)===45?(e=Ee,n++):(e=t,f===0&&I(De)),e===t&&(l.substr(n,2)===ot?(e=ot,n+=2):(e=t,f===0&&I(Jr)))),e}function Ve(){var e,a,s,u,g,S,b,D;if(e=n,(a=$e())!==t){for(s=[],u=n,g=p(),(S=xt())!==t?(b=p(),(D=$e())!==t?u=g=[g,S,b,D]:(n=u,u=t)):(n=u,u=t);u!==t;)s.push(u),u=n,g=p(),(S=xt())!==t?(b=p(),(D=$e())!==t?u=g=[g,S,b,D]:(n=u,u=t)):(n=u,u=t);v=e,e=po(a,s)}else n=e,e=t;return e}function xt(){var e;return l.charCodeAt(n)===42?(e=Cn,n++):(e=t,f===0&&I(Zr)),e===t&&(l.charCodeAt(n)===47?(e=Mn,n++):(e=t,f===0&&I(zr))),e}function $e(){var e,a;return(e=qi())===t&&(e=Ui())===t&&(e=Vi())===t&&(e=Zi())===t&&(e=zi())===t&&(e=$i())===t&&(e=ki())===t&&(e=tu())===t&&(e=Ei())===t&&(e=Ze())===t&&(e=n,$()!==t?(p(),(a=L())!==t?(p(),J()!==t?(v=e,e=ho(a)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}function Ei(){var e,a;return e=n,(a=Fi())!==t&&(v=e,a=vo(a)),(e=a)===t&&(e=n,(a=Pi())!==t&&(v=e,a=mo(a)),e=a),e}function Fi(){var e,a;return e=n,(a=Di())!==t&&(v=e,a=wo(a)),e=a}function Di(){var e,a,s,u;if(e=n,(a=Je())!==t){for(s=[],u=Ct();u!==t;)s.push(u),u=Ct();v=e,e=Io(a,s)}else n=e,e=t;return e}function At(){var e,a,s,u;if(e=n,(a=Je())!==t){for(s=[],u=T();u!==t;)s.push(u),u=T();v=e,e=go(a,s)}else n=e,e=t;return e}function Je(){var e;return xr.test(l.charAt(n))?(e=l.charAt(n),n++):(e=t,f===0&&I(kr)),e}function T(){var e;return Ar.test(l.charAt(n))?(e=l.charAt(n),n++):(e=t,f===0&&I(Hr)),e}function Ct(){var e;return lt.test(l.charAt(n))?(e=l.charAt(n),n++):(e=t,f===0&&I(pt)),e}function Pi(){var e,a;return e=n,he()!==t?(a=Li(),he()!==t?(v=e,e=yo(a)):(n=e,e=t)):(n=e,e=t),e}function Li(){var e,a,s;for(e=n,a=[],s=Mt();s!==t;)a.push(s),s=Mt();return v=e,e=a=To(a)}function Mt(){var e;return(e=Ri())===t&&(e=_i()),e}function _i(){var e;return e=n,he()!==t&&he()!==t?(v=e,e=No()):(n=e,e=t),e}function Ri(){var e;return lt.test(l.charAt(n))?(e=l.charAt(n),n++):(e=t,f===0&&I(pt)),e}function he(){var e;return Cr.test(l.charAt(n))?(e=l.charAt(n),n++):(e=t,f===0&&I(qr)),e}function Ze(){var e,a,s,u;return e=n,a=n,l.charCodeAt(n)===64?(s=En,n++):(s=t,f===0&&I(Yr)),s!==t&&(u=At())!==t?a=s=[s,u]:(n=a,a=t),a!==t&&(v=e,a=So(a)),e=a}function Ui(){var e,a,s;return e=n,pu()!==t?(p(),$()!==t?(p(),(a=Hi())!==t?(p(),He()!==t?(p(),(s=L())!==t?(p(),J()!==t?(v=e,e=Oo(a,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function Vi(){var e,a,s,u,g,S,b;return e=n,du()!==t?(p(),$()!==t?(p(),(a=L())!==t?(p(),He()!==t?(p(),(s=L())!==t?(p(),u=n,(g=fu())!==t?(S=p(),(b=L())!==t?u=g=[g,S,b,p()]:(n=u,u=t)):(n=u,u=t),u===t&&(u=null),(g=J())!==t?(v=e,e=bo(a,s,u)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function $i(){var e,a,s;return e=n,Iu()!==t?(p(),$()!==t?(p(),(a=L())!==t?(p(),gu()!==t?(p(),(s=Ji())!==t?(p(),J()!==t?(v=e,e=xo(a,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function Ji(){var e,a,s;return e=n,(a=yu())!==t&&(v=e,a=Ao()),(e=a)===t&&(e=n,(a=Tu())!==t&&(v=e,a=Co()),(e=a)===t&&(e=n,(a=Nu())!==t&&(v=e,a=Mo()),(e=a)===t&&(e=n,(a=Su())!==t&&(v=e,a=Eo()),(e=a)===t&&(e=n,(a=zt())!==t&&(v=e,a=Fo()),(e=a)===t&&(e=n,(a=Zt())!==t&&(v=e,a=Do()),(e=a)===t&&(e=n,(a=kt())!==t&&(v=e,a=Po()),(e=a)===t&&(e=n,(a=Ou())!==t?(p(),$()!==t?(p(),(s=re())!==t?(p(),J()!==t?(v=e,e=Lo(s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)))))))),e}function Zi(){var e,a,s,u;return e=n,Jt()!==t?(p(),$()!==t?(p(),(a=Et())===t&&(a=null),p(),(s=L())!==t?(p(),He()!==t?(p(),(u=L())!==t?(p(),J()!==t?(v=e,e=_o(a,s,u)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,Jt()!==t?(p(),$()!==t?(p(),(a=Et())===t&&(a=null),p(),(s=L())!==t?(p(),J()!==t?(v=e,e=Ro(a,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}function Et(){var e;return(e=vu())===t&&(e=mu())===t&&(e=wu()),e}function zi(){var e,a,s;return e=n,hu()!==t?(p(),$()!==t?(p(),(a=L())!==t?(p(),ke()!==t?(p(),(s=L())!==t?(p(),J()!==t?(v=e,e=Uo(a,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function ki(){var e,a,s;return e=n,(a=Mu())!==t?(p(),$()!==t?(p(),(s=Nt())===t&&(s=null),p(),J()!==t?(v=e,e=Vo(a,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function Hi(){var e;return(e=qt())===t&&(e=Yt())===t&&(e=jt())===t&&(e=Bt())===t&&(e=Qt())===t&&(e=ae())===t&&(e=xu())===t&&(e=Au()),e}function qi(){var e;return(e=ze())===t&&(e=au())===t&&(e=eu())===t&&(e=Xi())===t&&(e=Ki())===t&&(e=Yi())===t&&(e=Bi())===t&&(e=ji()),e}function Yi(){var e,a;return e=n,Zt()!==t?(p(),(a=ne())!==t?(v=e,e=$o(a)):(n=e,e=t)):(n=e,e=t),e}function ji(){var e,a;return e=n,kt()!==t?(p(),(a=ne())!==t?(v=e,e=Jo(a)):(n=e,e=t)):(n=e,e=t),e}function Bi(){var e,a,s,u;return e=n,Ht()!==t?(p(),l.charCodeAt(n)===45?(a=Ee,n++):(a=t,f===0&&I(De)),a===t&&(l.charCodeAt(n)===43?(a=Me,n++):(a=t,f===0&&I(Fe))),a!==t?(p(),(s=ne())!==t?(p(),(u=Ft())!==t?(v=e,e=Zo(a,s,u)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,Ht()!==t?(p(),(a=ne())!==t?(p(),(s=Ft())!==t?(v=e,e=zo(a,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)),e}function Ft(){var e,a,s;return e=n,(a=Qi())!==t?(p(),bu()!==t?(p(),(s=Gi())!==t?(v=e,e=ko(a,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=Wi()),e}function Qi(){var e,a,s;return e=n,(a=ie())!==t?(p(),$()!==t?(p(),(s=me())!==t?(p(),J()!==t?(v=e,e=Ho(a,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(a=ie())!==t&&(v=e,a=qo(a)),e=a),e}function Gi(){var e,a,s,u;return e=n,(a=ie())!==t&&(v=e,a=Yo(a)),(e=a)===t&&(e=n,(a=ae())!==t?(p(),$()!==t?(p(),(s=me())!==t?(p(),Se()!==t?(p(),(u=ve())!==t?(p(),J()!==t?(v=e,e=jo(s,u)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(a=ae())!==t?(p(),$()!==t?(p(),(s=me())!==t?(p(),J()!==t?(v=e,e=Bo(s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(a=ae())!==t&&(v=e,a=Qo()),e=a))),e}function Wi(){var e,a,s,u;return e=n,(a=ie())!==t?(p(),$()!==t?(p(),(s=ve())!==t?(p(),J()!==t?(v=e,e=Go(a,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(a=ie())!==t&&(v=e,a=Wo(a)),(e=a)===t&&(e=n,(a=ae())!==t?(p(),$()!==t?(p(),(s=me())!==t?(p(),Se()!==t?(p(),(u=ve())!==t?(p(),J()!==t?(v=e,e=Ko(s,u)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(a=ae())!==t?(p(),$()!==t?(p(),(s=ve())!==t?(p(),J()!==t?(v=e,e=Xo(s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e===t&&(e=n,(a=ae())!==t&&(v=e,a=es()),e=a)))),e}function ie(){var e,a;return e=n,(a=jt())!==t&&(v=e,a=ts()),(e=a)===t&&(e=n,(a=Bt())!==t&&(v=e,a=ns()),(e=a)===t&&(e=n,(a=Qt())!==t&&(v=e,a=rs()),(e=a)===t&&(e=n,(a=Yt())!==t&&(v=e,a=as()),(e=a)===t&&(e=n,(a=qt())!==t&&(v=e,a=os()),e=a)))),e}function ve(){var e,a;return e=n,(a=re())!==t&&(v=e,a=ss(a)),e=a}function me(){var e,a;return e=n,(a=re())!==t&&(v=e,a=is(a)),e=a}function Ki(){var e,a;return e=n,zt()!==t?(p(),(a=ne())!==t?(v=e,e=us(a)):(n=e,e=t)):(n=e,e=t),e}function Xi(){var e,a;return e=n,(a=iu())!==t&&(v=e,a=ls()),e=a}function eu(){var e,a;return e=n,(a=uu())!==t&&(v=e,a=cs()),(e=a)===t&&(e=n,(a=lu())!==t&&(v=e,a=fs()),e=a),e}function ne(){var e;return(e=ze())===t&&(e=Ze()),e}function ze(){var e,a,s,u,g;if(e=n,l.charCodeAt(n)===39?(a=st,n++):(a=t,f===0&&I(ht)),a===t&&(l.substr(n,2)===it?(a=it,n+=2):(a=t,f===0&&I(jr))),a!==t){for(s=[],u=n,l.substr(n,2)===fe?(g=fe,n+=2):(g=t,f===0&&I(vt)),g!==t&&(v=u,g=gt()),(u=g)===t&&(ct.test(l.charAt(n))?(u=l.charAt(n),n++):(u=t,f===0&&I(mt)));u!==t;)s.push(u),u=n,l.substr(n,2)===fe?(g=fe,n+=2):(g=t,f===0&&I(vt)),g!==t&&(v=u,g=gt()),(u=g)===t&&(ct.test(l.charAt(n))?(u=l.charAt(n),n++):(u=t,f===0&&I(mt)));l.charCodeAt(n)===39?(u=st,n++):(u=t,f===0&&I(ht)),u!==t?(v=e,e=ds(s)):(n=e,e=t)}else n=e,e=t;return e}function tu(){var e;return(e=nu())===t&&(e=ru()),e}function nu(){var e,a,s,u,g;if(e=n,Te()!==t)if(p(),(a=L())!==t){for(p(),s=[],u=Ie();u!==t;)s.push(u),u=Ie();u=p(),(g=Ne())!==t?(v=e,e=ps(a,s)):(n=e,e=t)}else n=e,e=t;else n=e,e=t;if(e===t)if(e=n,Te()!==t)if(p(),(a=L())!==t){for(p(),s=[],u=Ie();u!==t;)s.push(u),u=Ie();u=p(),(g=Dt())!==t?(p(),Ne()!==t?(v=e,e=hs(a,s,g)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;else n=e,e=t;return e}function ru(){var e,a,s,u;if(e=n,Te()!==t){for(p(),a=[],s=we();s!==t;)a.push(s),s=we();s=p(),(u=Ne())!==t?(v=e,e=vs(a)):(n=e,e=t)}else n=e,e=t;if(e===t)if(e=n,Te()!==t){for(p(),a=[],s=we();s!==t;)a.push(s),s=we();s=p(),(u=Dt())!==t?(p(),Ne()!==t?(v=e,e=ms(a,u)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}function we(){var e,a,s;return e=n,Gt()!==t?(p(),(a=L())!==t?(p(),Wt()!==t?(p(),(s=L())!==t?(v=e,e=ws(a,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function Ie(){var e,a,s;return e=n,Gt()!==t?(p(),(a=L())!==t?(p(),Wt()!==t?(p(),(s=L())!==t?(v=e,e=Is(a,s)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t)):(n=e,e=t),e}function Dt(){var e,a;return e=n,Cu()!==t?(p(),(a=L())!==t?(v=e,e=gs(a)):(n=e,e=t)):(n=e,e=t),e}function au(){var e,a,s,u;return e=n,(a=ou())!==t?(s=n,f++,u=Je(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=ys(a)):(n=e,e=t)):(n=e,e=t),e}function ou(){var e,a,s,u;return e=n,(a=ge())!==t&&(s=Pt())!==t&&(u=Lt())!==t?(v=e,e=Ts(a,s,u)):(n=e,e=t),e===t&&(e=n,(a=ge())!==t&&(s=Pt())!==t?(v=e,e=Ns(a,s)):(n=e,e=t),e===t&&(e=n,(a=ge())!==t&&(s=Lt())!==t?(v=e,e=Ss(a,s)):(n=e,e=t),e===t&&(e=n,(a=ge())!==t&&(v=e,a=Os(a)),e=a))),e}function ge(){var e,a,s;return(e=re())===t&&(e=n,l.charCodeAt(n)===45?(a=Ee,n++):(a=t,f===0&&I(De)),a===t&&(l.charCodeAt(n)===43?(a=Me,n++):(a=t,f===0&&I(Fe))),a!==t&&(s=re())!==t?(v=e,e=bs(a,s)):(n=e,e=t)),e}function Pt(){var e,a,s;return e=n,l.charCodeAt(n)===46?(a=Fn,n++):(a=t,f===0&&I(Br)),a!==t?((s=re())===t&&(s=null),v=e,e=xs(s)):(n=e,e=t),e}function Lt(){var e,a,s;return e=n,(a=su())!==t&&(s=re())!==t?(v=e,e=As(a,s)):(n=e,e=t),e}function re(){var e,a,s;if(e=n,a=[],(s=_t())!==t)for(;s!==t;)a.push(s),s=_t();else a=t;return a!==t&&(v=e,a=Cs(a)),e=a}function _t(){var e;return Mr.test(l.charAt(n))?(e=l.charAt(n),n++):(e=t,f===0&&I(Qr)),e}function su(){var e,a,s;return e=n,Er.test(l.charAt(n))?(a=l.charAt(n),n++):(a=t,f===0&&I(Gr)),a!==t?(Fr.test(l.charAt(n))?(s=l.charAt(n),n++):(s=t,f===0&&I(Wr)),s===t&&(s=null),v=e,e=Ms(a,s)):(n=e,e=t),e}function iu(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===Dn?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(Kr)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?e=a=[a,s]:(n=e,e=t)):(n=e,e=t),e}function uu(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===Pn?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(Xr)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?e=a=[a,s]:(n=e,e=t)):(n=e,e=t),e}function lu(){var e,a,s,u;return e=n,l.substr(n,5).toLowerCase()===Ln?(a=l.substr(n,5),n+=5):(a=t,f===0&&I(ea)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?e=a=[a,s]:(n=e,e=t)):(n=e,e=t),e}function ke(){var e,a,s,u;return e=n,l.substr(n,2).toLowerCase()===_n?(a=l.substr(n,2),n+=2):(a=t,f===0&&I(ta)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Es()):(n=e,e=t)):(n=e,e=t),e}function Rt(){var e,a,s,u;return e=n,l.substr(n,2).toLowerCase()===Rn?(a=l.substr(n,2),n+=2):(a=t,f===0&&I(na)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Fs()):(n=e,e=t)):(n=e,e=t),e}function Ut(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===Un?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(ra)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Ds()):(n=e,e=t)):(n=e,e=t),e}function cu(){var e,a,s,u;return e=n,l.substr(n,6).toLowerCase()===Vn?(a=l.substr(n,6),n+=6):(a=t,f===0&&I(aa)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Ps()):(n=e,e=t)):(n=e,e=t),e}function ue(){var e,a,s,u;return e=n,l.substr(n,3).toLowerCase()===$n?(a=l.substr(n,3),n+=3):(a=t,f===0&&I(oa)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Ls()):(n=e,e=t)):(n=e,e=t),e}function ye(){var e,a,s,u;return e=n,l.substr(n,3).toLowerCase()===Jn?(a=l.substr(n,3),n+=3):(a=t,f===0&&I(sa)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=_s()):(n=e,e=t)):(n=e,e=t),e}function Vt(){var e,a,s,u;return e=n,l.substr(n,2).toLowerCase()===Zn?(a=l.substr(n,2),n+=2):(a=t,f===0&&I(ia)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Rs()):(n=e,e=t)):(n=e,e=t),e}function $t(){var e,a,s,u;return e=n,l.substr(n,7).toLowerCase()===zn?(a=l.substr(n,7),n+=7):(a=t,f===0&&I(ua)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Us()):(n=e,e=t)):(n=e,e=t),e}function He(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===kn?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(la)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Vs()):(n=e,e=t)):(n=e,e=t),e}function fu(){var e,a,s,u;return e=n,l.substr(n,3).toLowerCase()===Hn?(a=l.substr(n,3),n+=3):(a=t,f===0&&I(ca)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=$s()):(n=e,e=t)):(n=e,e=t),e}function du(){var e,a,s,u;return e=n,l.substr(n,9).toLowerCase()===qn?(a=l.substr(n,9),n+=9):(a=t,f===0&&I(fa)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Js()):(n=e,e=t)):(n=e,e=t),e}function pu(){var e,a,s,u;return e=n,l.substr(n,7).toLowerCase()===Yn?(a=l.substr(n,7),n+=7):(a=t,f===0&&I(da)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Zs()):(n=e,e=t)):(n=e,e=t),e}function Jt(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===jn?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(pa)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=zs()):(n=e,e=t)):(n=e,e=t),e}function hu(){var e,a,s,u;return e=n,l.substr(n,8).toLowerCase()===Bn?(a=l.substr(n,8),n+=8):(a=t,f===0&&I(ha)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=ks()):(n=e,e=t)):(n=e,e=t),e}function Zt(){var e,a,s,u;return e=n,l.substr(n,9).toLowerCase()===Qn?(a=l.substr(n,9),n+=9):(a=t,f===0&&I(va)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Hs()):(n=e,e=t)):(n=e,e=t),e}function zt(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===Gn?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(ma)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=qs()):(n=e,e=t)):(n=e,e=t),e}function kt(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===Wn?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(wa)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Ys()):(n=e,e=t)):(n=e,e=t),e}function vu(){var e,a,s,u;return e=n,l.substr(n,7).toLowerCase()===Kn?(a=l.substr(n,7),n+=7):(a=t,f===0&&I(Ia)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=js()):(n=e,e=t)):(n=e,e=t),e}function mu(){var e,a,s,u;return e=n,l.substr(n,8).toLowerCase()===Xn?(a=l.substr(n,8),n+=8):(a=t,f===0&&I(ga)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Bs()):(n=e,e=t)):(n=e,e=t),e}function wu(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===er?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(ya)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Qs()):(n=e,e=t)):(n=e,e=t),e}function Iu(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===tr?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(Ta)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Gs()):(n=e,e=t)):(n=e,e=t),e}function gu(){var e,a,s,u;return e=n,l.substr(n,2).toLowerCase()===nr?(a=l.substr(n,2),n+=2):(a=t,f===0&&I(Na)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Ws()):(n=e,e=t)):(n=e,e=t),e}function yu(){var e,a,s,u;return e=n,l.substr(n,7).toLowerCase()===rr?(a=l.substr(n,7),n+=7):(a=t,f===0&&I(Sa)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Ks()):(n=e,e=t)):(n=e,e=t),e}function Tu(){var e,a,s,u;return e=n,l.substr(n,8).toLowerCase()===ar?(a=l.substr(n,8),n+=8):(a=t,f===0&&I(Oa)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=Xs()):(n=e,e=t)):(n=e,e=t),e}function Nu(){var e,a,s,u;return e=n,l.substr(n,5).toLowerCase()===or?(a=l.substr(n,5),n+=5):(a=t,f===0&&I(ba)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=ei()):(n=e,e=t)):(n=e,e=t),e}function Su(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===sr?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(xa)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=ti()):(n=e,e=t)):(n=e,e=t),e}function Ou(){var e,a,s,u;return e=n,l.substr(n,7).toLowerCase()===ir?(a=l.substr(n,7),n+=7):(a=t,f===0&&I(Aa)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=ni()):(n=e,e=t)):(n=e,e=t),e}function bu(){var e,a,s,u;return e=n,l.substr(n,2).toLowerCase()===ur?(a=l.substr(n,2),n+=2):(a=t,f===0&&I(Ca)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=ri()):(n=e,e=t)):(n=e,e=t),e}function Ht(){var e,a,s,u;return e=n,l.substr(n,8).toLowerCase()===lr?(a=l.substr(n,8),n+=8):(a=t,f===0&&I(Ma)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=ai()):(n=e,e=t)):(n=e,e=t),e}function qt(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===cr?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(Ea)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=oi()):(n=e,e=t)):(n=e,e=t),e}function xu(){var e,a,s,u;return e=n,l.substr(n,13).toLowerCase()===fr?(a=l.substr(n,13),n+=13):(a=t,f===0&&I(Fa)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=si()):(n=e,e=t)):(n=e,e=t),e}function Au(){var e,a,s,u;return e=n,l.substr(n,15).toLowerCase()===dr?(a=l.substr(n,15),n+=15):(a=t,f===0&&I(Da)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=ii()):(n=e,e=t)):(n=e,e=t),e}function Yt(){var e,a,s,u;return e=n,l.substr(n,5).toLowerCase()===pr?(a=l.substr(n,5),n+=5):(a=t,f===0&&I(Pa)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=ui()):(n=e,e=t)):(n=e,e=t),e}function jt(){var e,a,s,u;return e=n,l.substr(n,3).toLowerCase()===hr?(a=l.substr(n,3),n+=3):(a=t,f===0&&I(La)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=li()):(n=e,e=t)):(n=e,e=t),e}function Bt(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===vr?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(_a)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=ci()):(n=e,e=t)):(n=e,e=t),e}function Qt(){var e,a,s,u;return e=n,l.substr(n,6).toLowerCase()===mr?(a=l.substr(n,6),n+=6):(a=t,f===0&&I(Ra)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=fi()):(n=e,e=t)):(n=e,e=t),e}function ae(){var e,a,s,u;return e=n,l.substr(n,6).toLowerCase()===wr?(a=l.substr(n,6),n+=6):(a=t,f===0&&I(Ua)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=di()):(n=e,e=t)):(n=e,e=t),e}function Te(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===Ir?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(Va)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=pi()):(n=e,e=t)):(n=e,e=t),e}function Ne(){var e,a,s,u;return e=n,l.substr(n,3).toLowerCase()===gr?(a=l.substr(n,3),n+=3):(a=t,f===0&&I($a)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=hi()):(n=e,e=t)):(n=e,e=t),e}function Gt(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===yr?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(Ja)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=vi()):(n=e,e=t)):(n=e,e=t),e}function Wt(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===Tr?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(Za)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=mi()):(n=e,e=t)):(n=e,e=t),e}function Cu(){var e,a,s,u;return e=n,l.substr(n,4).toLowerCase()===Nr?(a=l.substr(n,4),n+=4):(a=t,f===0&&I(za)),a!==t?(s=n,f++,u=T(),f--,u===t?s=void 0:(n=s,s=t),s!==t?(v=e,e=wi()):(n=e,e=t)):(n=e,e=t),e}function Se(){var e;return l.charCodeAt(n)===44?(e=Sr,n++):(e=t,f===0&&I(ka)),e}function $(){var e;return l.charCodeAt(n)===40?(e=Or,n++):(e=t,f===0&&I(Ha)),e}function J(){var e;return l.charCodeAt(n)===41?(e=br,n++):(e=t,f===0&&I(qa)),e}function p(){var e,a;for(e=[],a=Kt();a!==t;)e.push(a),a=Kt();return e}function Kt(){var e;return Dr.test(l.charAt(n))?(e=l.charAt(n),n++):(e=t,f===0&&I(Ya)),e}function Mu(){var e,a,s,u;if(e=n,(a=At())!==t&&(v=e,a=Ii(a)),(e=a)===t)if(e=n,l.charCodeAt(n)===96?(a=ut,n++):(a=t,f===0&&I(wt)),a!==t){if(s=[],ft.test(l.charAt(n))?(u=l.charAt(n),n++):(u=t,f===0&&I(It)),u!==t)for(;u!==t;)s.push(u),ft.test(l.charAt(n))?(u=l.charAt(n),n++):(u=t,f===0&&I(It));else s=t;s!==t?(l.charCodeAt(n)===96?(u=ut,n++):(u=t,f===0&&I(wt)),u!==t?(v=e,e=gi(s)):(n=e,e=t)):(n=e,e=t)}else n=e,e=t;return e}function Eu(e,a){return{type:"unary-expression",operator:e,expr:a}}function Xt(e,a,s,u){var g={type:"binary-expression",operator:e,left:a,right:s};return u!==void 0&&(g.escape=u),g}function Fu(e,a){for(var s=[e],u=0;u<a.length;u++)s.push(a[u][3]);return s}function Du(e,a,s){return Fu(e,a)}function le(e,a){for(var s=e,u=0;u<a.length;u++)s=Xt(a[u][1],s,a[u][3]);return s}function Pu(e){/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(e)!==!0&&Le("Timestamp literal is invalid")}function Lu(e){/^(\d{1,2}):(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2})$|^(\d{1,2}):(\d{1,2}):(\d{1,2}).([0-9]+)$/.test(e)!==!0&&Le("Time literal is invalid")}function _u(e){/^(\d{4})-(\d{1,2})-(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2}):(\d{1,2})(\.[0-9]+)?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})?[ ]{0,1}(\+|\-)(\d{1,2}):(\d{1,2})$|^(\d{4})-(\d{1,2})-(\d{1,2}) (\d{1,2}):(\d{1,2})$/.test(e)!==!0&&Le("Date literal is invalid")}if((m=_())!==t&&n===l.length)return m;throw m!==t&&n<l.length&&I(yi()),Ni(Pe,K<l.length?l.charAt(K):null,K<l.length?_e(K,K+1):_e(K,K))}return o(r,Error),r.prototype.format=function(l){var w="Error: "+this.message;if(this.location){var m,t=null;for(m=0;m<l.length;m++)if(l[m].source===this.location.source){t=l[m].text.split(/\r\n|\n|\r/g);break}var N=this.location.start,O=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(N):N,_=this.location.source+":"+O.line+":"+O.column;if(t){var Z=this.location.end,z=i("",O.line.toString().length," "),x=t[N.line-1],C=(N.line===Z.line?Z.column:x.length+1)-N.column||1;w+=`
 --> `+_+`
`+z+` |
`+O.line+" | "+x+`
`+z+" | "+i("",N.column-1," ")+i("",C,"^")}else w+=`
 at `+_}return w},r.buildMessage=function(l,w){var m={literal:function(x){return'"'+N(x.text)+'"'},class:function(x){var C=x.parts.map(function(j){return Array.isArray(j)?O(j[0])+"-"+O(j[1]):O(j)});return"["+(x.inverted?"^":"")+C.join("")+"]"},any:function(){return"any character"},end:function(){return"end of input"},other:function(x){return x.description}};function t(x){return x.charCodeAt(0).toString(16).toUpperCase()}function N(x){return x.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(C){return"\\x0"+t(C)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(C){return"\\x"+t(C)})}function O(x){return x.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(C){return"\\x0"+t(C)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(C){return"\\x"+t(C)})}function _(x){return m[x.type](x)}function Z(x){var C,j,U=x.map(_);if(U.sort(),U.length>0){for(C=1,j=1;C<U.length;C++)U[C-1]!==U[C]&&(U[j]=U[C],j++);U.length=j}switch(U.length){case 1:return U[0];case 2:return U[0]+" or "+U[1];default:return U.slice(0,-1).join(", ")+", or "+U[U.length-1]}}function z(x){return x?'"'+N(x)+'"':"end of input"}return"Expected "+Z(l)+" but "+z(w)+" found."},{SyntaxError:r,parse:c}},(vn=wn).exports&&(vn.exports=mn());var lc=wn.exports;class cc{static parse(r){return lc.parse(r)}}const fc=new Set(["current_timestamp","current_date","current_time"]);class dc{static makeBool(r){return gn(r)}static featureValue(r,i,c,l){return Sn(r,i,c,l)}static equalsNull(r){return r===null}static applyLike(r,i,c){return rt(r,i,c)}static ensureArray(r){return tt(r)}static applyIn(r,i,c){return nt(r,i)}static currentDate(r){return q.fromNow(r)}static makeSqlInterval(r,i,c){return A.createFromValueAndQualifier(r,i,c)}static convertInterval(r){return r instanceof A?r.valueInMilliseconds():r}static currentTimestamp(r){return Oe(new Date,r)}static compare(r,i,c,l){return Y(i,c,r)}static calculate(r,i,c,l){return hn(r,i,c,l)}static evaluateTime(r){return Be(r)}static evaluateTimestamp(r,i,c){return be(r,i,c)}static evaluateDate(r,i){return cn(r,i)}static evaluateFunction(r,i,c){return Ke(r,i,c)}static lookup(r,i){const c=i[r];return c===void 0?null:c}static between(r,i,c){return r==null||i[0]==null||i[1]==null?null:Y(r,i[0],">=")&&Y(r,i[1],"<=")}static notbetween(r,i,c){return r==null||i[0]==null||i[1]==null?null:Y(r,i[0],"<")||Y(r,i[1],">")}static ternaryNot(r){return Ce(r)}static ternaryAnd(r,i){return yn(r,i)}static ternaryOr(r,i){return Tn(r,i)}}let In=class xn{constructor(r,i,c="UTC"){this.fieldsIndex=i,this.timeZone=c,this.parameters={},this._hasDateFunctions=void 0,this.parseTree=cc.parse(r);const{isStandardized:l,isAggregate:w,referencedFieldNames:m}=this._extractExpressionInfo(i);this._referencedFieldNames=m,this.isStandardized=l,this.isAggregate=w}static convertValueToStorageFormat(r,i=null){if(i===null)return G(r)?r.getTime():M(r)?r.toMillis():F(r)?r.toStorageFormat():P(r)?r.toStorageString():E(r)?r.toStorageFormat():r;switch(i){case"date":return G(r)?r.getTime():M(r)?r.toMillis():F(r)?r.toMilliseconds():E(r)?r.toNumber():r;case"date-only":return G(r)?q.fromDateJS(r).toString():F(r)?q.fromSqlTimeStampOffset(r).toString():M(r)?q.fromDateTime(r).toString():r;case"time-only":return G(r)?B.fromDateJS(r).toStorageString():M(r)?B.fromDateTime(r).toStorageString():F(r)?B.fromSqlTimeStampOffset(r).toStorageString():P(r)?r.toStorageString():r;case"timestamp-offset":if(G(r))return V.fromJSDate(r).toStorageFormat();if(M(r))return V.fromDateTime(r).toStorageFormat();if(F(r))return r.toStorageFormat()}return r}static create(r,i,c="UTC"){return new xn(r,i,c)}get fieldNames(){return this._referencedFieldNames}testSet(r,i=se){return!!this._evaluateNode(this.parseTree,null,i,r)}calculateValue(r,i=se){const c=this._evaluateNode(this.parseTree,r,i,null);return c instanceof A?c.valueInMilliseconds()/864e5:c}calculateValueCompiled(r,i=se){return this.parseTree._compiledVersion!=null?this.parseTree._compiledVersion(r,this.parameters,i,this.fieldsIndex,this.timeZone):tn("esri-csp-restrictions")?this.calculateValue(r,i):(this._compileMe(),this.parseTree._compiledVersion(r,this.parameters,i,this.fieldsIndex,this.timeZone))}testFeature(r,i=se){return!!this._evaluateNode(this.parseTree,r,i,null)}testFeatureCompiled(r,i=se){return this.parseTree._compiledVersion!=null?!!this.parseTree._compiledVersion(r,this.parameters,i,this.fieldsIndex,this.timeZone):tn("esri-csp-restrictions")?this.testFeature(r,i):(this._compileMe(),!!this.parseTree._compiledVersion(r,this.parameters,i,this.fieldsIndex,this.timeZone))}get hasDateFunctions(){return this._hasDateFunctions!=null||(this._hasDateFunctions=!1,this._visitAll(this.parseTree,r=>{r.type==="current-time"?this._hasDateFunctions=!0:r.type==="function"&&(this._hasDateFunctions=this._hasDateFunctions||fc.has(r.name.toLowerCase()))})),this._hasDateFunctions}getFunctions(){const r=new Set;return this._visitAll(this.parseTree,i=>{i.type==="function"&&r.add(i.name.toLowerCase())}),Array.from(r)}getExpressions(){const r=new Map;return this._visitAll(this.parseTree,i=>{if(i.type==="function"){const c=i.name.toLowerCase(),l=i.args.value[0];if(l.type==="column-reference"){const w=l.column,m=`${c}-${w}`;r.has(m)||r.set(m,{aggregateType:c,field:w})}}}),[...r.values()]}getVariables(){const r=new Set;return this._visitAll(this.parseTree,i=>{i.type==="parameter"&&r.add(i.value.toLowerCase())}),Array.from(r)}_compileMe(){const r="return this.convertInterval("+this.evaluateNodeToJavaScript(this.parseTree)+")";this.parseTree._compiledVersion=new Function("feature","lookups","attributeAdapter","fieldsIndex","timeZone",r).bind(dc)}_extractExpressionInfo(r){const i=[],c=new Set;let l=!0,w=!1;return this._visitAll(this.parseTree,m=>{switch(m.type){case"column-reference":{const t=r?.get(m.column);let N,O;t?N=O=t.name??"":(O=m.column,N=O.toLowerCase()),c.has(N)||(c.add(N),i.push(O)),m.column=O;break}case"function":{const{name:t,args:N}=m,O=N.value.length;l&&(l=fl(t,O)),w===!1&&(w=rn(t,O));break}}}),{referencedFieldNames:Array.from(i),isStandardized:l,isAggregate:w}}_visitAll(r,i){if(r!=null)switch(i(r),r.type){case"when-clause":this._visitAll(r.operand,i),this._visitAll(r.value,i);break;case"case-expression":for(const c of r.clauses)this._visitAll(c,i);r.format==="simple"&&this._visitAll(r.operand,i),r.else!==null&&this._visitAll(r.else,i);break;case"expression-list":for(const c of r.value)this._visitAll(c,i);break;case"unary-expression":this._visitAll(r.expr,i);break;case"binary-expression":this._visitAll(r.left,i),this._visitAll(r.right,i);break;case"function":this._visitAll(r.args,i)}}evaluateNodeToJavaScript(r){switch(r.type){case"interval":return"this.makeSqlInterval("+this.evaluateNodeToJavaScript(r.value)+", "+JSON.stringify(r.qualifier)+","+JSON.stringify(r.op)+")";case"case-expression":{let i="";if(r.format==="simple"){const c=this.evaluateNodeToJavaScript(r.operand);i="( ";for(let l=0;l<r.clauses.length;l++)i+=" (this.compare('=',"+c+","+this.evaluateNodeToJavaScript(r.clauses[l].operand)+") ? ("+this.evaluateNodeToJavaScript(r.clauses[l].value)+") : ";r.else!==null?i+=this.evaluateNodeToJavaScript(r.else):i+="null",i+=" )"}else{i="( ";for(let c=0;c<r.clauses.length;c++)i+=" this.makeBool("+this.evaluateNodeToJavaScript(r.clauses[c].operand)+")===true ? ("+this.evaluateNodeToJavaScript(r.clauses[c].value)+") : ";r.else!==null?i+=this.evaluateNodeToJavaScript(r.else):i+="null",i+=" )"}return i}case"parameter":return"this.lookup("+JSON.stringify(r.value.toLowerCase())+",lookups)";case"expression-list":{let i="[";for(const c of r.value)i!=="["&&(i+=","),i+=this.evaluateNodeToJavaScript(c);return i+="]",i}case"unary-expression":return"this.ternaryNot("+this.evaluateNodeToJavaScript(r.expr)+")";case"binary-expression":switch(r.operator){case"AND":return"this.ternaryAnd("+this.evaluateNodeToJavaScript(r.left)+","+this.evaluateNodeToJavaScript(r.right)+" )";case"OR":return"this.ternaryOr("+this.evaluateNodeToJavaScript(r.left)+","+this.evaluateNodeToJavaScript(r.right)+" )";case"IS":if(r.right.type!=="null")throw new h(d.UnsupportedIsRhs);return"this.equalsNull("+this.evaluateNodeToJavaScript(r.left)+")";case"ISNOT":if(r.right.type!=="null")throw new h(d.UnsupportedIsRhs);return"(!(this.equalsNull("+this.evaluateNodeToJavaScript(r.left)+")))";case"IN":return"this.applyIn("+this.evaluateNodeToJavaScript(r.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(r.right)+"), timeZone)";case"NOT IN":return"this.ternaryNot(this.applyIn("+this.evaluateNodeToJavaScript(r.left)+",this.ensureArray("+this.evaluateNodeToJavaScript(r.right)+"), timeZone))";case"BETWEEN":return"this.between("+this.evaluateNodeToJavaScript(r.left)+","+this.evaluateNodeToJavaScript(r.right)+", timeZone)";case"NOTBETWEEN":return"this.notbetween("+this.evaluateNodeToJavaScript(r.left)+","+this.evaluateNodeToJavaScript(r.right)+", timeZone)";case"LIKE":return"this.applyLike("+this.evaluateNodeToJavaScript(r.left)+","+this.evaluateNodeToJavaScript(r.right)+","+JSON.stringify(r.escape)+")";case"NOT LIKE":return"this.ternaryNot(this.applyLike("+this.evaluateNodeToJavaScript(r.left)+","+this.evaluateNodeToJavaScript(r.right)+","+JSON.stringify(r.escape)+"))";case"<>":case"<":case">":case">=":case"<=":case"=":return"this.compare("+JSON.stringify(r.operator)+","+this.evaluateNodeToJavaScript(r.left)+","+this.evaluateNodeToJavaScript(r.right)+", timeZone)";case"*":case"-":case"+":case"/":case"||":return"this.calculate("+JSON.stringify(r.operator)+","+this.evaluateNodeToJavaScript(r.left)+","+this.evaluateNodeToJavaScript(r.right)+", timeZone)"}throw new h(d.UnsupportedOperator,{operator:r.operator});case"null":case"boolean":case"string":case"number":return JSON.stringify(r.value);case"time":return"this.evaluateTime("+JSON.stringify(r.value)+")";case"date":return"this.evaluateDate("+JSON.stringify(r.value)+", 'unknown')";case"timestamp":return"this.evaluateTimestamp("+JSON.stringify(r.value)+", 'unknown')";case"current-time":return r.mode==="date"?"this.currentDate(timeZone)":"this.currentTimestamp(timeZone)";case"column-reference":return"this.featureValue(feature,"+JSON.stringify(r.column)+",fieldsIndex,attributeAdapter)";case"function":return"this.evaluateFunction("+JSON.stringify(r.name)+","+this.evaluateNodeToJavaScript(r.args)+", timeZone)"}throw new h(d.UnsupportedSyntax,{node:r.type})}_evaluateNode(r,i,c,l){let w;switch(r.type){case"interval":{const m=this._evaluateNode(r.value,i,c,l);return A.createFromValueAndQualifier(m,r.qualifier,r.op)}case"case-expression":if(r.format==="simple"){const m=this._evaluateNode(r.operand,i,c,l);for(let t=0;t<r.clauses.length;t++)if(Y(m,this._evaluateNode(r.clauses[t].operand,i,c,l),"=",this.timeZone))return this._evaluateNode(r.clauses[t].value,i,c,l);if(r.else!==null)return this._evaluateNode(r.else,i,c,l)}else{for(let m=0;m<r.clauses.length;m++)if(gn(this._evaluateNode(r.clauses[m].operand,i,c,l)))return this._evaluateNode(r.clauses[m].value,i,c,l);if(r.else!==null)return this._evaluateNode(r.else,i,c,l)}return null;case"parameter":return w=this.parameters[r.value.toLowerCase()],G(w)?R.fromJSDate(w):w instanceof Ru?w.toDateTime():w;case"expression-list":{const m=[];for(const t of r.value)m.push(this._evaluateNode(t,i,c,l));return m}case"unary-expression":return Ce(this._evaluateNode(r.expr,i,c,l));case"binary-expression":switch(r.operator){case"AND":return yn(this._evaluateNode(r.left,i,c,l),this._evaluateNode(r.right,i,c,l));case"OR":return Tn(this._evaluateNode(r.left,i,c,l),this._evaluateNode(r.right,i,c,l));case"IS":if(r.right.type!=="null")throw new h(d.UnsupportedIsRhs);return this._evaluateNode(r.left,i,c,l)===null;case"ISNOT":if(r.right.type!=="null")throw new h(d.UnsupportedIsRhs);return this._evaluateNode(r.left,i,c,l)!==null;case"IN":{const m=tt(this._evaluateNode(r.right,i,c,l));return nt(this._evaluateNode(r.left,i,c,l),m,this.timeZone)}case"NOT IN":{const m=tt(this._evaluateNode(r.right,i,c,l));return Ce(nt(this._evaluateNode(r.left,i,c,l),m,this.timeZone))}case"BETWEEN":{const m=this._evaluateNode(r.left,i,c,l),t=this._evaluateNode(r.right,i,c,l);return m==null||t[0]==null||t[1]==null?null:Y(m,t[0],">=",this.timeZone)&&Y(m,t[1],"<=",this.timeZone)}case"NOTBETWEEN":{const m=this._evaluateNode(r.left,i,c,l),t=this._evaluateNode(r.right,i,c,l);return m==null||t[0]==null||t[1]==null?null:Y(m,t[0],"<",this.timeZone)||Y(m,t[1],">",this.timeZone)}case"LIKE":return rt(this._evaluateNode(r.left,i,c,l),this._evaluateNode(r.right,i,c,l),r.escape);case"NOT LIKE":return Ce(rt(this._evaluateNode(r.left,i,c,l),this._evaluateNode(r.right,i,c,l),r.escape));case"<>":case"<":case">":case">=":case"<=":case"=":return Y(this._evaluateNode(r.left,i,c,l),this._evaluateNode(r.right,i,c,l),r.operator,this.timeZone);case"-":case"+":case"*":case"/":case"||":return hn(r.operator,this._evaluateNode(r.left,i,c,l),this._evaluateNode(r.right,i,c,l),this.timeZone)}case"null":case"boolean":case"string":case"number":return r.value;case"date":return r.parsedValue??=cn(r.value,"unknown"),r.parsedValue;case"timestamp":return r.parsedValue??=be(r.value,"unknown"),r.parsedValue;case"time":return Be(r.value);case"current-time":return r.mode==="date"?q.fromNow(this.timeZone):Oe(new Date,this.timeZone);case"column-reference":return Sn(i,r.column,this.fieldsIndex,c);case"data-type":return r.value;case"function":{if(this.isAggregate&&rn(r.name,r.args.value.length)){const t=[];for(const N of r.args?.value||[]){const O=[];for(const _ of l||[])O.push(this._evaluateNode(N,_,c,null));t.push(O)}return ku(r.name,t)}const m=this._evaluateNode(r.args,i,c,l);return Ke(r.name,m,this.timeZone)}}throw new h(d.UnsupportedSyntax,{node:r.type})}};function gn(o){return o===!0}function tt(o){return Array.isArray(o)?o:[o]}function Ce(o){return o!==null?o!==!0:null}function yn(o,r){return o!=null&&r!=null?o===!0&&r===!0:o!==!1&&r!==!1&&null}function Tn(o,r){return o!=null&&r!=null?o===!0||r===!0:o===!0||r===!0||null}function nt(o,r,i){if(o==null)return null;let c=!1;for(const l of r)if(l==null)c=null;else{if(o===l){c=!0;break}if(Ge(o)&&Ge(l)&&(c=Y(o,l,"="),c))break}return c}const Nn="-[]/{}()*+?.\\^$|";var oe;function pc(o,r){const i=r;let c="",l=oe.Normal;for(let w=0;w<o.length;w++){const m=o.charAt(w);switch(l){case oe.Normal:m===i?l=oe.Escaped:Nn.includes(m)?c+="\\"+m:c+=m==="%"?".*":m==="_"?".":m;break;case oe.Escaped:Nn.includes(m)?c+="\\"+m:c+=m,l=oe.Normal}}return new RegExp("^"+c+"$","m")}function rt(o,r,i){return o==null?null:pc(r,i).test(o)}function hc(o){return o&&typeof o.attributes=="object"}function Sn(o,r,i,c){const l=c.getAttribute(o,r),w=i?.get(r);return l==null||w?.type!=="esriFieldTypeDate"&&w?.type!=="date"?l==null||w?.type!=="esriFieldTypeDateOnly"&&w?.type!=="date-only"?l==null||w?.type!=="esriFieldTypeTimeOnly"&&w?.type!=="time-only"?l==null||w?.type!=="esriFieldTypeTimestampOffset"&&w?.type!=="timestamp-offset"?l:new V(l):B.fromReader(l):q.fromReader(l):Oe(new Date(l),i?.getLuxonTimeZone(w.name)??$u.utcInstance)}(function(o){o[o.Normal=0]="Normal",o[o.Escaped=1]="Escaped"})(oe||(oe={}));const se={getAttribute:(o,r)=>(hc(o)?o.attributes:o)[r]},vc=Object.freeze(Object.defineProperty({__proto__:null,WhereClause:In,defaultAttributeAdapter:se},Symbol.toStringTag,{value:"Module"}));export{In as O,vc as W,Q as a,h as n,V as r,zu as s,d as t};
