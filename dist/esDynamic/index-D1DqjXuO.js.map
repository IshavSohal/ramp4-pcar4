{"version":3,"file":"index-D1DqjXuO.js","sources":["../../src/fixtures/export-scalebar/index.ts"],"sourcesContent":["import { fabric } from 'fabric';\r\n\r\nimport { FixtureInstance } from '@/api/internal';\r\nimport type { ExportAPI, ExportSubFixture } from '@/fixtures/export/api/export';\r\nimport type { ExportConfig } from '../export/store';\r\n\r\nclass ExportScalebarFixture extends FixtureInstance implements ExportSubFixture {\r\n    get config(): any {\r\n        const fixtureConfig: ExportConfig | undefined = this.$iApi.fixture.get<ExportAPI>('export').config;\r\n        return fixtureConfig?.mapElements;\r\n    }\r\n\r\n    make(options?: any): Promise<fabric.Object> {\r\n        const sInfo = this.$iApi.geo.map.caption.scaleHelper();\r\n        const fbObjs = [];\r\n\r\n        for (let i = 0; i < 2; i++) {\r\n            // create the fabric objects and group them\r\n            // scalebar layout (follows R2 layout):\r\n            //\r\n            //  <metric scale> km/m\r\n            //  ======================== (scale bar metric)\r\n            //  ============================== (scale bar imperial)\r\n            //  <imperial scale> mi/ft\r\n\r\n            const fbScaleText = new fabric.Text(\r\n                this.$iApi.$i18n.t('export.scaleBar.approx', [\r\n                    `${this.$iApi.$i18n.n(sInfo[i].distance, 'number')}${sInfo[i].units}`\r\n                ]),\r\n                {\r\n                    fontFamily: 'Montserrat, BlinkMacSystemFont, Segoe UI, Helvetica, Arial, sans-serif',\r\n                    fill: '#000',\r\n                    fontSize: 16,\r\n                    top: i * 50,\r\n                    left: 0,\r\n                    originX: 'left',\r\n                    originY: 'top'\r\n                }\r\n            );\r\n            const fbScaleLine = new fabric.Line([0, i === 0 ? 30 : 40, sInfo[i].pixels, i === 0 ? 30 : 40], {\r\n                stroke: 'black',\r\n                strokeWidth: 3\r\n            });\r\n\r\n            fbObjs.push(new fabric.Group([fbScaleLine, fbScaleText]));\r\n        }\r\n        return Promise.resolve(new fabric.Group(fbObjs, options));\r\n    }\r\n}\r\n\r\nexport default ExportScalebarFixture;\r\n"],"names":["ExportScalebarFixture","FixtureInstance","options","sInfo","fbObjs","i","fbScaleText","fabric","fbScaleLine"],"mappings":";;AAMA,MAAMA,UAA8BC,EAA4C;AAAA,EAC5E,IAAI,SAAc;AAEd,WADgD,KAAK,MAAM,QAAQ,IAAe,QAAQ,EAAE,QACtE;AAAA,EAAA;AAAA,EAG1B,KAAKC,GAAuC;AACxC,UAAMC,IAAQ,KAAK,MAAM,IAAI,IAAI,QAAQ,YAAY,GAC/CC,IAAS,CAAC;AAEhB,aAASC,IAAI,GAAGA,IAAI,GAAGA,KAAK;AASlB,YAAAC,IAAc,IAAIC,EAAAA,OAAO;AAAA,QAC3B,KAAK,MAAM,MAAM,EAAE,0BAA0B;AAAA,UACzC,GAAG,KAAK,MAAM,MAAM,EAAEJ,EAAME,CAAC,EAAE,UAAU,QAAQ,CAAC,GAAGF,EAAME,CAAC,EAAE,KAAK;AAAA,QAAA,CACtE;AAAA,QACD;AAAA,UACI,YAAY;AAAA,UACZ,MAAM;AAAA,UACN,UAAU;AAAA,UACV,KAAKA,IAAI;AAAA,UACT,MAAM;AAAA,UACN,SAAS;AAAA,UACT,SAAS;AAAA,QAAA;AAAA,MAEjB,GACMG,IAAc,IAAID,SAAO,KAAK,CAAC,GAAGF,MAAM,IAAI,KAAK,IAAIF,EAAME,CAAC,EAAE,QAAQA,MAAM,IAAI,KAAK,EAAE,GAAG;AAAA,QAC5F,QAAQ;AAAA,QACR,aAAa;AAAA,MAAA,CAChB;AAEM,MAAAD,EAAA,KAAK,IAAIG,EAAO,OAAA,MAAM,CAACC,GAAaF,CAAW,CAAC,CAAC;AAAA,IAAA;AAE5D,WAAO,QAAQ,QAAQ,IAAIC,EAAAA,OAAO,MAAMH,GAAQF,CAAO,CAAC;AAAA,EAAA;AAEhE;"}