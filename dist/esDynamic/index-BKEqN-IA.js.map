{"version":3,"file":"index-BKEqN-IA.js","sources":["../../src/fixtures/details/store/details-state.ts","../../src/fixtures/details/api/details.ts","../../src/fixtures/details/lang/lang.csv?raw","../../src/fixtures/details/index.ts"],"sourcesContent":["import type { PanelWidthObject } from '@/api';\r\n\r\nexport type DetailsItemSet = { [name: string]: DetailsItemInstance };\r\n\r\n/**\r\n * Types of requests for the details panel. Currently, consists of requests\r\n * from the toggle events, such as the grid (details for a single item) and\r\n * requests from a map click (details for all items at a point).\r\n */\r\nexport type DetailsRequestOrigin = 'toggleEvent' | 'identify';\r\n\r\nexport interface DetailsConfig {\r\n    /**\r\n     * The dictionary of default templates indexed by identify result format with value as the template component id.\r\n     */\r\n    templates: { [type: string]: string };\r\n\r\n    /**\r\n     * The width of the details panel in pixels.\r\n     *\r\n     * @type {number}\r\n     * @interface GridConfig\r\n     */\r\n    panelWidth: PanelWidthObject | number;\r\n}\r\n\r\nexport interface DetailsFieldItem {\r\n    /**\r\n     * Unique identifier for the field. Aligns with the layer field name.\r\n     */\r\n    field: string;\r\n\r\n    /**\r\n     * Specifies the field title.\r\n     */\r\n    alias?: string;\r\n\r\n    /**\r\n     * Whether this field is displayed.\r\n     */\r\n    visible?: boolean;\r\n}\r\n\r\nexport interface DetailsConfigItem {\r\n    /**\r\n     * The layer ID that we want to bind the custom template to.\r\n     *\r\n     * @type {string}\r\n     * @memberof DetailsConfigItem\r\n     */\r\n    id: string;\r\n\r\n    /**\r\n     * The optional display name of the layer.\r\n     *\r\n     * @type {string}\r\n     * @memberof DetailsConfigItem\r\n     */\r\n    name: string;\r\n\r\n    /**\r\n     * The component that we would like to use as a template.\r\n     *\r\n     * @type {string}\r\n     * @memberof DetailsConfigItem\r\n     */\r\n    template: string;\r\n\r\n    /**\r\n     * An array to specify how the layer data fields are defined.\r\n     *\r\n     * @type {array}\r\n     * @memberof DetailsConfigItem\r\n     */\r\n    fields?: DetailsFieldItem[];\r\n\r\n    /**\r\n     * Specifies result priority for auto-open. Lower number is higher priority.\r\n     *\r\n     * @type {number}\r\n     * @memberof DetailsConfigItem\r\n     */\r\n    priority: number;\r\n}\r\n\r\nexport class DetailsItemInstance implements DetailsConfigItem {\r\n    id: string;\r\n\r\n    name: string;\r\n\r\n    template: string;\r\n\r\n    priority: number;\r\n\r\n    fields?: DetailsFieldItem[];\r\n\r\n    componentId?: string;\r\n\r\n    constructor(value: string | DetailsConfigItem) {\r\n        const params = {\r\n            ...(typeof value === 'string' ? { id: value, template: '', name: '', priority: 50 } : value)\r\n        };\r\n        ({\r\n            template: this.template,\r\n            id: this.id,\r\n            name: this.name,\r\n            fields: this.fields,\r\n            priority: this.priority\r\n        } = params);\r\n    }\r\n}\r\n","import { FixtureInstance, LayerInstance, ReactiveIdentifyFactory } from '@/api';\r\nimport type { IdentifyItem, IdentifyResult } from '@/api';\r\nimport type { Graphic, IdentifyResultFormat } from '@/geo/api';\r\nimport { DetailsItemInstance, useDetailsStore } from '../store';\r\n\r\nimport type { DetailsConfig, DetailsConfigItem, DetailsItemSet } from '../store';\r\n\r\nimport type { HilightAPI } from '../../hilight/api/hilight';\r\nimport { HilightMode } from '../../hilight/api/hilight-defs';\r\n\r\nexport const ORIGIN_DETAILS = 'details';\r\n\r\nexport class DetailsAPI extends FixtureInstance {\r\n    private detailsStore = useDetailsStore(this.$vApp.$pinia);\r\n\r\n    get config(): DetailsConfig | undefined {\r\n        return super.config;\r\n    }\r\n\r\n    /**\r\n     * Updates the identify result in the store, and then opens the details panel.\r\n     *\r\n     * @param {IdentifyResult[]} payload\r\n     * @memberof DetailsAPI\r\n     */\r\n    openDetails(payload: IdentifyResult[]): void {\r\n        // Check to see if each layer has a fixture config in the store.\r\n        // This needs to happen prior to setting the payload, as the watcher\r\n        // on the payload property will require this information in the store.\r\n        payload.forEach(p => {\r\n            this._loadDetailsConfig(this.$iApi.geo.layer.getLayer(p.uid));\r\n        });\r\n\r\n        // Save the provided identify result in the store.\r\n        this.detailsStore.payload = payload;\r\n\r\n        const panel = this.$iApi.panel.get('details');\r\n        // Indicate this request for the details panel comes from clicking on the map\r\n        this.detailsStore.origin = 'identify';\r\n        panel.button.tooltip = 'details.layers.title.identifyOrigin';\r\n\r\n        // Open the details panel.\r\n        const detailsPanel = this.$iApi.panel.get('details');\r\n        if (!detailsPanel.isOpen) {\r\n            this.$iApi.panel.open({\r\n                id: 'details'\r\n            });\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Provided with the data for a single feature, shows or hides details panel.\r\n     * If panel is closed or incoming data is different than current content, panel is shown.\r\n     * If panel open and incoming data is what is currently shown, panel closes.\r\n     * The `open` parameter can override the behavior.\r\n     * featureData payload (can be empty if forcing closed)\r\n     * - uid     : uid string of the layer hosting the feature\r\n     * - format  : structure of the data. IdentifyResultFormat value.\r\n     * - data    : source information for the feature. Analogous to the data property of an IdentifyItem\r\n     * - layerId : optional layerId string of the layer hosting the feature. Will be looked up if not provided\r\n     *\r\n     * @param {{data: any, uid: string, format: IdentifyResultFormat}} featureData\r\n     * @param {boolean | undefined} open can force the panel to open (true) or close (false) regardless of current panel state\r\n     * @memberof DetailsAPI\r\n     */\r\n    toggleFeature(\r\n        featureData: {\r\n            data: any;\r\n            uid: string;\r\n            layerId?: string;\r\n            format: IdentifyResultFormat;\r\n        },\r\n        open: boolean | undefined\r\n    ): void {\r\n        const panel = this.$iApi.panel.get('details');\r\n\r\n        if (open === false) {\r\n            // close panel and run away. allows a close without providing featureData\r\n            panel.close();\r\n            this.detailsStore.currentFeatureId = undefined;\r\n            return;\r\n        }\r\n\r\n        // feature ids are composed of the layer uid and feature object id\r\n        const layer: LayerInstance | undefined = this.$iApi.geo.layer.getLayer(featureData.uid);\r\n        const currFeatureId = `${featureData.uid}-${\r\n            // see https://github.com/ramp4-pcar4/ramp4-pcar4/issues/1767 for the reasoning behind this\r\n            layer?.supportsFeatures ? featureData.data[layer?.oidField ?? ''] : JSON.stringify(featureData.data)\r\n        }`;\r\n\r\n        if (panel.isOpen && currFeatureId === this.detailsStore.currentFeatureId && !(open === true)) {\r\n            // panel is open, same request was fired at it, and not a force-open. Close it.\r\n            panel.close();\r\n            this.detailsStore.currentFeatureId = undefined;\r\n            return;\r\n        }\r\n\r\n        // at this point, we are showing the payload\r\n\r\n        // Indicate this request for the details panel comes from a grid item\r\n        this.detailsStore.origin = 'toggleEvent';\r\n\r\n        panel.button.tooltip = 'details.layers.title.gridOrigin';\r\n\r\n        this.detailsStore.currentFeatureId = currFeatureId;\r\n\r\n        // Check to see if the layer has a fixture config in the store.\r\n        this._loadDetailsConfig(layer);\r\n\r\n        const fakeResult: IdentifyResult = {\r\n            items: [ReactiveIdentifyFactory.makeRawItem(featureData.format, featureData.data)],\r\n            uid: featureData.uid,\r\n            layerId: featureData.layerId || layer?.id || 'error-not-found',\r\n            loading: Promise.resolve(),\r\n            loaded: true,\r\n            errored: false,\r\n            requestTime: Date.now()\r\n        };\r\n\r\n        this.detailsStore.payload = [fakeResult];\r\n\r\n        if (!panel.isOpen) {\r\n            panel.open();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Read the details section of the layers' fixture config\r\n     *\r\n     * @param {DetailsConfig} [config]\r\n     * @memberof DetailsAPI\r\n     */\r\n    _parseConfig(config?: DetailsConfig) {\r\n        // set the default templates if provided\r\n        if (config && config.templates) {\r\n            this.detailsStore.defaultTemplates = config.templates;\r\n        }\r\n\r\n        this.handlePanelWidths(['details']);\r\n        this.handlePanelTeleports(['details']);\r\n\r\n        // get all layer fixture configs\r\n        const layerDetailsConfigs: any = this.getLayerFixtureConfigs();\r\n        const detailsConfigItems: DetailsConfigItem[] = [];\r\n\r\n        // construct the details config from the layer fixture configs\r\n        Object.keys(layerDetailsConfigs).forEach((layerId: string) => {\r\n            detailsConfigItems.push({\r\n                id: layerId,\r\n                name: layerDetailsConfigs[layerId].name,\r\n                template: layerDetailsConfigs[layerId].template,\r\n                fields: layerDetailsConfigs[layerId].fields,\r\n                priority: layerDetailsConfigs[layerId].priority ?? 50\r\n            });\r\n        });\r\n\r\n        const detailsItems = detailsConfigItems.map((item: any) => new DetailsItemInstance(item));\r\n\r\n        // save the items in the store\r\n        this.detailsStore.properties = detailsItems.reduce<DetailsItemSet>((map, item) => {\r\n            map[item.id] = item;\r\n            return map;\r\n        }, {});\r\n\r\n        this._validateItems();\r\n    }\r\n\r\n    /**\r\n     * Will see if we have this layer's detail fixture config cached, and if not,\r\n     * cache it.\r\n     *\r\n     * @param layer the layer to check\r\n     * @private\r\n     */\r\n    _loadDetailsConfig(layer: LayerInstance | undefined) {\r\n        // Check to see if the layer has a fixture config in the store.\r\n        if (layer) {\r\n            // Check to see if we've already saved this layer's details config.\r\n            const detailsItem = this.detailsStore.properties[layer.id];\r\n\r\n            // If we haven't and the layer has a details config set, add it to the details store.\r\n            if (detailsItem === undefined) {\r\n                // Dev note: this is pretty inefficient, as getLayerFixtureConfigs() processes every layer.\r\n                //           but it also abstracts some ugly code with lots of `any` types. Since we're\r\n                //           caching we can live with it. Noting for future potential code cleanup.\r\n                const layerDetailsConfigs: any = this.getLayerFixtureConfigs();\r\n\r\n                const thisLayerConfig = layerDetailsConfigs[layer.id];\r\n\r\n                if (thisLayerConfig) {\r\n                    this.detailsStore.addConfigProperty({\r\n                        id: layer.id,\r\n                        name: thisLayerConfig.name,\r\n                        template: thisLayerConfig.template,\r\n                        fields: thisLayerConfig.fields,\r\n                        priority: thisLayerConfig.priority ?? 50\r\n                    });\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Check to see if the stored components are registered properly.\r\n     *\r\n     * @memberof DetailsAPI\r\n     */\r\n    _validateItems() {\r\n        Object.values<DetailsConfigItem>(this.detailsStore.properties).forEach(item => {\r\n            if (item.template in this.$vApp.$options.components!) {\r\n                this.detailsStore.properties[item.id].componentId = item.template;\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * Highlight identified items\r\n     * @param items items to add\r\n     * @param layerUid uid of layer the items belong to\r\n     */\r\n    async hilightDetailsItems(items: IdentifyItem | Array<IdentifyItem>, layerUid: string) {\r\n        // hilight all provided identify items for this layer\r\n        const hItems = items instanceof Array ? items : [items];\r\n        const hilightFix: HilightAPI = this.$iApi.fixture.get('hilight');\r\n        if (hilightFix) {\r\n            const gsByKey = await hilightFix.getGraphicsByKey(ORIGIN_DETAILS);\r\n            await hilightFix.removeHilight(gsByKey);\r\n\r\n            // calculate after the above removeHilight call, since it also does a timestamp.\r\n            // NOTE if the two calls are too fast (same time) then we can add optional param to\r\n            //      not stamp when removing, or pass in this stamp.\r\n            // mark and save this highlight session\r\n            const thisHighlight = Date.now();\r\n            this.detailsStore.lastHilight = thisHighlight;\r\n\r\n            const graphics: Array<Graphic> = await this.getHilightGraphics(hItems, layerUid);\r\n\r\n            if (this.detailsStore.lastHilight === thisHighlight) {\r\n                // our request on this thread is still the most recent one. begin to add graphics to highlighter\r\n                await hilightFix.addHilight(graphics);\r\n\r\n                // while unlikely, given everything is async its possible that a delete request completes before\r\n                // the graphics could be added to the hilight layer.\r\n                // so check one again. If we're now stale, remove the hilight.\r\n                if (this.detailsStore.lastHilight !== thisHighlight) {\r\n                    // hilight removal will gracefully exit if something else already deleted any of these graphics.\r\n                    hilightFix.removeHilight(graphics);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Remove all details panel map hilights.\r\n     */\r\n    async removeDetailsHilight() {\r\n        const hilightFix: HilightAPI = this.$iApi.fixture.get('hilight');\r\n        if (hilightFix) {\r\n            // mark that we are removing. any in-progress highlights will\r\n            // see this new timestamp and know they are stale once finished.\r\n            this.detailsStore.lastHilight = Date.now();\r\n            const gsByKey = await hilightFix.getGraphicsByKey(ORIGIN_DETAILS);\r\n            await hilightFix.removeHilight(gsByKey);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Reload map elements of the hilighter for a set of identify items.\r\n     *\r\n     * @param {IdentifyItem | Array<IdentifyItem>} items items to reload\r\n     * @param {string} layerUid uid of layer the items belong to\r\n     */\r\n    async reloadDetailsHilight(items: IdentifyItem | Array<IdentifyItem>, layerUid: string) {\r\n        // DEV NOTE: this call is not being used anymore. But since part of public API, remains\r\n        //           for respectful compatibility\r\n\r\n        // TODO this method doesn't use the lastHilight flag, so in theory if a stale\r\n        //      batch of identify items is passed, they will end up drawing.\r\n        //      Might be easier to depreciate this method? Breaks API but\r\n        //      the method is really just a shortcut to remove + add, without the\r\n        //      smarter code of those methods.\r\n        //      Alternate, replace all the guts with\r\n        //        await removeDetailsHilight\r\n        //        await hilightDetailsItems(items, layerUid)\r\n        //      but that technically changes the method behavior\r\n\r\n        // hilight all provided identify items for this layer\r\n        const hItems = items instanceof Array ? items : [items];\r\n        const hilightFix: HilightAPI = this.$iApi.fixture.get('hilight');\r\n        if (hilightFix) {\r\n            const graphics: Array<Graphic> = await this.getHilightGraphics(hItems, layerUid);\r\n            hilightFix.reloadHilight(graphics);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Return the graphics of the given IdentifyItems once the items have loaded.\r\n     * @param {Array<IdentifyItem>} items identify items to hilight. Items should be of ESRI format\r\n     * @param layerUid uid of layer the items belong to\r\n     * @returns {Promise<Array<Graphic>>} resolves with array of graphics\r\n     */\r\n    async getHilightGraphics(items: Array<IdentifyItem>, layerUid: string): Promise<Array<Graphic>> {\r\n        const layer: LayerInstance = this.$iApi.geo.layer.getLayer(layerUid)!;\r\n        const hilightFix: HilightAPI = this.$iApi.fixture.get('hilight');\r\n        const gs: Array<Graphic> = [];\r\n        if (layer) {\r\n            // get all the identified Graphics\r\n            await Promise.all(\r\n                items.map(async item => {\r\n                    // ensure item finishes loading\r\n                    await item.loading;\r\n\r\n                    const oid = item.data[layer.oidField];\r\n                    const g = await layer.getGraphic(oid, {\r\n                        getGeom: true,\r\n                        getAttribs: true,\r\n                        getStyle: true\r\n                    });\r\n                    g.id = hilightFix.constructGraphicKey(ORIGIN_DETAILS, layerUid, oid);\r\n                    gs.push(g);\r\n                })\r\n            );\r\n        }\r\n        return gs;\r\n    }\r\n\r\n    /**\r\n     * Updates hilighted graphics when the hilight toggler is toggled.\r\n     *\r\n     * @param {boolean} hilightOn Whether the toggler has been turned on/off\r\n     * @param {IdentifyItem | Array<IdentifyItem>} items The identify items to highlight. Only required if turning on\r\n     * @param {string} layerUid the layer UID that owns the items. Only required if turning on\r\n     */\r\n    onHilightToggle(hilightOn: boolean, items?: IdentifyItem | Array<IdentifyItem>, layerUid?: string) {\r\n        // DEV NOTE: this call is not being used anymore. But since part of public API, remains\r\n        //           for respectful compatibility\r\n\r\n        this.detailsStore.hilightToggle = hilightOn;\r\n\r\n        if (hilightOn && items && layerUid) {\r\n            // hilight got turned on, and valid params provided\r\n            this.hilightDetailsItems(items, layerUid);\r\n        } else if (!hilightOn) {\r\n            // hilight got turned off\r\n            this.removeDetailsHilight();\r\n        }\r\n    }\r\n\r\n    /**\r\n     * Return whether or not a HilightMode has been defined (other than NONE)\r\n     */\r\n    hasHilighter(): boolean {\r\n        const hilightFix: HilightAPI = this.$iApi.fixture.get('hilight');\r\n        return hilightFix && hilightFix.hilightMode.mode !== HilightMode.NONE;\r\n    }\r\n}\r\n","export default \"key,enValue,enValid,frValue,frValid\\r\\ndetails.layers.title.identifyOrigin,Identify Details,1,Identifier les détails,0\\r\\ndetails.layers.title.gridOrigin,Details,1,Détails,1\\r\\ndetails.layers.found,Found {numResults} results in {numLayers} layers,1,{numResults} résultats trouvés dans {numLayers} couches,1\\r\\ndetails.layers.loading,The layer is loading...,1,La couche est en cours de chargement...,1\\r\\ndetails.layers.error,Error,1,Erreur,1\\r\\ndetails.layers.results.empty,No results found for any layer.,1,Aucun résultat trouvé pour aucune couche.,0\\r\\ndetails.layers.results.empty.currentLayer,No results found for the selected layer.,1,Aucun résultat trouvé pour la couche sélectionnée.,1\\r\\ndetails.layers.results.empty.noLayers,No layers for identification.,1,Pas de couches pour l'identification.,0\\r\\ndetails.layers.results.list.tooltip,Use the arrow keys to navigate the items,1,Utilisez les touches fléchées pour naviguer entre les éléments,0\\r\\ndetails.result.default.name,Identify Item {0},1,Désigner l'élément {0},1\\r\\ndetails.loading,Loading...,1,Chargement en cours...,1\\r\\ndetails.items.title,Details,1,Détails,1\\r\\ndetails.items.range,{0} - {1} of {2},1,{0} - {1} de {2},0\\r\\ndetails.items.next,Next page,1,Page suivante,0\\r\\ndetails.items.previous,Previous page,1,Page précédente,0\\r\\ndetails.items.page,Items per page,1,éléments par page,0\\r\\ndetails.item.see.list,See List,1,Voir la liste,1\\r\\ndetails.item.zoom,Zoom to feature,1,Zoom à l'élément,1\\r\\ndetails.item.zoom.zooming,Zooming...,1,Zoom en cours...,1\\r\\ndetails.item.zoom.error,Zoom failed,1,Échec du zoom,1\\r\\ndetails.item.zoom.zoomed,Zoomed,1,Zoom terminé,1\\r\\ndetails.item.previous.item,Previous item,1,Élément précédent,1\\r\\ndetails.item.next.item,Next item,1,Élément suivant,1\\r\\ndetails.item.count,{0} of {1},1,{0} de {1},1\\r\\ndetails.item.loading,Loading results...,1,Chargement des résultats...,1\\r\\ndetails.item.no.data,No data to show because the layer has been removed,1,Aucune donnée à afficher, car la couche a été supprimée,1\\r\\ndetails.item.alert.zoom,Zoomed into feature,1,Zoom sur la caractéristique,1\\r\\ndetails.item.alert.show.item,Showing result {itemName},1,Affichage du résultat {itemName},1\\r\\ndetails.item.alert.show.list,Showing all results for {layerName},1,Affichage de tous les résultats pour {layerName},1\\r\\ndetails.item.alert.defaultAltText,Image associated with {alias} field,1,Image associée au champ {alias},1\\r\\ndetails.togglehilight.title,Toggle Highlight,1,Basculer vers l'élément principal,1\\r\\ndetails.item.open,Expand,1,Développer,1\\r\\ndetails.item.collapse,Collapse,1,Réduire,1\"","import { DetailsAPI } from './api/details';\r\nimport { type DetailsConfig, useDetailsStore } from './store';\r\nimport messages from './lang/lang.csv?raw';\r\n\r\nimport { markRaw } from 'vue';\r\nimport { useAppbarStore } from '../appbar/store';\r\n\r\nclass DetailsFixture extends DetailsAPI {\r\n    async added() {\r\n        this.$iApi.panel.register(\r\n            {\r\n                details: {\r\n                    screens: {\r\n                        'details-screen': () => markRaw(import('./details-screen.vue'))\r\n                    },\r\n                    style: {\r\n                        width: '425px'\r\n                    },\r\n                    button: {\r\n                        tooltip: 'details.layers.title.identifyOrigin',\r\n                        // https://fonts.google.com/icons?selected=Material%20Icons%3Aarticle%3A\r\n                        icon: '<svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 24 24\"><path d=\"M0 0h24v24H0z\" fill=\"none\" /><path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z\" /></svg>'\r\n                    },\r\n                    alertName: 'details.items.title'\r\n                }\r\n            },\r\n            { i18n: { messages } }\r\n        );\r\n\r\n        // Parse the details portion of the configuration file and save any custom\r\n        // template bindings in the details store.\r\n        this._parseConfig(this.config);\r\n        const unwatch = this.$vApp.$watch(\r\n            () => this.config,\r\n            (value: DetailsConfig | undefined) => this._parseConfig(value)\r\n        );\r\n\r\n        // override the removed method here to get access to scope\r\n        this.removed = () => {\r\n            // console.log(`[fixture] ${this.id} removed`);\r\n            unwatch();\r\n\r\n            this.$iApi.panel.remove('details');\r\n\r\n            if (this.$iApi.fixture.exists('appbar')) {\r\n                const appbarStore = useAppbarStore(this.$vApp.$pinia);\r\n                appbarStore.removeButton('details');\r\n            }\r\n\r\n            const detailsStore = useDetailsStore(this.$vApp.$pinia);\r\n            detailsStore.$reset();\r\n        };\r\n    }\r\n}\r\n\r\nexport default DetailsFixture;\r\n"],"names":["DetailsItemInstance","value","params","ORIGIN_DETAILS","DetailsAPI","FixtureInstance","useDetailsStore","payload","p","panel","featureData","open","layer","currFeatureId","fakeResult","ReactiveIdentifyFactory","config","layerDetailsConfigs","detailsConfigItems","layerId","detailsItems","item","map","thisLayerConfig","items","layerUid","hItems","hilightFix","gsByKey","thisHighlight","graphics","gs","oid","g","hilightOn","HilightMode","messages","DetailsFixture","markRaw","unwatch","useAppbarStore"],"mappings":"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"}